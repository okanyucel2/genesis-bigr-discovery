import{c as P,b as U,T as F}from"./index-CIeehwBn.js";import{r as y,d as j,e as m,g as e,f as w,y as p,E as S,j as l,k as s,z as A,c as d,F as z,p as T,q as D,m as C,H as _,R as q,S as G,l as c,o as O}from"./vendor-DoZ-jnr8.js";import{_ as X,a as K,b as E,c as I}from"./TabsContent.vue_vue_type_script_setup_true_lang-Dn2BR8Sj.js";import{C as Y}from"./circle-alert-BnrZrASE.js";import{I as J}from"./info-DmmCjUpt.js";import{_ as Q,c as W,a as B,b as R,e as Z,d as L}from"./TableCell.vue_vue_type_script_setup_true_lang-CTNi0yoY.js";import{_ as ee}from"./IpLink.vue_vue_type_script_setup_true_lang-CJU4XeZe.js";import{_ as se}from"./BigrBadge.vue_vue_type_script_setup_true_lang-CR7203Z1.js";import{c as te}from"./utils-CytzSlOG.js";import{A as V}from"./arrow-up-down-BP4PqEFl.js";import{R as le}from"./refresh-cw-CfSbMtIt.js";import{L as ae}from"./loader-circle-C8oF-5P-.js";import{X as oe}from"./x-CsOTCNR0.js";import"./index-Bn2cS4ww.js";import"./bigr-BzhtauNA.js";import"./laptop-BOGU6WHe.js";import"./globe-BQqjMCyN.js";/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=P("GaugeIcon",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);function re(){const f=y(null),i=y(!1),u=y(null);async function x(){i.value=!0,u.value=null;try{const a=await U.getRisk();f.value=a.data}catch(a){const n=a instanceof Error?a.message:"Failed to load risk data";u.value=n}finally{i.value=!1}}return{data:f,loading:i,error:u,fetchRisk:x}}const ie={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},ce={class:"glass-card rounded-xl p-5"},de={class:"flex items-start justify-between"},ue={class:"flex-1 min-w-0"},me={class:"mt-2 h-1.5 w-full rounded-full bg-white/5"},pe={class:"glass-card rounded-xl p-5"},fe={class:"flex items-start justify-between"},xe={class:"flex-1 min-w-0"},ve={class:"mt-2 text-2xl font-bold text-rose-400 tabular-nums"},_e={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-rose-500/10"},ge={class:"glass-card rounded-xl p-5"},be={class:"flex items-start justify-between"},ke={class:"flex-1 min-w-0"},he={class:"mt-2 text-2xl font-bold text-amber-400 tabular-nums"},ye={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-amber-500/10"},we={class:"glass-card rounded-xl p-5"},$e={class:"flex items-start justify-between"},Ce={class:"flex-1 min-w-0"},Re={class:"mt-2 text-2xl font-bold text-cyan-400 tabular-nums"},Le={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-cyan-500/10"},Ae=j({__name:"RiskOverviewCards",props:{data:{}},setup(f){const i=f,u=A(()=>{const a=i.data.average_risk;return a>=80?{text:"text-rose-400",bg:"bg-rose-500/10",accent:"#fb7185"}:a>=60?{text:"text-amber-400",bg:"bg-amber-500/10",accent:"#fbbf24"}:a>=40?{text:"text-cyan-400",bg:"bg-cyan-500/10",accent:"#22d3ee"}:{text:"text-emerald-400",bg:"bg-emerald-500/10",accent:"#34d399"}}),x=A(()=>Math.min(100,Math.max(0,i.data.average_risk)));return(a,n)=>(d(),m("div",ie,[e("div",ce,[e("div",de,[e("div",ue,[n[0]||(n[0]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"}," Average Risk ",-1)),e("p",{class:w(["mt-2 text-2xl font-bold tabular-nums",u.value.text])},p(f.data.average_risk.toFixed(1)),3),e("div",me,[e("div",{class:"h-full rounded-full transition-all duration-700",style:S({width:`${x.value}%`,backgroundColor:u.value.accent})},null,4)])]),e("div",{class:w(["flex h-10 w-10 shrink-0 items-center justify-center rounded-lg",u.value.bg])},[l(s(ne),{class:w(["h-5 w-5",u.value.text])},null,8,["class"])],2)])]),e("div",pe,[e("div",fe,[e("div",xe,[n[1]||(n[1]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"}," Critical ",-1)),e("p",ve,p(f.data.critical_count),1)]),e("div",_e,[l(s(F),{class:"h-5 w-5 text-rose-400"})])])]),e("div",ge,[e("div",be,[e("div",ke,[n[2]||(n[2]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"}," High ",-1)),e("p",he,p(f.data.high_count),1)]),e("div",ye,[l(s(Y),{class:"h-5 w-5 text-amber-400"})])])]),e("div",we,[e("div",$e,[e("div",Ce,[n[3]||(n[3]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"}," Medium ",-1)),e("p",Re,p(f.data.medium_count),1)]),e("div",Le,[l(s(J),{class:"h-5 w-5 text-cyan-400"})])])])]))}}),Me={class:"glass-panel rounded-xl p-5"},je={key:0,class:"py-8 text-center text-sm text-slate-500"},Ve={key:1,class:"flex flex-wrap gap-1.5"},ze=["title","onMouseenter","onClick"],Se={class:"font-mono font-medium text-white"},Te={key:0,class:"text-slate-400"},He={class:"mt-1 text-slate-300"},Ee={class:"font-semibold"},Ie=j({__name:"RiskHeatmap",props:{profiles:{}},emits:["asset-click"],setup(f,{emit:i}){const u=f,x=i,a=A(()=>[...u.profiles].sort((b,k)=>k.risk_score-b.risk_score)),n=y(null),r=y(0),M=y(0);function v(b){switch(b.toLowerCase()){case"critical":return"bg-rose-500";case"high":return"bg-amber-500";case"medium":return"bg-cyan-500";case"low":return"bg-emerald-500";default:return"bg-slate-500"}}function o(b){switch(b.toLowerCase()){case"critical":return"ring-rose-400/50";case"high":return"ring-amber-400/50";case"medium":return"ring-cyan-400/50";case"low":return"ring-emerald-400/50";default:return"ring-slate-400/50"}}function t(b,k){n.value=b;const h=k.target.getBoundingClientRect();r.value=h.left+h.width/2,M.value=h.top}function g(){n.value=null}function $(b){x("asset-click",b)}return(b,k)=>(d(),m("div",Me,[k[1]||(k[1]=e("h3",{class:"mb-4 text-sm font-medium text-slate-300"},"Risk Heatmap",-1)),a.value.length===0?(d(),m("div",je," No risk profiles available ")):(d(),m("div",Ve,[(d(!0),m(z,null,T(a.value,(h,N)=>(d(),m("div",{key:h.ip,class:w(["relative h-8 w-8 cursor-pointer rounded-sm transition-all duration-150 hover:scale-125 hover:ring-2",[v(h.risk_level),o(h.risk_level)]]),title:`${h.ip} - Score: ${h.risk_score}`,onMouseenter:H=>t(N,H),onMouseleave:g,onClick:H=>$(h.ip)},null,42,ze))),128))])),(d(),D(q,{to:"body"},[n.value!==null&&a.value[n.value]?(d(),m("div",{key:0,class:"pointer-events-none fixed z-50 -translate-x-1/2 -translate-y-full rounded-lg border border-white/10 bg-slate-900/95 px-3 py-2 text-xs shadow-xl backdrop-blur-sm",style:S({left:`${r.value}px`,top:`${M.value-8}px`})},[e("p",Se,p(a.value[n.value].ip),1),a.value[n.value].hostname?(d(),m("p",Te,p(a.value[n.value].hostname),1)):C("",!0),e("p",He,[k[0]||(k[0]=_(" Score: ",-1)),e("span",Ee,p(a.value[n.value].risk_score),1)])],4)):C("",!0)])),k[2]||(k[2]=G('<div class="mt-4 flex items-center gap-4 text-xs text-slate-400"><div class="flex items-center gap-1.5"><div class="h-3 w-3 rounded-sm bg-rose-500"></div><span>Critical</span></div><div class="flex items-center gap-1.5"><div class="h-3 w-3 rounded-sm bg-amber-500"></div><span>High</span></div><div class="flex items-center gap-1.5"><div class="h-3 w-3 rounded-sm bg-cyan-500"></div><span>Medium</span></div><div class="flex items-center gap-1.5"><div class="h-3 w-3 rounded-sm bg-emerald-500"></div><span>Low</span></div></div>',1))]))}}),Be={key:0,class:"opacity-75"},Fe=j({__name:"RiskBadge",props:{level:{},score:{},class:{}},setup(f){const i=f,u=A(()=>{switch(i.level.toLowerCase()){case"critical":return{bg:"bg-red-500/20",text:"text-red-400",label:"Critical"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"High"};case"medium":return{bg:"bg-yellow-500/20",text:"text-yellow-400",label:"Medium"};case"low":return{bg:"bg-emerald-500/20",text:"text-emerald-400",label:"Low"};default:return{bg:"bg-gray-500/20",text:"text-gray-400",label:"Unknown"}}});return(x,a)=>(d(),m("span",{class:w(s(te)("inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-xs font-semibold",u.value.bg,u.value.text,i.class))},[e("span",null,p(u.value.label),1),f.score!==void 0?(d(),m("span",Be,p(f.score),1)):C("",!0)],2))}}),De={class:"glass-panel rounded-xl"},Ne={class:"flex items-center gap-1"},Pe={class:"flex items-center gap-1"},Ue={class:"flex items-center gap-1"},qe={class:"flex items-center gap-1"},Ge={class:"flex items-center gap-1"},Oe=j({__name:"TopRisksTable",props:{risks:{}},setup(f){const i=f,u=y("risk_score"),x=y("desc");function a(v){u.value===v?x.value=x.value==="asc"?"desc":"asc":(u.value=v,x.value="desc")}const n={critical:4,high:3,medium:2,low:1},r=A(()=>{const v=[...i.risks],o=x.value==="asc"?1:-1;return v.sort((t,g)=>{let $=0;switch(u.value){case"ip":$=t.ip.localeCompare(g.ip);break;case"hostname":$=(t.hostname??"").localeCompare(g.hostname??"");break;case"vendor":$=(t.vendor??"").localeCompare(g.vendor??"");break;case"risk_score":$=t.risk_score-g.risk_score;break;case"risk_level":$=(n[t.risk_level.toLowerCase()]??0)-(n[g.risk_level.toLowerCase()]??0);break}return $*o}),v});function M(v){return v>=80?"text-rose-400":v>=60?"text-amber-400":v>=40?"text-cyan-400":"text-emerald-400"}return(v,o)=>(d(),m("div",De,[l(s(Q),null,{default:c(()=>[l(s(W),null,{default:c(()=>[l(s(B),null,{default:c(()=>[l(s(R),{class:"cursor-pointer select-none",onClick:o[0]||(o[0]=t=>a("ip"))},{default:c(()=>[e("span",Ne,[o[5]||(o[5]=_(" IP ",-1)),l(s(V),{size:12,class:"text-slate-500"})])]),_:1}),l(s(R),{class:"cursor-pointer select-none",onClick:o[1]||(o[1]=t=>a("hostname"))},{default:c(()=>[e("span",Pe,[o[6]||(o[6]=_(" Hostname ",-1)),l(s(V),{size:12,class:"text-slate-500"})])]),_:1}),l(s(R),{class:"cursor-pointer select-none",onClick:o[2]||(o[2]=t=>a("vendor"))},{default:c(()=>[e("span",Ue,[o[7]||(o[7]=_(" Vendor ",-1)),l(s(V),{size:12,class:"text-slate-500"})])]),_:1}),l(s(R),null,{default:c(()=>[...o[8]||(o[8]=[_("Category",-1)])]),_:1}),l(s(R),{class:"cursor-pointer select-none",onClick:o[3]||(o[3]=t=>a("risk_score"))},{default:c(()=>[e("span",qe,[o[9]||(o[9]=_(" Risk Score ",-1)),l(s(V),{size:12,class:"text-slate-500"})])]),_:1}),l(s(R),{class:"cursor-pointer select-none",onClick:o[4]||(o[4]=t=>a("risk_level"))},{default:c(()=>[e("span",Ge,[o[10]||(o[10]=_(" Risk Level ",-1)),l(s(V),{size:12,class:"text-slate-500"})])]),_:1}),l(s(R),null,{default:c(()=>[...o[11]||(o[11]=[_("Top CVE",-1)])]),_:1})]),_:1})]),_:1}),l(s(Z),null,{default:c(()=>[(d(!0),m(z,null,T(r.value,t=>(d(),D(s(B),{key:t.ip},{default:c(()=>[l(s(L),null,{default:c(()=>[l(ee,{ip:t.ip},null,8,["ip"])]),_:2},1024),l(s(L),{class:"text-sm text-slate-300"},{default:c(()=>[_(p(t.hostname??"-"),1)]),_:2},1024),l(s(L),{class:"text-sm text-slate-300"},{default:c(()=>[_(p(t.vendor??"-"),1)]),_:2},1024),l(s(L),null,{default:c(()=>[l(se,{category:t.bigr_category,"show-icon":!1},null,8,["category"])]),_:2},1024),l(s(L),null,{default:c(()=>[e("span",{class:w(["font-mono text-sm font-semibold tabular-nums",M(t.risk_score)])},p(t.risk_score),3)]),_:2},1024),l(s(L),null,{default:c(()=>[l(Fe,{level:t.risk_level},null,8,["level"])]),_:2},1024),l(s(L),{class:"font-mono text-xs text-slate-400"},{default:c(()=>[_(p(t.top_cve??"-"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))}}),Xe={class:"space-y-3"},Ke={class:"space-y-2.5"},Ye={class:"flex items-center justify-between text-xs"},Je={class:"text-slate-300"},Qe={class:"font-mono tabular-nums text-slate-400"},We={class:"h-2 w-full rounded-full bg-white/5"},Ze=j({__name:"RiskFactorsChart",props:{factors:{}},setup(f){const i=f,u=[{key:"cve_score",label:"CVE Score",color:"bg-rose-400",bgColor:"bg-rose-400/20"},{key:"exposure_score",label:"Exposure",color:"bg-amber-400",bgColor:"bg-amber-400/20"},{key:"classification_score",label:"Classification",color:"bg-cyan-400",bgColor:"bg-cyan-400/20"},{key:"age_score",label:"Age",color:"bg-purple-400",bgColor:"bg-purple-400/20"},{key:"change_score",label:"Change Frequency",color:"bg-emerald-400",bgColor:"bg-emerald-400/20"}],x=A(()=>u.map(a=>({...a,value:i.factors[a.key],percent:Math.round(i.factors[a.key]*100)})));return(a,n)=>(d(),m("div",Xe,[n[0]||(n[0]=e("h4",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"}," Risk Factors ",-1)),e("div",Ke,[(d(!0),m(z,null,T(x.value,r=>(d(),m("div",{key:r.key,class:"space-y-1"},[e("div",Ye,[e("span",Je,p(r.label),1),e("span",Qe,p(r.percent)+"%",1)]),e("div",We,[e("div",{class:w(["h-full rounded-full transition-all duration-500",r.color]),style:S({width:`${r.percent}%`})},null,6)])]))),128))])]))}}),es={class:"space-y-6"},ss={class:"flex items-center justify-between"},ts=["disabled"],ls={key:0,class:"flex flex-col items-center justify-center py-20"},as={key:1,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},os={class:"mt-2 text-sm text-slate-400"},ns={class:"flex gap-6"},rs={class:"flex-1 min-w-0"},is={key:0,class:"w-80 shrink-0"},cs={class:"glass-panel sticky top-4 rounded-xl p-5"},ds={class:"mb-4 flex items-center justify-between"},us={class:"space-y-3 text-sm"},ms={class:"ml-2 font-mono text-white"},ps={key:0},fs={class:"ml-2 text-slate-300"},xs={key:1},vs={class:"ml-2 text-slate-300"},_s={key:2},gs={class:"ml-2 font-mono text-xs text-rose-300"},bs={class:"mt-5 border-t border-white/5 pt-5"},Is=j({__name:"RiskView",setup(f){const{data:i,loading:u,error:x,fetchRisk:a}=re(),n=y(null),r=A(()=>!n.value||!i.value?null:i.value.profiles.find(o=>o.ip===n.value)??null);function M(o){n.value=o}function v(){n.value=null}return O(()=>{a()}),(o,t)=>(d(),m("div",es,[e("div",ss,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-white"},"Risk Assessment"),e("p",{class:"mt-1 text-sm text-slate-400"}," Asset risk profiles and threat analysis ")],-1)),e("button",{class:"flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 text-xs text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",disabled:s(u),onClick:t[0]||(t[0]=(...g)=>s(a)&&s(a)(...g))},[l(s(le),{class:w(["h-3.5 w-3.5",{"animate-spin":s(u)}])},null,8,["class"]),t[2]||(t[2]=_(" Refresh ",-1))],8,ts)]),s(u)&&!s(i)?(d(),m("div",ls,[l(s(ae),{class:"h-8 w-8 animate-spin text-cyan-400"}),t[4]||(t[4]=e("p",{class:"mt-3 text-sm text-slate-400"},"Loading risk data...",-1))])):s(x)&&!s(i)?(d(),m("div",as,[l(s(F),{class:"mx-auto h-10 w-10 text-amber-400"}),t[5]||(t[5]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Unable to Load Data",-1)),e("p",os,p(s(x)),1),e("button",{class:"mt-4 rounded-lg bg-cyan-500/20 px-4 py-2 text-sm font-medium text-cyan-400 transition-colors hover:bg-cyan-500/30",onClick:t[1]||(t[1]=(...g)=>s(a)&&s(a)(...g))}," Try Again ")])):s(i)?(d(),m(z,{key:2},[l(Ae,{data:s(i)},null,8,["data"]),e("div",ns,[e("div",rs,[l(s(X),{"default-value":"heatmap"},{default:c(()=>[l(s(K),null,{default:c(()=>[l(s(E),{value:"heatmap"},{default:c(()=>[...t[6]||(t[6]=[_("Heatmap",-1)])]),_:1}),l(s(E),{value:"table"},{default:c(()=>[...t[7]||(t[7]=[_("Top Risks",-1)])]),_:1})]),_:1}),l(s(I),{value:"heatmap"},{default:c(()=>[l(Ie,{profiles:s(i).profiles,onAssetClick:M},null,8,["profiles"])]),_:1}),l(s(I),{value:"table"},{default:c(()=>[l(Oe,{risks:s(i).top_risks},null,8,["risks"])]),_:1})]),_:1})]),r.value?(d(),m("div",is,[e("div",cs,[e("div",ds,[t[8]||(t[8]=e("h3",{class:"text-sm font-medium text-white"},"Asset Detail",-1)),e("button",{class:"rounded-md p-1 text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",onClick:v},[l(s(oe),{size:16})])]),e("div",us,[e("div",null,[t[9]||(t[9]=e("span",{class:"text-slate-500"},"IP:",-1)),e("span",ms,p(r.value.ip),1)]),r.value.hostname?(d(),m("div",ps,[t[10]||(t[10]=e("span",{class:"text-slate-500"},"Hostname:",-1)),e("span",fs,p(r.value.hostname),1)])):C("",!0),r.value.vendor?(d(),m("div",xs,[t[11]||(t[11]=e("span",{class:"text-slate-500"},"Vendor:",-1)),e("span",vs,p(r.value.vendor),1)])):C("",!0),e("div",null,[t[12]||(t[12]=e("span",{class:"text-slate-500"},"Risk Score:",-1)),e("span",{class:w(["ml-2 font-mono font-semibold",{"text-rose-400":r.value.risk_score>=80,"text-amber-400":r.value.risk_score>=60&&r.value.risk_score<80,"text-cyan-400":r.value.risk_score>=40&&r.value.risk_score<60,"text-emerald-400":r.value.risk_score<40}])},p(r.value.risk_score),3)]),r.value.top_cve?(d(),m("div",_s,[t[13]||(t[13]=e("span",{class:"text-slate-500"},"Top CVE:",-1)),e("span",gs,p(r.value.top_cve),1)])):C("",!0)]),e("div",bs,[l(Ze,{factors:r.value.factors},null,8,["factors"])])])])):C("",!0)])],64)):C("",!0)]))}});export{Is as default};
//# sourceMappingURL=RiskView-m-3QLNou.js.map
