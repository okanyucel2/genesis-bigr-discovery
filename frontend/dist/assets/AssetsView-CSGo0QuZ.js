import{I as Q,r as C,z as T,d as A,o as N,c as l,e as _,j as a,k as e,g as c,F as D,p as z,y as f,l as n,H as y,m as R,q as h,J as F,K as I,L as M,f as E}from"./vendor-DoZ-jnr8.js";import{c as U,b as G}from"./index-CIeehwBn.js";import{B as K,a as W}from"./bigr-BzhtauNA.js";import{u as J}from"./useSubnets-CMLAEkL7.js";import{_ as X}from"./SearchInput.vue_vue_type_script_setup_true_lang-DL4fLlO5.js";import{_ as Y,a as Z,b as ee}from"./LoadingState.vue_vue_type_script_setup_true_lang-8EoBoOhd.js";import{_ as q,a as te}from"./ConfidenceBadge.vue_vue_type_script_setup_true_lang-tz1Kfxm8.js";import{X as se}from"./x-CsOTCNR0.js";import{_ as oe,a as H,b as j,c as ae,d as k,e as ne}from"./TableCell.vue_vue_type_script_setup_true_lang-CTNi0yoY.js";import{W as le,j as re,q as ie,U as ue,H as de}from"./index-Bn2cS4ww.js";import{c as ce}from"./utils-CytzSlOG.js";import{_ as fe}from"./BigrBadge.vue_vue_type_script_setup_true_lang-CR7203Z1.js";import{_ as pe}from"./IpLink.vue_vue_type_script_setup_true_lang-CJU4XeZe.js";import{A as me}from"./arrow-up-down-BP4PqEFl.js";import"./loader-circle-C8oF-5P-.js";import"./laptop-BOGU6WHe.js";import"./globe-BQqjMCyN.js";/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=U("ArrowDownIcon",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=U("ArrowUpIcon",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),O=Q("assets",()=>{const u=C([]),t=C({}),r=C(!1),o=C(null),$=C(null),b=C(""),x=C(null);async function S(p){r.value=!0,o.value=null;try{const v=await G.getAssets(p);u.value=v.data.assets,t.value=v.data.category_summary}catch(v){const w=v instanceof Error?v.message:"Failed to load assets";o.value=w}finally{r.value=!1}}const m=T(()=>{let p=u.value;if(x.value&&(p=p.filter(v=>v.bigr_category===x.value)),b.value){const v=b.value.toLowerCase();p=p.filter(w=>{var L,P,V;return w.ip.includes(v)||((L=w.hostname)==null?void 0:L.toLowerCase().includes(v))||((P=w.vendor)==null?void 0:P.toLowerCase().includes(v))||((V=w.mac)==null?void 0:V.toLowerCase().includes(v))})}return p}),g=T(()=>u.value.length);function s(p){x.value=p}function i(p){b.value=p}function d(p){$.value=p}function B(){u.value=[],t.value={},r.value=!1,o.value=null,$.value=null,b.value="",x.value=null}return{assets:u,categorySummary:t,loading:r,error:o,selectedSubnet:$,searchQuery:b,selectedCategory:x,fetchAssets:S,filteredAssets:m,totalAssets:g,setCategory:s,setSearchQuery:i,setSubnet:d,$reset:B}}),ve={class:"flex flex-wrap items-center gap-3"},ye=["value"],he=["value"],be=["value"],xe=["value"],Ce={key:0,class:"flex items-center gap-2"},$e=A({__name:"AssetFilters",setup(u){const t=O(),{subnets:r,fetchSubnets:o}=J();N(()=>{o()});function $(s){t.setSearchQuery(s)}function b(s){const i=s.target.value;t.setCategory(i||null)}function x(s){const i=s.target.value;t.setSubnet(i||null),t.fetchAssets(i||void 0)}function S(){t.setCategory(null),t.setSearchQuery(""),t.setSubnet(null),t.fetchAssets()}const m=T(()=>{let s=0;return t.selectedCategory!==null&&s++,t.searchQuery!==""&&s++,t.selectedSubnet!==null&&s++,s}),g=T(()=>m.value>0);return(s,i)=>(l(),_("div",ve,[a(X,{"model-value":e(t).searchQuery,placeholder:"Search by IP, hostname, vendor, MAC...",class:"w-64","onUpdate:modelValue":$},null,8,["model-value"]),c("select",{value:e(t).selectedCategory??"",class:"h-10 rounded-md border border-border bg-background px-3 py-2 text-sm text-foreground ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onChange:b},[i[0]||(i[0]=c("option",{value:""},"All Categories",-1)),(l(!0),_(D,null,z(e(W),d=>(l(),_("option",{key:d,value:d},f(e(K)[d].label),9,he))),128))],40,ye),c("select",{value:e(t).selectedSubnet??"",class:"h-10 rounded-md border border-border bg-background px-3 py-2 text-sm text-foreground ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onChange:x},[i[1]||(i[1]=c("option",{value:""},"All Subnets",-1)),(l(!0),_(D,null,z(e(r),d=>(l(),_("option",{key:d.id,value:d.cidr},f(d.cidr)+f(d.label?` (${d.label})`:""),9,xe))),128))],40,be),g.value?(l(),_("div",Ce,[a(e(q),{variant:"secondary",class:"gap-1"},{default:n(()=>[y(f(m.value)+" active ",1)]),_:1}),a(e(Y),{variant:"ghost",size:"sm",class:"h-8 gap-1 text-muted-foreground hover:text-foreground",onClick:S},{default:n(()=>[a(e(se),{size:14}),i[2]||(i[2]=y(" Clear ",-1))]),_:1})])):R("",!0)]))}}),ke=A({__name:"Tooltip",props:{defaultOpen:{type:Boolean},open:{type:Boolean},delayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},setup(u){const t=u;return(r,o)=>(l(),h(e(le),F(I(t)),{default:n(()=>[M(r.$slots,"default")]),_:3},16))}}),Ae=A({__name:"TooltipTrigger",props:{asChild:{type:Boolean},as:{}},setup(u){const t=u;return(r,o)=>(l(),h(e(re),F(I(t)),{default:n(()=>[M(r.$slots,"default")]),_:3},16))}}),we=A({__name:"TooltipContent",props:{class:{},forceMount:{type:Boolean},ariaLabel:{},asChild:{type:Boolean},as:{},side:{},sideOffset:{default:4},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean}},setup(u){const t=u;return(r,o)=>(l(),h(e(ie),null,{default:n(()=>[a(e(ue),{"side-offset":u.sideOffset,class:E(e(ce)("z-50 overflow-hidden rounded-md border border-border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t.class))},{default:n(()=>[M(r.$slots,"default")]),_:3},8,["side-offset","class"])]),_:3}))}}),Se=A({__name:"TooltipProvider",props:{delayDuration:{default:200},skipDelayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},setup(u){const t=u;return(r,o)=>(l(),h(e(de),F(I(t)),{default:n(()=>[M(r.$slots,"default")]),_:3},16))}}),Be={class:"flex items-center gap-1"},Te={class:"font-mono text-xs"},De={key:1,class:"text-sm text-muted-foreground/50"},ze=A({__name:"AssetTable",props:{assets:{}},setup(u){const t=u,r=C("ip"),o=C("asc");function $(m){r.value===m?o.value=o.value==="asc"?"desc":"asc":(r.value=m,o.value="asc")}const b=T(()=>[...t.assets].sort((m,g)=>{const s=m[r.value]??"",i=g[r.value]??"",d=typeof s=="number"&&typeof i=="number"?s-i:String(s).localeCompare(String(i));return o.value==="asc"?d:-d}));function x(m){if(!m)return"-";const g=new Date(m),i=new Date().getTime()-g.getTime(),d=Math.floor(i/6e4);if(d<1)return"just now";if(d<60)return`${d}m ago`;const B=Math.floor(d/60);return B<24?`${B}h ago`:`${Math.floor(B/24)}d ago`}const S=[{field:"ip",label:"IP Address"},{field:"hostname",label:"Hostname"},{field:"vendor",label:"Vendor"},{field:"bigr_category",label:"Category"},{field:"confidence_score",label:"Confidence"},{field:"last_seen",label:"Last Seen"}];return(m,g)=>(l(),_("div",null,[u.assets.length===0?(l(),h(Z,{key:0,icon:"search",title:"No assets found",description:"Try adjusting your filters or run a new scan to discover assets."})):(l(),h(e(oe),{key:1},{default:n(()=>[a(e(ae),null,{default:n(()=>[a(e(H),null,{default:n(()=>[(l(),_(D,null,z(S,s=>a(e(j),{key:s.field,class:"cursor-pointer select-none hover:text-foreground transition-colors",onClick:i=>$(s.field)},{default:n(()=>[c("div",Be,[c("span",null,f(s.label),1),r.value===s.field&&o.value==="asc"?(l(),h(e(ge),{key:0,size:14,class:"text-primary"})):r.value===s.field&&o.value==="desc"?(l(),h(e(_e),{key:1,size:14,class:"text-primary"})):(l(),h(e(me),{key:2,size:14,class:"opacity-30"}))])]),_:2},1032,["onClick"])),64)),a(e(j),null,{default:n(()=>[...g[0]||(g[0]=[y("MAC",-1)])]),_:1}),a(e(j),null,{default:n(()=>[...g[1]||(g[1]=[y("Ports",-1)])]),_:1})]),_:1})]),_:1}),a(e(ne),null,{default:n(()=>[(l(!0),_(D,null,z(b.value,s=>(l(),h(e(H),{key:s.ip},{default:n(()=>[a(e(k),null,{default:n(()=>[a(pe,{ip:s.ip},null,8,["ip"])]),_:2},1024),a(e(k),{class:"text-sm text-foreground"},{default:n(()=>[y(f(s.hostname??"-"),1)]),_:2},1024),a(e(k),{class:"text-sm text-muted-foreground"},{default:n(()=>[y(f(s.vendor??"-"),1)]),_:2},1024),a(e(k),null,{default:n(()=>[a(fe,{category:s.bigr_category},null,8,["category"])]),_:2},1024),a(e(k),null,{default:n(()=>[a(te,{score:s.confidence_score,level:s.confidence_level},null,8,["score","level"])]),_:2},1024),a(e(k),{class:"text-sm text-muted-foreground whitespace-nowrap"},{default:n(()=>[y(f(x(s.last_seen)),1)]),_:2},1024),a(e(k),{class:"font-mono text-xs text-muted-foreground"},{default:n(()=>[y(f(s.mac??"-"),1)]),_:2},1024),a(e(k),null,{default:n(()=>[s.open_ports.length>0?(l(),h(e(Se),{key:0},{default:n(()=>[a(e(ke),null,{default:n(()=>[a(e(Ae),{"as-child":""},{default:n(()=>[a(e(q),{variant:"secondary",class:"cursor-default tabular-nums"},{default:n(()=>[y(f(s.open_ports.length)+" "+f(s.open_ports.length===1?"port":"ports"),1)]),_:2},1024)]),_:2},1024),a(e(we),{side:"top"},{default:n(()=>[c("p",Te,f(s.open_ports.join(", ")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(l(),_("span",De," - "))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))]))}}),Me={class:"space-y-6"},je={class:"glass-card rounded-lg border border-border/50 p-1"},Fe={key:1,class:"flex flex-col items-center justify-center py-12 text-center"},Ie={class:"text-sm text-destructive"},Le={class:"flex items-center justify-between px-4 py-3"},Pe={class:"text-sm text-muted-foreground"},Ve={class:"font-medium text-foreground"},He={class:"font-medium text-foreground"},ot=A({__name:"AssetsView",setup(u){const t=O();return N(()=>{t.assets.length===0&&t.fetchAssets()}),(r,o)=>(l(),_("div",Me,[o[4]||(o[4]=c("div",null,[c("h1",{class:"text-2xl font-bold text-white"},"Assets"),c("p",{class:"mt-1 text-sm text-muted-foreground"}," Discovered network assets with BÄ°GR classification ")],-1)),a($e),c("div",je,[e(t).loading?(l(),h(ee,{key:0,message:"Discovering assets..."})):e(t).error?(l(),_("div",Fe,[c("p",Ie,f(e(t).error),1),c("button",{class:"mt-3 text-sm text-primary hover:underline",onClick:o[0]||(o[0]=$=>e(t).fetchAssets())}," Try again ")])):(l(),_(D,{key:2},[c("div",Le,[c("p",Pe,[o[1]||(o[1]=y(" Showing ",-1)),c("span",Ve,f(e(t).filteredAssets.length),1),o[2]||(o[2]=y(" of ",-1)),c("span",He,f(e(t).totalAssets),1),o[3]||(o[3]=y(" assets ",-1))])]),a(ze,{assets:e(t).filteredAssets},null,8,["assets"])],64))])]))}});export{ot as default};
//# sourceMappingURL=AssetsView-CSGo0QuZ.js.map
