import{r as S,d as P,e as c,g as o,y as m,j as s,q as w,l,k as e,m as y,F as k,p as A,z as H,c as a,H as v,f as z,o as G,w as W,u as J,x as K,G as X}from"./vendor-DoZ-jnr8.js";import{c as O,b as Y,T as Z,N as ee}from"./index-CIeehwBn.js";import{_ as Q}from"./BigrBadge.vue_vue_type_script_setup_true_lang-CR7203Z1.js";import{_ as te,a as U}from"./ConfidenceBadge.vue_vue_type_script_setup_true_lang-tz1Kfxm8.js";import{_ as se}from"./Separator.vue_vue_type_script_setup_true_lang-ChVPjTer.js";import{F as ae,C as oe}from"./fingerprint-Bmni4Jsl.js";import{a as E,_ as R,b as ne}from"./LoadingState.vue_vue_type_script_setup_true_lang-8EoBoOhd.js";import{_ as le,c as re,a as j,b as T,e as ie,d as D}from"./TableCell.vue_vue_type_script_setup_true_lang-CTNi0yoY.js";import{_ as ce,a as de,b as C,c as L}from"./TabsContent.vue_vue_type_script_setup_true_lang-Dn2BR8Sj.js";import{M as ue}from"./monitor-BZv-zXTn.js";import{S as fe}from"./shield-Dd26wtKz.js";import"./bigr-BzhtauNA.js";import"./utils-CytzSlOG.js";import"./laptop-BOGU6WHe.js";import"./globe-BQqjMCyN.js";import"./index-Bn2cS4ww.js";import"./loader-circle-C8oF-5P-.js";/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=O("ArrowLeftIcon",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=O("HistoryIcon",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=O("WifiIcon",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);function pe(){const u=S(null),r=S([]),x=S(!1),n=S(null);async function _(f){x.value=!0,n.value=null;try{const t=await Y.getAssetDetail(f);u.value=t.data.asset,r.value=t.data.history}catch(t){n.value=t instanceof Error?t.message:"Failed to load asset detail"}finally{x.value=!1}}return{asset:u,history:r,loading:x,error:n,fetchDetail:_}}const ge={class:"glass-card rounded-xl p-6"},xe={class:"flex flex-wrap items-start justify-between gap-4"},he={class:"flex flex-col gap-2"},ve={class:"flex items-center gap-3"},ye={class:"font-mono text-2xl font-bold text-cyan-400"},be={key:0,class:"text-sm text-slate-400"},$e={class:"flex items-center gap-2"},we={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},ke={class:"text-xs font-medium uppercase tracking-wider text-slate-500"},Me={key:0,class:"ml-1 text-xs text-slate-500"},Se=P({__name:"AssetDetailCard",props:{asset:{}},setup(u){const r=u;function x(f){return f?new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}function n(f){if(!f)return"";const t=new Date(f),p=new Date().getTime()-t.getTime(),h=Math.floor(p/6e4),b=Math.floor(h/60),g=Math.floor(b/24);return h<1?"just now":h<60?`${h}m ago`:b<24?`${b}h ago`:g<30?`${g}d ago`:x(f)}const _=H(()=>[{label:"MAC Address",value:r.asset.mac,mono:!0},{label:"Hostname",value:r.asset.hostname??"N/A",mono:!1},{label:"Vendor",value:r.asset.vendor??"Unknown",mono:!1},{label:"OS Hint",value:r.asset.os_hint??"N/A",mono:!1},{label:"Scan Method",value:r.asset.scan_method,mono:!1},{label:"Open Ports",value:r.asset.open_ports.length>0?`${r.asset.open_ports.length} port${r.asset.open_ports.length!==1?"s":""}`:"None detected",mono:!1},{label:"First Seen",value:x(r.asset.first_seen),mono:!1,sub:n(r.asset.first_seen)},{label:"Last Seen",value:x(r.asset.last_seen),mono:!1,sub:n(r.asset.last_seen)}]);return(f,t)=>(a(),c("div",ge,[o("div",xe,[o("div",he,[o("div",ve,[o("h2",ye,m(u.asset.ip),1),s(Q,{category:u.asset.bigr_category},null,8,["category"]),u.asset.manual_override?(a(),w(e(te),{key:0,variant:"outline",class:"border-amber-500/50 text-amber-400"},{default:l(()=>[s(e(ae),{size:12,class:"mr-1"}),t[0]||(t[0]=v(" Manual Override ",-1))]),_:1})):y("",!0)]),u.asset.hostname?(a(),c("p",be,m(u.asset.hostname),1)):y("",!0)]),o("div",$e,[s(U,{score:u.asset.confidence_score,level:u.asset.confidence_level},null,8,["score","level"])])]),s(e(se),{class:"my-5 bg-white/[0.06]"}),o("div",we,[(a(!0),c(k,null,A(_.value,i=>(a(),c("div",{key:i.label,class:"space-y-1"},[o("dt",ke,m(i.label),1),o("dd",{class:z(["text-sm text-slate-200",{"font-mono":i.mono}])},[v(m(i.value)+" ",1),i.sub?(a(),c("span",Me," ("+m(i.sub)+") ",1)):y("",!0)],2)]))),128))])]))}}),Te={key:1,class:"glass-panel rounded-xl overflow-hidden"},De={class:"flex flex-col"},Pe={class:"text-sm text-slate-200"},Ae={key:0,class:"text-xs text-slate-500"},He={class:"font-mono text-xs text-slate-400"},V=P({__name:"AssetHistory",props:{history:{}},setup(u){const r=u;function x(f){return new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function n(f){const t=new Date(f),p=new Date().getTime()-t.getTime(),h=Math.floor(p/6e4),b=Math.floor(h/60),g=Math.floor(b/24);return h<1?"just now":h<60?`${h}m ago`:b<24?`${b}h ago`:g<30?`${g}d ago`:""}const _=H(()=>[...r.history].sort((f,t)=>new Date(t.seen_at).getTime()-new Date(f.seen_at).getTime()));return(f,t)=>(a(),c("div",null,[u.history.length===0?(a(),w(E,{key:0,title:"No History",description:"No scan history found for this asset.",icon:"inbox"})):(a(),c("div",Te,[s(e(le),null,{default:l(()=>[s(e(re),null,{default:l(()=>[s(e(j),{class:"border-white/[0.06] hover:bg-transparent"},{default:l(()=>[s(e(T),{class:"text-slate-400"},{default:l(()=>[...t[0]||(t[0]=[v("Scan Time",-1)])]),_:1}),s(e(T),{class:"text-slate-400"},{default:l(()=>[...t[1]||(t[1]=[v("Scan ID",-1)])]),_:1}),s(e(T),{class:"text-slate-400"},{default:l(()=>[...t[2]||(t[2]=[v("Category",-1)])]),_:1}),s(e(T),{class:"text-slate-400 text-right"},{default:l(()=>[...t[3]||(t[3]=[v("Confidence",-1)])]),_:1})]),_:1})]),_:1}),s(e(ie),null,{default:l(()=>[(a(!0),c(k,null,A(_.value,(i,p)=>(a(),w(e(j),{key:`${i.scan_id}-${p}`,class:"border-white/[0.06] hover:bg-white/[0.03]"},{default:l(()=>[s(e(D),null,{default:l(()=>[o("div",De,[o("span",Pe,m(x(i.seen_at)),1),n(i.seen_at)?(a(),c("span",Ae,m(n(i.seen_at)),1)):y("",!0)])]),_:2},1024),s(e(D),null,{default:l(()=>[o("span",He,m(i.scan_id.slice(0,8)),1)]),_:2},1024),s(e(D),null,{default:l(()=>[s(Q,{category:i.bigr_category},null,8,["category"])]),_:2},1024),s(e(D),{class:"text-right"},{default:l(()=>[s(U,{score:i.confidence_score},null,8,["score"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]))}}),Ne={key:1},Ce={class:"mb-3 text-xs text-slate-500"},Le={class:"flex flex-wrap gap-2"},ze={class:"font-mono text-sm font-semibold"},Oe={key:0,class:"text-xs opacity-70"},F=P({__name:"AssetPorts",props:{ports:{}},setup(u){const r=u,x={21:"FTP",22:"SSH",23:"Telnet",25:"SMTP",53:"DNS",80:"HTTP",110:"POP3",143:"IMAP",161:"SNMP",443:"HTTPS",445:"SMB",554:"RTSP",631:"IPP",993:"IMAPS",995:"POP3S",1433:"MSSQL",1883:"MQTT",3306:"MySQL",3389:"RDP",5432:"PostgreSQL",5900:"VNC",6379:"Redis",8080:"HTTP-Alt",8443:"HTTPS-Alt",8883:"MQTTS",9100:"JetDirect",27017:"MongoDB"};function n(t){return x[t]??null}function _(t){return[22,23,3389,5900].includes(t)?"border-amber-500/40 bg-amber-500/10 text-amber-300":[80,443,8080,8443].includes(t)?"border-cyan-500/40 bg-cyan-500/10 text-cyan-300":[3306,5432,1433,6379,27017].includes(t)?"border-purple-500/40 bg-purple-500/10 text-purple-300":[554,9100,631,161,1883,8883].includes(t)?"border-emerald-500/40 bg-emerald-500/10 text-emerald-300":[25,110,143,993,995].includes(t)?"border-blue-500/40 bg-blue-500/10 text-blue-300":"border-slate-500/40 bg-slate-500/10 text-slate-300"}const f=H(()=>[...r.ports].sort((t,i)=>t-i));return(t,i)=>(a(),c("div",null,[u.ports.length===0?(a(),w(E,{key:0,title:"No Open Ports",description:"No open ports were detected on this asset.",icon:"inbox"})):(a(),c("div",Ne,[o("p",Ce,m(u.ports.length)+" open port"+m(u.ports.length!==1?"s":"")+" detected ",1),o("div",Le,[(a(!0),c(k,null,A(f.value,p=>(a(),c("div",{key:p,class:z(["inline-flex items-center gap-1.5 rounded-lg border px-3 py-1.5 transition-colors hover:brightness-125",_(p)])},[o("span",ze,m(p),1),n(p)?(a(),c("span",Oe,m(n(p)),1)):y("",!0)],2))),128))])]))]))}}),Be={class:"space-y-6"},Re={key:1,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},je={class:"mt-2 text-sm text-slate-400"},Ie={class:"mt-4 flex justify-center gap-3"},Ve={key:0,class:"ml-1 rounded-full bg-white/10 px-1.5 py-0.5 text-[10px] font-semibold"},Fe={key:0,class:"ml-1 rounded-full bg-white/10 px-1.5 py-0.5 text-[10px] font-semibold"},Qe={class:"grid grid-cols-2 gap-3 sm:grid-cols-4"},Ue={class:"flex items-center gap-2"},Ee={class:"text-xs text-slate-500"},qe={class:"mt-2 text-xl font-bold text-slate-200 tabular-nums"},Ge={class:"glass-panel rounded-xl p-5"},We={key:0,class:"glass-panel rounded-xl p-5"},Je={class:"glass-panel rounded-xl p-5"},mt=P({__name:"AssetDetailView",setup(u){const r=J(),x=X(),{asset:n,history:_,loading:f,error:t,fetchDetail:i}=pe();G(()=>{const g=r.params.ip;g&&i(g)}),W(()=>r.params.ip,g=>{g&&i(g)});function p(){x.push("/assets")}const h=H(()=>n.value?[{label:"Open Ports",value:n.value.open_ports.length,icon:_e,color:"text-cyan-400"},{label:"Confidence",value:`${n.value.confidence_score}%`,icon:fe,color:"text-emerald-400"},{label:"Scan History",value:_.value.length,icon:I,color:"text-purple-400"},{label:"Last Seen",value:n.value.last_seen?b(n.value.last_seen):"N/A",icon:oe,color:"text-amber-400"}]:[]);function b(g){const d=new Date(g),q=new Date().getTime()-d.getTime(),M=Math.floor(q/6e4),N=Math.floor(M/60),B=Math.floor(N/24);return M<1?"just now":M<60?`${M}m ago`:N<24?`${N}h ago`:B<7?`${B}d ago`:d.toLocaleDateString("en-US",{month:"short",day:"numeric"})}return(g,d)=>(a(),c("div",Be,[o("div",null,[s(e(R),{variant:"ghost",size:"sm",class:"gap-2 text-slate-400 hover:text-slate-200",onClick:p},{default:l(()=>[s(e(me),{size:16}),d[1]||(d[1]=v(" Back to Assets ",-1))]),_:1})]),e(f)&&!e(n)?(a(),w(ne,{key:0,message:"Loading asset details..."})):e(t)&&!e(n)?(a(),c("div",Re,[s(e(Z),{class:"mx-auto h-10 w-10 text-amber-400"}),d[3]||(d[3]=o("h2",{class:"mt-3 text-lg font-semibold text-white"}," Unable to Load Asset ",-1)),o("p",je,m(e(t)),1),o("div",Ie,[s(e(R),{variant:"ghost",size:"sm",class:"text-slate-400",onClick:p},{default:l(()=>[...d[2]||(d[2]=[v(" Go Back ",-1)])]),_:1}),o("button",{class:"rounded-lg bg-cyan-500/20 px-4 py-2 text-sm font-medium text-cyan-400 transition-colors hover:bg-cyan-500/30",onClick:d[0]||(d[0]=$=>e(i)(e(r).params.ip))}," Try Again ")])])):y("",!0),e(n)?(a(),c(k,{key:2},[s(Se,{asset:e(n)},null,8,["asset"]),s(e(ce),{"default-value":"overview",class:"w-full"},{default:l(()=>[s(e(de),{class:"w-full justify-start bg-white/[0.04] border border-white/[0.06]"},{default:l(()=>[s(e(C),{value:"overview",class:"gap-1.5 data-[state=active]:bg-cyan-500/10 data-[state=active]:text-cyan-400"},{default:l(()=>[s(e(ue),{size:14}),d[4]||(d[4]=v(" Overview ",-1))]),_:1}),s(e(C),{value:"history",class:"gap-1.5 data-[state=active]:bg-cyan-500/10 data-[state=active]:text-cyan-400"},{default:l(()=>[s(e(I),{size:14}),d[5]||(d[5]=v(" History ",-1)),e(_).length>0?(a(),c("span",Ve,m(e(_).length),1)):y("",!0)]),_:1}),s(e(C),{value:"ports",class:"gap-1.5 data-[state=active]:bg-cyan-500/10 data-[state=active]:text-cyan-400"},{default:l(()=>[s(e(ee),{size:14}),d[6]||(d[6]=v(" Ports ",-1)),e(n).open_ports.length>0?(a(),c("span",Fe,m(e(n).open_ports.length),1)):y("",!0)]),_:1})]),_:1}),s(e(L),{value:"overview",class:"mt-4 space-y-6"},{default:l(()=>[o("div",Qe,[(a(!0),c(k,null,A(h.value,$=>(a(),c("div",{key:$.label,class:"glass-panel rounded-xl p-4"},[o("div",Ue,[(a(),w(K($.icon),{size:16,class:z($.color)},null,8,["class"])),o("span",Ee,m($.label),1)]),o("p",qe,m($.value),1)]))),128))]),o("div",Ge,[d[7]||(d[7]=o("h3",{class:"mb-3 text-sm font-medium text-slate-300"}," Open Ports ",-1)),s(F,{ports:e(n).open_ports},null,8,["ports"])]),e(_).length>0?(a(),c("div",We,[d[8]||(d[8]=o("h3",{class:"mb-3 text-sm font-medium text-slate-300"}," Recent Scan History ",-1)),s(V,{history:e(_).slice(0,5)},null,8,["history"])])):y("",!0)]),_:1}),s(e(L),{value:"history",class:"mt-4"},{default:l(()=>[s(V,{history:e(_)},null,8,["history"])]),_:1}),s(e(L),{value:"ports",class:"mt-4"},{default:l(()=>[o("div",Je,[s(F,{ports:e(n).open_ports},null,8,["ports"])])]),_:1})]),_:1})],64)):y("",!0)]))}});export{mt as default};
//# sourceMappingURL=AssetDetailView-B22eUtEt.js.map
