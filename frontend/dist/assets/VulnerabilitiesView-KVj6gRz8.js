import{r as j,d as A,e as o,g as e,y as u,j as s,k as t,z as S,c as n,f as L,m as $,l as x,H as w,F as z,p as F,q as B,x as P,Q as q,E as H,o as R,T as U}from"./vendor-DoZ-jnr8.js";import{c as I,b as K,B as Q,T,S as X}from"./index-CIeehwBn.js";import{_ as G}from"./SearchInput.vue_vue_type_script_setup_true_lang-DL4fLlO5.js";import{C as J}from"./circle-alert-BnrZrASE.js";import{I as O}from"./info-DmmCjUpt.js";import{S as W}from"./shield-Dd26wtKz.js";import{_ as Y,c as Z,a as M,b as V,e as ee,d as k}from"./TableCell.vue_vue_type_script_setup_true_lang-CTNi0yoY.js";import{_ as te}from"./IpLink.vue_vue_type_script_setup_true_lang-CJU4XeZe.js";import{c as se}from"./utils-CytzSlOG.js";import{A as E}from"./arrow-up-down-BP4PqEFl.js";import{C as le}from"./chevron-down-u-w8nSXk.js";import{X as ae}from"./x-CsOTCNR0.js";import{C as ne}from"./circle-check-big-CaljP7QX.js";import{R as oe}from"./refresh-cw-CfSbMtIt.js";import{L as ie}from"./loader-circle-C8oF-5P-.js";/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=I("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=I("ExternalLinkIcon",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=I("ShieldAlertIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);function ue(){const c=j(null),f=j(!1),i=j(null);async function g(){f.value=!0,i.value=null;try{const l=await K.getVulnerabilities();c.value=l.data}catch(l){const h=l instanceof Error?l.message:"Failed to load vulnerability data";i.value=h}finally{f.value=!1}}return{data:c,loading:f,error:i,fetchVulnerabilities:g}}const xe={class:"grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-6"},me={class:"glass-card rounded-xl p-5"},fe={class:"flex items-start justify-between"},ve={class:"flex-1 min-w-0"},pe={class:"mt-2 text-2xl font-bold text-white tabular-nums"},_e={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-cyan-500/10"},he={class:"glass-card rounded-xl p-5"},be={class:"flex items-start justify-between"},ge={class:"flex-1 min-w-0"},ye={class:"mt-2 text-2xl font-bold text-rose-400 tabular-nums"},we={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-rose-500/10"},ke={class:"glass-card rounded-xl p-5"},$e={class:"flex items-start justify-between"},Ce={class:"flex-1 min-w-0"},Ve={class:"mt-2 text-2xl font-bold text-amber-400 tabular-nums"},je={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-amber-500/10"},Se={class:"glass-card rounded-xl p-5"},Le={class:"flex items-start justify-between"},Ae={class:"flex-1 min-w-0"},De={class:"mt-2 text-2xl font-bold text-cyan-400 tabular-nums"},ze={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-cyan-500/10"},Me={class:"glass-card rounded-xl p-5"},Ee={class:"flex items-start justify-between"},Ie={class:"flex-1 min-w-0"},Fe={class:"mt-2 text-2xl font-bold text-slate-400 tabular-nums"},Be={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-slate-500/10"},Te={class:"glass-card rounded-xl p-5"},Ne={class:"flex items-start justify-between"},Pe={class:"flex-1 min-w-0"},qe={class:"mt-2 text-2xl font-bold text-purple-400 tabular-nums"},He={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-purple-500/10"},Re=A({__name:"VulnSummaryCards",props:{summaries:{}},setup(c){const f=c,i=S(()=>{let g=0,l=0,h=0,b=0,p=0;const r=f.summaries.filter(y=>y.total_vulns>0).length;for(const y of f.summaries)g+=y.total_vulns,l+=y.critical_count,h+=y.high_count,b+=y.medium_count,p+=y.low_count;return{totalVulns:g,critical:l,high:h,medium:b,low:p,affectedAssets:r}});return(g,l)=>(n(),o("div",xe,[e("div",me,[e("div",fe,[e("div",ve,[l[0]||(l[0]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Total Vulns",-1)),e("p",pe,u(i.value.totalVulns),1)]),e("div",_e,[s(t(Q),{class:"h-5 w-5 text-cyan-400"})])])]),e("div",he,[e("div",be,[e("div",ge,[l[1]||(l[1]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Critical",-1)),e("p",ye,u(i.value.critical),1)]),e("div",we,[s(t(T),{class:"h-5 w-5 text-rose-400"})])])]),e("div",ke,[e("div",$e,[e("div",Ce,[l[2]||(l[2]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"High",-1)),e("p",Ve,u(i.value.high),1)]),e("div",je,[s(t(J),{class:"h-5 w-5 text-amber-400"})])])]),e("div",Se,[e("div",Le,[e("div",Ae,[l[3]||(l[3]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Medium",-1)),e("p",De,u(i.value.medium),1)]),e("div",ze,[s(t(O),{class:"h-5 w-5 text-cyan-400"})])])]),e("div",Me,[e("div",Ee,[e("div",Ie,[l[4]||(l[4]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Low",-1)),e("p",Fe,u(i.value.low),1)]),e("div",Be,[s(t(W),{class:"h-5 w-5 text-slate-400"})])])]),e("div",Te,[e("div",Ne,[e("div",Pe,[l[5]||(l[5]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Affected",-1)),e("p",qe,u(i.value.affectedAssets),1)]),e("div",He,[s(t(X),{class:"h-5 w-5 text-purple-400"})])])])]))}}),Ue={key:0,class:"opacity-75"},N=A({__name:"SeverityBadge",props:{severity:{},score:{},class:{}},setup(c){const f=c,i=S(()=>{switch(f.severity.toLowerCase()){case"critical":return{bg:"bg-red-500/20",text:"text-red-400",label:"Critical"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"High"};case"medium":return{bg:"bg-yellow-500/20",text:"text-yellow-400",label:"Medium"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"Low"};default:return{bg:"bg-gray-500/20",text:"text-gray-400",label:"None"}}});return(g,l)=>(n(),o("span",{class:L(t(se)("inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-xs font-semibold",i.value.bg,i.value.text,f.class))},[e("span",null,u(i.value.label),1),c.score!==void 0?(n(),o("span",Ue,u(c.score.toFixed(1)),1)):$("",!0)],2))}}),Ke={class:"glass-panel rounded-xl"},Qe={class:"flex items-center gap-1"},Xe={class:"flex items-center gap-1"},Ge={class:"flex items-center gap-1"},Je={key:0,class:"inline-flex items-center rounded-full bg-red-500/20 px-2 py-0.5 text-xs font-semibold text-red-400"},Oe={key:1,class:"text-xs text-slate-600"},We={key:0,class:"inline-flex items-center rounded-full bg-orange-500/20 px-2 py-0.5 text-xs font-semibold text-orange-400"},Ye={key:1,class:"text-xs text-slate-600"},Ze={key:0,class:"inline-flex items-center rounded-full bg-yellow-500/20 px-2 py-0.5 text-xs font-semibold text-yellow-400"},et={key:1,class:"text-xs text-slate-600"},tt={key:0,class:"inline-flex items-center rounded-full bg-blue-500/20 px-2 py-0.5 text-xs font-semibold text-blue-400"},st={key:1,class:"text-xs text-slate-600"},lt={class:"space-y-2"},at=["onClick"],nt={class:"flex-1 truncate text-xs text-slate-400"},ot={key:0,class:"rounded-full bg-rose-500/20 px-2 py-0.5 text-[10px] font-semibold text-rose-400"},it={key:1,class:"rounded-full bg-emerald-500/20 px-2 py-0.5 text-[10px] font-semibold text-emerald-400"},rt=A({__name:"VulnAssetTable",props:{summaries:{},search:{default:""}},emits:["cve-click"],setup(c,{emit:f}){const i=c,g=f,l=j("max_cvss"),h=j("desc"),b=j(new Set);function p(d){l.value===d?h.value=h.value==="asc"?"desc":"asc":(l.value=d,h.value="desc")}function r(d){const a=new Set(b.value);a.has(d)?a.delete(d):a.add(d),b.value=a}const y=S(()=>{let d=i.summaries;const a=i.search.toLowerCase().trim();a&&(d=d.filter(_=>_.ip.includes(a)||_.matches.some(C=>C.cve.cve_id.toLowerCase().includes(a)||C.cve.description.toLowerCase().includes(a)||(C.asset_vendor??"").toLowerCase().includes(a))));const m=h.value==="asc"?1:-1;return[...d].sort((_,C)=>{let D=0;switch(l.value){case"ip":D=_.ip.localeCompare(C.ip);break;case"total_vulns":D=_.total_vulns-C.total_vulns;break;case"max_cvss":D=_.max_cvss-C.max_cvss;break}return D*m})});function v(d){return d>=9?"text-rose-400":d>=7?"text-amber-400":d>=4?"text-cyan-400":"text-emerald-400"}return(d,a)=>(n(),o("div",Ke,[s(t(Y),null,{default:x(()=>[s(t(Z),null,{default:x(()=>[s(t(M),null,{default:x(()=>[s(t(V),{class:"w-8"}),s(t(V),{class:"cursor-pointer select-none",onClick:a[0]||(a[0]=m=>p("ip"))},{default:x(()=>[e("span",Qe,[a[3]||(a[3]=w(" IP ",-1)),s(t(E),{size:12,class:"text-slate-500"})])]),_:1}),s(t(V),{class:"cursor-pointer select-none",onClick:a[1]||(a[1]=m=>p("total_vulns"))},{default:x(()=>[e("span",Xe,[a[4]||(a[4]=w(" Total ",-1)),s(t(E),{size:12,class:"text-slate-500"})])]),_:1}),s(t(V),null,{default:x(()=>[...a[5]||(a[5]=[w("Critical",-1)])]),_:1}),s(t(V),null,{default:x(()=>[...a[6]||(a[6]=[w("High",-1)])]),_:1}),s(t(V),null,{default:x(()=>[...a[7]||(a[7]=[w("Medium",-1)])]),_:1}),s(t(V),null,{default:x(()=>[...a[8]||(a[8]=[w("Low",-1)])]),_:1}),s(t(V),{class:"cursor-pointer select-none",onClick:a[2]||(a[2]=m=>p("max_cvss"))},{default:x(()=>[e("span",Ge,[a[9]||(a[9]=w(" Max CVSS ",-1)),s(t(E),{size:12,class:"text-slate-500"})])]),_:1})]),_:1})]),_:1}),s(t(ee),null,{default:x(()=>[(n(!0),o(z,null,F(y.value,m=>(n(),o(z,{key:m.ip},[s(t(M),{class:"cursor-pointer",onClick:_=>r(m.ip)},{default:x(()=>[s(t(k),{class:"w-8 pr-0"},{default:x(()=>[(n(),B(P(b.value.has(m.ip)?t(le):t(re)),{size:14,class:"text-slate-500"}))]),_:2},1024),s(t(k),null,{default:x(()=>[s(te,{ip:m.ip},null,8,["ip"])]),_:2},1024),s(t(k),{class:"font-mono text-sm text-slate-300 tabular-nums"},{default:x(()=>[w(u(m.total_vulns),1)]),_:2},1024),s(t(k),null,{default:x(()=>[m.critical_count>0?(n(),o("span",Je,u(m.critical_count),1)):(n(),o("span",Oe,"0"))]),_:2},1024),s(t(k),null,{default:x(()=>[m.high_count>0?(n(),o("span",We,u(m.high_count),1)):(n(),o("span",Ye,"0"))]),_:2},1024),s(t(k),null,{default:x(()=>[m.medium_count>0?(n(),o("span",Ze,u(m.medium_count),1)):(n(),o("span",et,"0"))]),_:2},1024),s(t(k),null,{default:x(()=>[m.low_count>0?(n(),o("span",tt,u(m.low_count),1)):(n(),o("span",st,"0"))]),_:2},1024),s(t(k),null,{default:x(()=>[e("span",{class:L(["font-mono text-sm font-semibold tabular-nums",v(m.max_cvss)])},u(m.max_cvss.toFixed(1)),3)]),_:2},1024)]),_:2},1032,["onClick"]),b.value.has(m.ip)?(n(),B(t(M),{key:0,class:"bg-white/[0.02]"},{default:x(()=>[s(t(k),{colspan:"8",class:"px-8 py-3"},{default:x(()=>[e("div",lt,[(n(!0),o(z,null,F(m.matches,_=>(n(),o("div",{key:_.cve.cve_id,class:"flex items-center gap-3 rounded-lg bg-white/5 px-3 py-2 text-sm"},[e("button",{class:"font-mono text-xs text-cyan-400 hover:text-cyan-300 hover:underline underline-offset-2 transition-colors",onClick:q(C=>g("cve-click",_.cve.cve_id),["stop"])},u(_.cve.cve_id),9,at),s(N,{severity:_.cve.severity,score:_.cve.cvss_score},null,8,["severity","score"]),e("span",nt,u(_.cve.description),1),_.cve.cisa_kev?(n(),o("span",ot," KEV ")):$("",!0),_.cve.fix_available?(n(),o("span",it," Fix ")):$("",!0)]))),128))])]),_:2},1024)]),_:2},1024)):$("",!0)],64))),128))]),_:1})]),_:1})]))}}),ct={class:"glass-panel rounded-xl p-5"},dt={class:"mb-4 flex items-start justify-between"},ut={class:"font-mono text-sm font-semibold text-white"},xt={class:"mt-1 flex items-center gap-2"},mt={class:"mb-4"},ft={class:"flex items-baseline gap-2"},vt={class:"mt-2 h-2 w-full rounded-full bg-white/5"},pt={class:"mb-4"},_t={class:"text-sm leading-relaxed text-slate-300"},ht={class:"mb-4 space-y-2.5 text-sm"},bt={class:"flex items-start justify-between"},gt={class:"text-right text-slate-300"},yt={class:"flex items-start justify-between"},wt={class:"text-right text-slate-300"},kt={key:0,class:"flex items-start justify-between"},$t={class:"text-right font-mono text-xs text-slate-400 max-w-[200px] break-all"},Ct={key:1,class:"flex items-start justify-between"},Vt={class:"text-right text-slate-300"},jt={class:"flex flex-wrap gap-2"},St={key:0,class:"flex items-center gap-1.5 rounded-full bg-emerald-500/10 px-3 py-1.5 text-xs font-medium text-emerald-400"},Lt={key:1,class:"flex items-center gap-1.5 rounded-full bg-slate-500/10 px-3 py-1.5 text-xs font-medium text-slate-400"},At={key:2,class:"flex items-center gap-1.5 rounded-full bg-rose-500/10 px-3 py-1.5 text-xs font-medium text-rose-400"},Dt=["href"],zt=A({__name:"CveDetailPanel",props:{cve:{}},emits:["close"],setup(c,{emit:f}){const i=c,g=f,l=S(()=>{const p=i.cve.cvss_score;return p>=9?"text-rose-400":p>=7?"text-amber-400":p>=4?"text-cyan-400":"text-emerald-400"}),h=S(()=>{const p=i.cve.cvss_score;return p>=9?"bg-rose-400":p>=7?"bg-amber-400":p>=4?"bg-cyan-400":"bg-emerald-400"}),b=S(()=>i.cve.published?new Date(i.cve.published).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null);return(p,r)=>(n(),o("div",ct,[e("div",dt,[e("div",null,[e("h3",ut,u(c.cve.cve_id),1),e("div",xt,[s(N,{severity:c.cve.severity},null,8,["severity"])])]),e("button",{class:"rounded-md p-1 text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",onClick:r[0]||(r[0]=y=>g("close"))},[s(t(ae),{size:16})])]),e("div",mt,[e("div",ft,[e("span",{class:L(["text-3xl font-bold tabular-nums",l.value])},u(c.cve.cvss_score.toFixed(1)),3),r[1]||(r[1]=e("span",{class:"text-xs text-slate-500"},"/ 10.0",-1))]),e("div",vt,[e("div",{class:L(["h-full rounded-full transition-all duration-500",h.value]),style:H({width:`${c.cve.cvss_score/10*100}%`})},null,6)])]),e("div",pt,[r[2]||(r[2]=e("h4",{class:"mb-1 text-xs font-medium uppercase tracking-wider text-slate-500"},"Description",-1)),e("p",_t,u(c.cve.description),1)]),e("div",ht,[e("div",bt,[r[3]||(r[3]=e("span",{class:"text-slate-500"},"Vendor",-1)),e("span",gt,u(c.cve.affected_vendor),1)]),e("div",yt,[r[4]||(r[4]=e("span",{class:"text-slate-500"},"Product",-1)),e("span",wt,u(c.cve.affected_product),1)]),c.cve.cpe?(n(),o("div",kt,[r[5]||(r[5]=e("span",{class:"text-slate-500"},"CPE",-1)),e("span",$t,u(c.cve.cpe),1)])):$("",!0),b.value?(n(),o("div",Ct,[r[6]||(r[6]=e("span",{class:"text-slate-500"},"Published",-1)),e("span",Vt,u(b.value),1)])):$("",!0)]),e("div",jt,[c.cve.fix_available?(n(),o("div",St,[s(t(ne),{size:12}),r[7]||(r[7]=w(" Fix Available ",-1))])):(n(),o("div",Lt," No Fix Available ")),c.cve.cisa_kev?(n(),o("div",At,[s(t(de),{size:12}),r[8]||(r[8]=w(" CISA KEV ",-1))])):$("",!0)]),e("a",{href:`https://nvd.nist.gov/vuln/detail/${c.cve.cve_id}`,target:"_blank",rel:"noopener noreferrer",class:"mt-4 flex items-center gap-1.5 text-xs text-cyan-400 transition-colors hover:text-cyan-300"},[r[9]||(r[9]=w(" View on NVD ",-1)),s(t(ce),{size:10})],8,Dt)]))}}),Mt={class:"space-y-6"},Et={class:"flex items-center justify-between"},It=["disabled"],Ft={key:0,class:"flex flex-col items-center justify-center py-20"},Bt={key:1,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},Tt={class:"mt-2 text-sm text-slate-400"},Nt={class:"flex gap-6"},Pt={class:"flex-1 min-w-0"},qt={key:0,class:"w-80 shrink-0"},Ht={class:"sticky top-4"},as=A({__name:"VulnerabilitiesView",setup(c){const{data:f,loading:i,error:g,fetchVulnerabilities:l}=ue(),h=j(""),b=j(null);function p(y){if(f.value){for(const v of f.value.summaries)for(const d of v.matches)if(d.cve.cve_id===y){b.value=d.cve;return}}}function r(){b.value=null}return R(()=>{l()}),(y,v)=>(n(),o("div",Mt,[e("div",Et,[v[4]||(v[4]=e("div",null,[e("h1",{class:"text-2xl font-bold text-white"},"Vulnerabilities"),e("p",{class:"mt-1 text-sm text-slate-400"}," CVE matching and vulnerability analysis ")],-1)),e("button",{class:"flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 text-xs text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",disabled:t(i),onClick:v[0]||(v[0]=(...d)=>t(l)&&t(l)(...d))},[s(t(oe),{class:L(["h-3.5 w-3.5",{"animate-spin":t(i)}])},null,8,["class"]),v[3]||(v[3]=w(" Refresh ",-1))],8,It)]),t(i)&&!t(f)?(n(),o("div",Ft,[s(t(ie),{class:"h-8 w-8 animate-spin text-cyan-400"}),v[5]||(v[5]=e("p",{class:"mt-3 text-sm text-slate-400"},"Loading vulnerability data...",-1))])):t(g)&&!t(f)?(n(),o("div",Bt,[s(t(T),{class:"mx-auto h-10 w-10 text-amber-400"}),v[6]||(v[6]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Unable to Load Data",-1)),e("p",Tt,u(t(g)),1),e("button",{class:"mt-4 rounded-lg bg-cyan-500/20 px-4 py-2 text-sm font-medium text-cyan-400 transition-colors hover:bg-cyan-500/30",onClick:v[1]||(v[1]=(...d)=>t(l)&&t(l)(...d))}," Try Again ")])):t(f)?(n(),o(z,{key:2},[s(Re,{summaries:t(f).summaries},null,8,["summaries"]),s(G,{modelValue:h.value,"onUpdate:modelValue":v[2]||(v[2]=d=>h.value=d),placeholder:"Search by IP, CVE ID, or description...",class:"max-w-md"},null,8,["modelValue"]),e("div",Nt,[e("div",Pt,[s(rt,{summaries:t(f).summaries,search:h.value,onCveClick:p},null,8,["summaries","search"])]),s(U,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"translate-x-4 opacity-0","enter-to-class":"translate-x-0 opacity-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"translate-x-0 opacity-100","leave-to-class":"translate-x-4 opacity-0"},{default:x(()=>[b.value?(n(),o("div",qt,[e("div",Ht,[s(zt,{cve:b.value,onClose:r},null,8,["cve"])])])):$("",!0)]),_:1})])],64)):$("",!0)]))}});export{as as default};
//# sourceMappingURL=VulnerabilitiesView-KVj6gRz8.js.map
