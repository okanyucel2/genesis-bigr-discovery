{"version":3,"file":"ShieldView-B7pLQ0Rh.js","sources":["../../../../../node_modules/.pnpm/lucide-vue-next@0.469.0_vue@3.5.27_typescript@5.9.3_/node_modules/lucide-vue-next/dist/esm/icons/filter.js","../../../../../node_modules/.pnpm/lucide-vue-next@0.469.0_vue@3.5.27_typescript@5.9.3_/node_modules/lucide-vue-next/dist/esm/icons/flag.js","../../../../../node_modules/.pnpm/lucide-vue-next@0.469.0_vue@3.5.27_typescript@5.9.3_/node_modules/lucide-vue-next/dist/esm/icons/mail.js","../../../../../node_modules/.pnpm/lucide-vue-next@0.469.0_vue@3.5.27_typescript@5.9.3_/node_modules/lucide-vue-next/dist/esm/icons/play.js","../../../../../node_modules/.pnpm/lucide-vue-next@0.469.0_vue@3.5.27_typescript@5.9.3_/node_modules/lucide-vue-next/dist/esm/icons/shield-x.js","../../../../../node_modules/.pnpm/lucide-vue-next@0.469.0_vue@3.5.27_typescript@5.9.3_/node_modules/lucide-vue-next/dist/esm/icons/wrench.js","../../src/stores/shield.ts","../../src/composables/useShield.ts","../../src/components/shield/ScanForm.vue","../../src/components/shield/ShieldScore.vue","../../src/components/shield/ModuleScoreCards.vue","../../src/components/shield/FindingsList.vue","../../src/components/shield/PortScanResults.vue","../../src/components/shield/HeadersChecklist.vue","../../src/components/shield/DnsSecurityCard.vue","../../src/components/shield/ShieldTimeline.vue","../../src/components/shield/CveFindings.vue","../../src/components/shield/CredentialFindings.vue","../../src/components/shield/OwaspResults.vue","../../src/components/shield/RemediationPlan.vue","../../src/components/shield/AttackSurfaceMap.vue","../../src/components/shield/PriorityMatrix.vue","../../src/views/ShieldView.vue"],"sourcesContent":["/**\n * @license lucide-vue-next v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Filter = createLucideIcon(\"FilterIcon\", [\n  [\"polygon\", { points: \"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\", key: \"1yg77f\" }]\n]);\n\nexport { Filter as default };\n//# sourceMappingURL=filter.js.map\n","/**\n * @license lucide-vue-next v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Flag = createLucideIcon(\"FlagIcon\", [\n  [\"path\", { d: \"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z\", key: \"i9b6wo\" }],\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"22\", y2: \"15\", key: \"1cm3nv\" }]\n]);\n\nexport { Flag as default };\n//# sourceMappingURL=flag.js.map\n","/**\n * @license lucide-vue-next v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Mail = createLucideIcon(\"MailIcon\", [\n  [\"rect\", { width: \"20\", height: \"16\", x: \"2\", y: \"4\", rx: \"2\", key: \"18n3k1\" }],\n  [\"path\", { d: \"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\", key: \"1ocrg3\" }]\n]);\n\nexport { Mail as default };\n//# sourceMappingURL=mail.js.map\n","/**\n * @license lucide-vue-next v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Play = createLucideIcon(\"PlayIcon\", [\n  [\"polygon\", { points: \"6 3 20 12 6 21 6 3\", key: \"1oa8hb\" }]\n]);\n\nexport { Play as default };\n//# sourceMappingURL=play.js.map\n","/**\n * @license lucide-vue-next v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ShieldX = createLucideIcon(\"ShieldXIcon\", [\n  [\n    \"path\",\n    {\n      d: \"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\",\n      key: \"oel41y\"\n    }\n  ],\n  [\"path\", { d: \"m14.5 9.5-5 5\", key: \"17q4r4\" }],\n  [\"path\", { d: \"m9.5 9.5 5 5\", key: \"18nt4w\" }]\n]);\n\nexport { ShieldX as default };\n//# sourceMappingURL=shield-x.js.map\n","/**\n * @license lucide-vue-next v0.469.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Wrench = createLucideIcon(\"WrenchIcon\", [\n  [\n    \"path\",\n    {\n      d: \"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\",\n      key: \"cbrjhi\"\n    }\n  ]\n]);\n\nexport { Wrench as default };\n//# sourceMappingURL=wrench.js.map\n","import { defineStore } from 'pinia'\nimport { ref, computed } from 'vue'\nimport type { ShieldScan } from '@/types/shield'\n\nexport const useShieldStore = defineStore('shield', () => {\n  const recentScans = ref<ShieldScan[]>([])\n  const currentScanId = ref<string | null>(null)\n\n  const currentScan = computed(() =>\n    recentScans.value.find((s) => s.id === currentScanId.value) ?? null,\n  )\n\n  function addScan(scan: ShieldScan) {\n    // Add to front, keep max 50 recent scans\n    recentScans.value = [scan, ...recentScans.value.filter((s) => s.id !== scan.id)].slice(0, 50)\n    currentScanId.value = scan.id\n  }\n\n  function updateScan(scan: ShieldScan) {\n    const idx = recentScans.value.findIndex((s) => s.id === scan.id)\n    if (idx !== -1) {\n      recentScans.value[idx] = scan\n    } else {\n      addScan(scan)\n    }\n  }\n\n  function $reset() {\n    recentScans.value = []\n    currentScanId.value = null\n  }\n\n  return {\n    recentScans,\n    currentScanId,\n    currentScan,\n    addScan,\n    updateScan,\n    $reset,\n  }\n})\n","import { ref, onUnmounted } from 'vue'\nimport { bigrApi } from '@/lib/api'\nimport type {\n  ShieldScan,\n  ShieldFinding,\n  ScanDepth,\n  ShieldScanResponse,\n  ShieldFindingsResponse,\n} from '@/types/shield'\nimport { useShieldStore } from '@/stores/shield'\n\nexport function useShield() {\n  const currentScan = ref<ShieldScan | null>(null)\n  const findings = ref<ShieldFinding[]>([])\n  const loading = ref(false)\n  const scanning = ref(false)\n  const error = ref<string | null>(null)\n\n  let pollTimer: ReturnType<typeof setInterval> | null = null\n  const store = useShieldStore()\n\n  function stopPolling() {\n    if (pollTimer !== null) {\n      clearInterval(pollTimer)\n      pollTimer = null\n    }\n  }\n\n  async function startScan(target: string, depth: ScanDepth, modules?: string[]) {\n    loading.value = true\n    scanning.value = true\n    error.value = null\n    try {\n      const res = await bigrApi.startShieldScan(target, depth, modules)\n      const scan = (res.data as ShieldScanResponse).scan\n      currentScan.value = scan\n      store.addScan(scan)\n      pollScan(scan.id)\n      return scan\n    } catch (e: unknown) {\n      const message = e instanceof Error ? e.message : 'Failed to start scan'\n      error.value = message\n      scanning.value = false\n      return null\n    } finally {\n      loading.value = false\n    }\n  }\n\n  async function fetchScan(scanId: string) {\n    loading.value = true\n    error.value = null\n    try {\n      const res = await bigrApi.getShieldScan(scanId)\n      const scan = (res.data as ShieldScanResponse).scan\n      currentScan.value = scan\n      store.updateScan(scan)\n      return scan\n    } catch (e: unknown) {\n      const message = e instanceof Error ? e.message : 'Failed to fetch scan'\n      error.value = message\n      return null\n    } finally {\n      loading.value = false\n    }\n  }\n\n  async function fetchFindings(scanId: string) {\n    loading.value = true\n    error.value = null\n    try {\n      const res = await bigrApi.getShieldFindings(scanId)\n      const data = res.data as ShieldFindingsResponse\n      findings.value = data.findings\n      return data.findings\n    } catch (e: unknown) {\n      const message = e instanceof Error ? e.message : 'Failed to fetch findings'\n      error.value = message\n      return []\n    } finally {\n      loading.value = false\n    }\n  }\n\n  function pollScan(scanId: string) {\n    stopPolling()\n    pollTimer = setInterval(async () => {\n      try {\n        const res = await bigrApi.getShieldScan(scanId)\n        const scan = (res.data as ShieldScanResponse).scan\n        currentScan.value = scan\n        store.updateScan(scan)\n\n        if (scan.status === 'completed' || scan.status === 'failed') {\n          stopPolling()\n          scanning.value = false\n\n          if (scan.status === 'completed') {\n            // Auto-fetch findings when scan completes\n            findings.value = scan.findings ?? []\n            if (findings.value.length === 0) {\n              await fetchFindings(scanId)\n            }\n          }\n        }\n      } catch {\n        // Silently retry on poll errors\n      }\n    }, 2000)\n  }\n\n  onUnmounted(() => {\n    stopPolling()\n  })\n\n  return {\n    currentScan,\n    findings,\n    loading,\n    scanning,\n    error,\n    startScan,\n    fetchScan,\n    fetchFindings,\n    pollScan,\n    stopPolling,\n  }\n}\n","<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport { Shield, Loader2 } from 'lucide-vue-next'\nimport type { ScanDepth } from '@/types/shield'\n\nconst props = defineProps<{\n  scanning?: boolean\n}>()\n\nconst emit = defineEmits<{\n  scan: [target: string, depth: ScanDepth]\n}>()\n\nconst target = ref('')\nconst depth = ref<ScanDepth>('standard')\n\nconst depths: { value: ScanDepth; label: string; desc: string }[] = [\n  { value: 'quick', label: 'Quick', desc: '~30s' },\n  { value: 'standard', label: 'Standard', desc: '~2min' },\n  { value: 'deep', label: 'Deep', desc: '~5min' },\n]\n\nfunction handleSubmit() {\n  const trimmed = target.value.trim()\n  if (!trimmed) return\n  emit('scan', trimmed, depth.value)\n}\n</script>\n\n<template>\n  <div class=\"glass-card rounded-xl p-5\">\n    <form @submit.prevent=\"handleSubmit\" class=\"space-y-4\">\n      <!-- Target input -->\n      <div>\n        <label class=\"mb-1.5 block text-sm font-medium text-slate-300\">\n          Target\n        </label>\n        <input\n          v-model=\"target\"\n          type=\"text\"\n          placeholder=\"example.com or 192.168.1.0/24\"\n          :disabled=\"props.scanning\"\n          class=\"w-full rounded-lg border border-[var(--border-glass)] bg-white/5 px-4 py-2.5 text-sm text-white placeholder-slate-500 outline-none transition-colors focus:border-cyan-500/50 focus:bg-white/10 disabled:opacity-50\"\n        />\n      </div>\n\n      <!-- Depth selector -->\n      <div>\n        <label class=\"mb-1.5 block text-sm font-medium text-slate-300\">\n          Scan Depth\n        </label>\n        <div class=\"flex gap-2\">\n          <button\n            v-for=\"d in depths\"\n            :key=\"d.value\"\n            type=\"button\"\n            :disabled=\"props.scanning\"\n            @click=\"depth = d.value\"\n            :class=\"[\n              'flex-1 rounded-lg border px-3 py-2 text-center text-sm transition-all',\n              depth === d.value\n                ? 'border-cyan-500/50 bg-cyan-500/10 text-cyan-400'\n                : 'border-[var(--border-glass)] bg-white/5 text-slate-400 hover:bg-white/10 hover:text-slate-300',\n              props.scanning ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer',\n            ]\"\n          >\n            <div class=\"font-medium\">{{ d.label }}</div>\n            <div class=\"mt-0.5 text-xs opacity-60\">{{ d.desc }}</div>\n          </button>\n        </div>\n      </div>\n\n      <!-- Submit button -->\n      <button\n        type=\"submit\"\n        :disabled=\"!target.trim() || props.scanning\"\n        :class=\"[\n          'flex w-full items-center justify-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium transition-all',\n          !target.trim() || props.scanning\n            ? 'cursor-not-allowed bg-white/5 text-slate-500'\n            : 'bg-cyan-500/20 text-cyan-400 hover:bg-cyan-500/30',\n        ]\"\n      >\n        <Loader2 v-if=\"props.scanning\" class=\"h-4 w-4 animate-spin\" />\n        <Shield v-else class=\"h-4 w-4\" />\n        {{ props.scanning ? 'Scanning...' : 'Start Scan' }}\n      </button>\n    </form>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed, ref, watch, onMounted } from 'vue'\nimport type { ShieldGrade } from '@/types/shield'\n\nconst props = defineProps<{\n  score: number | null\n  grade: ShieldGrade | null\n  loading?: boolean\n}>()\n\nconst animated = ref(false)\nconst displayScore = ref(0)\nlet animFrame: number | null = null\n\nonMounted(() => {\n  requestAnimationFrame(() => {\n    animated.value = true\n    animateScore(props.score ?? 0)\n  })\n})\n\nwatch(\n  () => props.score,\n  (newVal) => {\n    if (newVal !== null) {\n      animateScore(newVal)\n    }\n  },\n)\n\nfunction animateScore(target: number) {\n  if (animFrame) cancelAnimationFrame(animFrame)\n  const start = displayScore.value\n  const diff = target - start\n  const duration = 1000\n  const startTime = performance.now()\n\n  function step(now: number) {\n    const elapsed = now - startTime\n    const progress = Math.min(elapsed / duration, 1)\n    // Ease out cubic\n    const eased = 1 - Math.pow(1 - progress, 3)\n    displayScore.value = Math.round(start + diff * eased)\n    if (progress < 1) {\n      animFrame = requestAnimationFrame(step)\n    }\n  }\n\n  animFrame = requestAnimationFrame(step)\n}\n\nconst circumference = 2 * Math.PI * 70\n\nconst dashOffset = computed(() => {\n  const progress = animated.value ? (props.score ?? 0) / 100 : 0\n  return circumference * (1 - progress)\n})\n\nconst scoreColor = computed(() => {\n  const s = props.score ?? 0\n  if (s >= 90) return { stroke: '#34d399', text: 'text-emerald-400' }\n  if (s >= 70) return { stroke: '#22d3ee', text: 'text-cyan-400' }\n  if (s >= 50) return { stroke: '#fbbf24', text: 'text-amber-400' }\n  return { stroke: '#fb7185', text: 'text-rose-400' }\n})\n\nconst gradeConfig = computed(() => {\n  const g = props.grade\n  if (!g) return null\n  switch (g) {\n    case 'A+':\n      return { bg: 'bg-emerald-500/20', text: 'text-emerald-400', border: 'border-emerald-500/30' }\n    case 'A':\n    case 'B+':\n      return { bg: 'bg-cyan-500/20', text: 'text-cyan-400', border: 'border-cyan-500/30' }\n    case 'B':\n    case 'C+':\n      return { bg: 'bg-amber-500/20', text: 'text-amber-400', border: 'border-amber-500/30' }\n    case 'C':\n    case 'D':\n    case 'F':\n      return { bg: 'bg-rose-500/20', text: 'text-rose-400', border: 'border-rose-500/30' }\n    default:\n      return { bg: 'bg-slate-500/20', text: 'text-slate-400', border: 'border-slate-500/30' }\n  }\n})\n</script>\n\n<template>\n  <div class=\"flex flex-col items-center justify-center\">\n    <!-- Loading skeleton -->\n    <template v-if=\"loading\">\n      <div class=\"relative h-48 w-48\">\n        <div class=\"absolute inset-0 animate-pulse rounded-full bg-white/5\" />\n      </div>\n      <div class=\"mt-3 h-6 w-16 animate-pulse rounded bg-white/5\" />\n    </template>\n\n    <!-- No scan state -->\n    <template v-else-if=\"score === null\">\n      <div class=\"relative h-48 w-48\">\n        <svg viewBox=\"0 0 160 160\" class=\"h-full w-full -rotate-90\">\n          <circle\n            cx=\"80\"\n            cy=\"80\"\n            r=\"70\"\n            fill=\"none\"\n            stroke=\"rgba(255, 255, 255, 0.05)\"\n            stroke-width=\"10\"\n          />\n        </svg>\n        <div class=\"absolute inset-0 flex flex-col items-center justify-center\">\n          <span class=\"text-sm text-slate-500\">No scan yet</span>\n        </div>\n      </div>\n    </template>\n\n    <!-- Score display -->\n    <template v-else>\n      <div class=\"relative h-48 w-48\">\n        <svg viewBox=\"0 0 160 160\" class=\"h-full w-full -rotate-90\">\n          <!-- Background circle -->\n          <circle\n            cx=\"80\"\n            cy=\"80\"\n            r=\"70\"\n            fill=\"none\"\n            stroke=\"rgba(255, 255, 255, 0.05)\"\n            stroke-width=\"10\"\n          />\n          <!-- Progress circle -->\n          <circle\n            cx=\"80\"\n            cy=\"80\"\n            r=\"70\"\n            fill=\"none\"\n            :stroke=\"scoreColor.stroke\"\n            stroke-width=\"10\"\n            stroke-linecap=\"round\"\n            :stroke-dasharray=\"circumference\"\n            :stroke-dashoffset=\"dashOffset\"\n            class=\"transition-[stroke-dashoffset] duration-1000 ease-out\"\n          />\n        </svg>\n        <!-- Center text -->\n        <div class=\"absolute inset-0 flex flex-col items-center justify-center\">\n          <span :class=\"['text-4xl font-bold tabular-nums', scoreColor.text]\">\n            {{ displayScore }}\n          </span>\n          <span class=\"text-xs text-slate-500\">/ 100</span>\n        </div>\n      </div>\n\n      <!-- Grade badge -->\n      <div\n        v-if=\"gradeConfig\"\n        :class=\"[\n          'mt-3 rounded-lg border px-4 py-1 text-lg font-bold',\n          gradeConfig.bg,\n          gradeConfig.text,\n          gradeConfig.border,\n        ]\"\n      >\n        {{ grade }}\n      </div>\n\n      <p class=\"mt-2 text-sm text-slate-500\">Shield Score</p>\n    </template>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport type { ModuleScore } from '@/types/shield'\n\nconst props = defineProps<{\n  scores: Record<string, ModuleScore>\n}>()\n\nconst moduleLabels: Record<string, string> = {\n  tls: 'TLS',\n  ports: 'Ports',\n  cve: 'CVE',\n  headers: 'Headers',\n  dns: 'DNS',\n  creds: 'Creds',\n  owasp: 'OWASP',\n}\n\nconst moduleList = computed(() => {\n  return Object.entries(props.scores).map(([key, score]) => ({\n    key,\n    label: moduleLabels[key] ?? key.toUpperCase(),\n    ...score,\n  }))\n})\n\nfunction scoreColor(score: number) {\n  if (score >= 80) return { bar: 'bg-emerald-400', text: 'text-emerald-400' }\n  if (score >= 60) return { bar: 'bg-amber-400', text: 'text-amber-400' }\n  return { bar: 'bg-rose-400', text: 'text-rose-400' }\n}\n</script>\n\n<template>\n  <div v-if=\"moduleList.length === 0\" class=\"glass-card rounded-xl p-6 text-center\">\n    <p class=\"text-sm text-slate-500\">No module scores available</p>\n  </div>\n\n  <div v-else class=\"grid grid-cols-2 gap-3 sm:grid-cols-3 lg:grid-cols-4\">\n    <div\n      v-for=\"mod in moduleList\"\n      :key=\"mod.key\"\n      class=\"glass-card rounded-lg p-4\"\n    >\n      <!-- Module name and score -->\n      <div class=\"mb-2 flex items-center justify-between\">\n        <span class=\"text-sm font-medium text-slate-300\">{{ mod.label }}</span>\n        <span :class=\"['text-sm font-bold tabular-nums', scoreColor(mod.score).text]\">\n          {{ mod.score }}\n        </span>\n      </div>\n\n      <!-- Score bar -->\n      <div class=\"mb-2 h-1.5 w-full overflow-hidden rounded-full bg-white/5\">\n        <div\n          :class=\"['h-full rounded-full transition-all duration-700', scoreColor(mod.score).bar]\"\n          :style=\"{ width: `${mod.score}%` }\"\n        />\n      </div>\n\n      <!-- Checks and findings -->\n      <div class=\"flex items-center justify-between text-xs text-slate-500\">\n        <span>{{ mod.passed_checks }}/{{ mod.total_checks }} checks</span>\n        <span v-if=\"mod.findings_count > 0\" class=\"text-rose-400\">\n          {{ mod.findings_count }} finding{{ mod.findings_count !== 1 ? 's' : '' }}\n        </span>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport { ChevronDown, ChevronRight, CheckCircle, ExternalLink } from 'lucide-vue-next'\nimport type { ShieldFinding, FindingSeverity } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\nconst expandedId = ref<string | null>(null)\n\nconst severityOrder: Record<FindingSeverity, number> = {\n  critical: 0,\n  high: 1,\n  medium: 2,\n  low: 3,\n  info: 4,\n}\n\nconst sortedFindings = computed(() => {\n  return [...props.findings].sort(\n    (a, b) => (severityOrder[a.severity] ?? 5) - (severityOrder[b.severity] ?? 5),\n  )\n})\n\nfunction toggleRow(id: string) {\n  expandedId.value = expandedId.value === id ? null : id\n}\n\nfunction severityConfig(severity: FindingSeverity) {\n  switch (severity) {\n    case 'critical':\n      return { bg: 'bg-rose-500/20', text: 'text-rose-400', label: 'CRITICAL' }\n    case 'high':\n      return { bg: 'bg-orange-500/20', text: 'text-orange-400', label: 'HIGH' }\n    case 'medium':\n      return { bg: 'bg-amber-500/20', text: 'text-amber-400', label: 'MEDIUM' }\n    case 'low':\n      return { bg: 'bg-blue-500/20', text: 'text-blue-400', label: 'LOW' }\n    case 'info':\n      return { bg: 'bg-slate-500/20', text: 'text-slate-400', label: 'INFO' }\n    default:\n      return { bg: 'bg-slate-500/20', text: 'text-slate-400', label: severity }\n  }\n}\n\nfunction formatTarget(finding: ShieldFinding): string {\n  if (finding.target_port) {\n    return `${finding.target_ip}:${finding.target_port}`\n  }\n  return finding.target_ip\n}\n</script>\n\n<template>\n  <!-- Empty state -->\n  <div\n    v-if=\"findings.length === 0\"\n    class=\"glass-card rounded-xl p-8 text-center\"\n  >\n    <CheckCircle class=\"mx-auto h-10 w-10 text-emerald-400\" />\n    <h3 class=\"mt-3 text-lg font-medium text-white\">No findings</h3>\n    <p class=\"mt-1 text-sm text-slate-400\">Your target looks secure!</p>\n  </div>\n\n  <!-- Findings table -->\n  <div v-else class=\"glass-card overflow-hidden rounded-xl\">\n    <!-- Header -->\n    <div class=\"border-b border-[var(--border-glass)] px-4 py-3\">\n      <h3 class=\"text-sm font-medium text-white\">\n        Findings\n        <span class=\"ml-1 text-slate-500\">({{ findings.length }})</span>\n      </h3>\n    </div>\n\n    <!-- Table header -->\n    <div\n      class=\"grid grid-cols-[100px_1fr_80px_140px_100px] gap-2 border-b border-[var(--border-glass)] px-4 py-2 text-xs font-medium text-slate-500\"\n    >\n      <span>Severity</span>\n      <span>Title</span>\n      <span>Module</span>\n      <span>Target</span>\n      <span>CVE</span>\n    </div>\n\n    <!-- Rows -->\n    <div\n      v-for=\"finding in sortedFindings\"\n      :key=\"finding.id\"\n      class=\"border-b border-[var(--border-glass)] last:border-0\"\n    >\n      <!-- Main row -->\n      <button\n        class=\"grid w-full grid-cols-[100px_1fr_80px_140px_100px] items-center gap-2 px-4 py-3 text-left text-sm transition-colors hover:bg-white/5\"\n        @click=\"toggleRow(finding.id)\"\n      >\n        <!-- Severity badge -->\n        <span\n          :class=\"[\n            'inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-semibold',\n            severityConfig(finding.severity).bg,\n            severityConfig(finding.severity).text,\n          ]\"\n        >\n          {{ severityConfig(finding.severity).label }}\n        </span>\n\n        <!-- Title -->\n        <span class=\"flex items-center gap-1.5 truncate text-slate-300\">\n          <component\n            :is=\"expandedId === finding.id ? ChevronDown : ChevronRight\"\n            class=\"h-3.5 w-3.5 shrink-0 text-slate-500\"\n          />\n          {{ finding.title }}\n        </span>\n\n        <!-- Module -->\n        <span class=\"text-xs text-slate-500\">{{ finding.module }}</span>\n\n        <!-- Target -->\n        <span class=\"truncate font-mono text-xs text-slate-400\">\n          {{ formatTarget(finding) }}\n        </span>\n\n        <!-- CVE -->\n        <span v-if=\"finding.cve_id\" class=\"font-mono text-xs text-cyan-400\">\n          {{ finding.cve_id }}\n        </span>\n        <span v-else class=\"text-xs text-slate-600\">--</span>\n      </button>\n\n      <!-- Expanded detail -->\n      <div\n        v-if=\"expandedId === finding.id\"\n        class=\"border-t border-[var(--border-glass)] bg-white/[0.02] px-6 py-4\"\n      >\n        <div class=\"space-y-3 text-sm\">\n          <!-- Description -->\n          <div>\n            <h4 class=\"mb-1 text-xs font-medium uppercase text-slate-500\">Description</h4>\n            <p class=\"text-slate-300\">{{ finding.description }}</p>\n          </div>\n\n          <!-- Remediation -->\n          <div>\n            <h4 class=\"mb-1 text-xs font-medium uppercase text-slate-500\">Remediation</h4>\n            <p class=\"text-slate-300\">{{ finding.remediation }}</p>\n          </div>\n\n          <!-- Metadata row -->\n          <div class=\"flex flex-wrap gap-4 text-xs\">\n            <div v-if=\"finding.cvss_score !== null\">\n              <span class=\"text-slate-500\">CVSS:</span>\n              <span class=\"ml-1 font-mono font-semibold text-white\">{{ finding.cvss_score }}</span>\n            </div>\n            <div v-if=\"finding.epss_score !== null\">\n              <span class=\"text-slate-500\">EPSS:</span>\n              <span class=\"ml-1 font-mono text-slate-300\">\n                {{ (finding.epss_score * 100).toFixed(1) }}%\n              </span>\n            </div>\n            <div v-if=\"finding.cisa_kev\">\n              <span class=\"rounded bg-rose-500/20 px-1.5 py-0.5 font-semibold text-rose-400\">\n                CISA KEV\n              </span>\n            </div>\n            <div v-if=\"finding.attack_technique\">\n              <span class=\"text-slate-500\">Technique:</span>\n              <span class=\"ml-1 text-slate-300\">{{ finding.attack_technique }}</span>\n            </div>\n            <div v-if=\"finding.attack_tactic\">\n              <span class=\"text-slate-500\">Tactic:</span>\n              <span class=\"ml-1 text-slate-300\">{{ finding.attack_tactic }}</span>\n            </div>\n            <a\n              v-if=\"finding.cve_id\"\n              :href=\"`https://nvd.nist.gov/vuln/detail/${finding.cve_id}`\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              class=\"inline-flex items-center gap-1 text-cyan-400 hover:text-cyan-300\"\n            >\n              NVD <ExternalLink class=\"h-3 w-3\" />\n            </a>\n          </div>\n\n          <!-- Evidence -->\n          <div v-if=\"finding.evidence && Object.keys(finding.evidence).length > 0\">\n            <h4 class=\"mb-1 text-xs font-medium uppercase text-slate-500\">Evidence</h4>\n            <pre class=\"overflow-x-auto rounded-lg bg-black/30 p-3 font-mono text-xs text-slate-400\">{{ JSON.stringify(finding.evidence, null, 2) }}</pre>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { Network, AlertTriangle, CheckCircle, ShieldAlert } from 'lucide-vue-next'\nimport type { ShieldFinding } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\ninterface PortEntry {\n  port: number\n  service: string\n  risk: 'safe' | 'common' | 'dangerous'\n  finding: ShieldFinding | null\n}\n\nconst safePortSet = new Set([80, 443])\nconst dangerousPortSet = new Set([21, 23, 135, 139, 445, 1433, 1521, 3306, 3389, 5432, 5900, 6379, 8443, 27017])\nconst commonPortSet = new Set([22, 25, 53, 110, 143, 587, 993, 995, 8080, 8443])\n\nconst serviceNames: Record<number, string> = {\n  21: 'FTP',\n  22: 'SSH',\n  23: 'Telnet',\n  25: 'SMTP',\n  53: 'DNS',\n  80: 'HTTP',\n  110: 'POP3',\n  135: 'MSRPC',\n  139: 'NetBIOS',\n  143: 'IMAP',\n  443: 'HTTPS',\n  445: 'SMB',\n  587: 'Submission',\n  993: 'IMAPS',\n  995: 'POP3S',\n  1433: 'MSSQL',\n  1521: 'Oracle',\n  3306: 'MySQL',\n  3389: 'RDP',\n  5432: 'PostgreSQL',\n  5900: 'VNC',\n  6379: 'Redis',\n  8080: 'HTTP-Alt',\n  8443: 'HTTPS-Alt',\n  27017: 'MongoDB',\n}\n\nfunction getPortRisk(port: number): 'safe' | 'common' | 'dangerous' {\n  if (dangerousPortSet.has(port)) return 'dangerous'\n  if (safePortSet.has(port)) return 'safe'\n  if (commonPortSet.has(port)) return 'common'\n  return 'common'\n}\n\nconst portEntries = computed<PortEntry[]>(() => {\n  const entries: PortEntry[] = []\n  const seen = new Set<number>()\n\n  for (const f of props.findings) {\n    const port = f.target_port\n    if (port !== null && !seen.has(port)) {\n      seen.add(port)\n      const service = f.evidence?.service as string | undefined\n      entries.push({\n        port,\n        service: service || serviceNames[port] || 'Unknown',\n        risk: getPortRisk(port),\n        finding: f,\n      })\n    }\n  }\n\n  return entries.sort((a, b) => a.port - b.port)\n})\n\nconst dangerousPorts = computed(() =>\n  portEntries.value.filter((e) => e.risk === 'dangerous'),\n)\n\nconst totalOpen = computed(() => portEntries.value.length)\nconst totalDangerous = computed(() => dangerousPorts.value.length)\n\nfunction riskClasses(risk: 'safe' | 'common' | 'dangerous') {\n  switch (risk) {\n    case 'safe':\n      return 'border-emerald-500/30 bg-emerald-500/10 text-emerald-400'\n    case 'common':\n      return 'border-amber-500/30 bg-amber-500/10 text-amber-400'\n    case 'dangerous':\n      return 'border-rose-500/30 bg-rose-500/10 text-rose-400'\n  }\n}\n</script>\n\n<template>\n  <!-- Empty state -->\n  <div\n    v-if=\"findings.length === 0\"\n    class=\"glass-card rounded-xl p-8 text-center\"\n  >\n    <CheckCircle class=\"mx-auto h-10 w-10 text-emerald-400\" />\n    <h3 class=\"mt-3 text-lg font-medium text-white\">No port findings</h3>\n    <p class=\"mt-1 text-sm text-slate-400\">No open ports detected or port scan was not run.</p>\n  </div>\n\n  <div v-else class=\"glass-card rounded-xl p-5\">\n    <h3 class=\"text-sm font-semibold text-white mb-4 flex items-center gap-2\">\n      <Network class=\"h-4 w-4 text-cyan-400\" />\n      Port Scan Results\n    </h3>\n\n    <!-- Summary -->\n    <div class=\"mb-4 flex items-center gap-4 text-sm\">\n      <span class=\"text-slate-400\">\n        <span class=\"font-mono font-semibold text-white\">{{ totalOpen }}</span>\n        port{{ totalOpen !== 1 ? 's' : '' }} open\n      </span>\n      <span v-if=\"totalDangerous > 0\" class=\"flex items-center gap-1 text-rose-400\">\n        <AlertTriangle class=\"h-3.5 w-3.5\" />\n        <span class=\"font-mono font-semibold\">{{ totalDangerous }}</span>\n        dangerous\n      </span>\n      <span v-else class=\"flex items-center gap-1 text-emerald-400\">\n        <CheckCircle class=\"h-3.5 w-3.5\" />\n        No dangerous ports\n      </span>\n    </div>\n\n    <div class=\"grid gap-5 lg:grid-cols-2\">\n      <!-- Left: Open ports grid -->\n      <div>\n        <h4 class=\"mb-2 text-xs font-medium uppercase text-slate-500\">Open Ports</h4>\n        <div class=\"flex flex-wrap gap-2\">\n          <div\n            v-for=\"entry in portEntries\"\n            :key=\"entry.port\"\n            :class=\"[\n              'inline-flex items-center gap-1.5 rounded-md border px-2.5 py-1 text-xs font-medium',\n              riskClasses(entry.risk),\n            ]\"\n          >\n            <span class=\"font-mono font-bold\">{{ entry.port }}</span>\n            <span class=\"opacity-75\">{{ entry.service }}</span>\n          </div>\n        </div>\n      </div>\n\n      <!-- Right: Dangerous ports detail -->\n      <div v-if=\"dangerousPorts.length > 0\">\n        <h4 class=\"mb-2 text-xs font-medium uppercase text-slate-500\">Dangerous Ports</h4>\n        <div class=\"space-y-2\">\n          <div\n            v-for=\"entry in dangerousPorts\"\n            :key=\"entry.port\"\n            class=\"rounded-lg border border-rose-500/20 bg-rose-500/5 p-3\"\n          >\n            <div class=\"flex items-start gap-2\">\n              <ShieldAlert class=\"mt-0.5 h-4 w-4 shrink-0 text-rose-400\" />\n              <div class=\"min-w-0\">\n                <div class=\"flex items-center gap-2\">\n                  <span class=\"font-mono text-sm font-bold text-rose-400\">\n                    Port {{ entry.port }}\n                  </span>\n                  <span class=\"text-xs text-slate-400\">{{ entry.service }}</span>\n                </div>\n                <p v-if=\"entry.finding\" class=\"mt-1 text-xs text-slate-400\">\n                  {{ entry.finding.description }}\n                </p>\n                <p v-if=\"entry.finding?.remediation\" class=\"mt-1 text-xs text-slate-500\">\n                  {{ entry.finding.remediation }}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Right: All safe message if no dangerous ports -->\n      <div v-else class=\"flex items-center justify-center rounded-lg border border-emerald-500/10 bg-emerald-500/5 p-6\">\n        <div class=\"text-center\">\n          <CheckCircle class=\"mx-auto h-8 w-8 text-emerald-400\" />\n          <p class=\"mt-2 text-sm text-emerald-400\">No dangerous ports detected</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport {\n  CheckCircle,\n  XCircle,\n  AlertTriangle,\n  ChevronDown,\n  ChevronRight,\n  ShieldCheck,\n} from 'lucide-vue-next'\nimport type { ShieldFinding, FindingSeverity } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\ninterface HeaderCheck {\n  name: string\n  key: string\n  status: 'present' | 'missing' | 'info_leak'\n  severity: FindingSeverity | null\n  finding: ShieldFinding | null\n}\n\nconst EXPECTED_HEADERS = [\n  { name: 'Strict-Transport-Security (HSTS)', key: 'strict-transport-security' },\n  { name: 'Content-Security-Policy (CSP)', key: 'content-security-policy' },\n  { name: 'X-Frame-Options', key: 'x-frame-options' },\n  { name: 'X-Content-Type-Options', key: 'x-content-type-options' },\n  { name: 'Referrer-Policy', key: 'referrer-policy' },\n  { name: 'Permissions-Policy', key: 'permissions-policy' },\n  { name: 'Server', key: 'server' },\n  { name: 'X-Powered-By', key: 'x-powered-by' },\n]\n\nconst INFO_LEAK_HEADERS = new Set(['server', 'x-powered-by'])\n\nconst expandedKey = ref<string | null>(null)\n\nfunction toggleExpand(key: string) {\n  expandedKey.value = expandedKey.value === key ? null : key\n}\n\nconst headerChecks = computed<HeaderCheck[]>(() => {\n  return EXPECTED_HEADERS.map((header) => {\n    // Find matching finding for this header\n    const finding = props.findings.find((f) => {\n      const titleLower = f.title.toLowerCase()\n      const keyLower = header.key.toLowerCase()\n      return (\n        titleLower.includes(keyLower) ||\n        titleLower.includes(header.name.toLowerCase().split(' (')[0] ?? '')\n      )\n    })\n\n    if (!finding) {\n      // No finding means the header is present and correct (good)\n      return {\n        name: header.name,\n        key: header.key,\n        status: 'present' as const,\n        severity: null,\n        finding: null,\n      }\n    }\n\n    // Determine status based on whether this is an info leak header or a missing header\n    const isInfoLeak = INFO_LEAK_HEADERS.has(header.key)\n    const titleLower = finding.title.toLowerCase()\n    const isLeaking = isInfoLeak && (titleLower.includes('leak') || titleLower.includes('exposed') || titleLower.includes('server header'))\n\n    return {\n      name: header.name,\n      key: header.key,\n      status: isLeaking ? ('info_leak' as const) : ('missing' as const),\n      severity: finding.severity,\n      finding,\n    }\n  })\n})\n\nconst presentCount = computed(() => headerChecks.value.filter((h) => h.status === 'present').length)\nconst totalHeaders = computed(() => headerChecks.value.length)\n\nfunction statusConfig(status: 'present' | 'missing' | 'info_leak') {\n  switch (status) {\n    case 'present':\n      return { icon: CheckCircle, text: 'text-emerald-400', label: 'Present' }\n    case 'missing':\n      return { icon: XCircle, text: 'text-rose-400', label: 'Missing' }\n    case 'info_leak':\n      return { icon: AlertTriangle, text: 'text-amber-400', label: 'Info Leak' }\n  }\n}\n\nfunction severityConfig(severity: FindingSeverity) {\n  switch (severity) {\n    case 'critical':\n      return { bg: 'bg-rose-500/20', text: 'text-rose-400', label: 'CRITICAL' }\n    case 'high':\n      return { bg: 'bg-orange-500/20', text: 'text-orange-400', label: 'HIGH' }\n    case 'medium':\n      return { bg: 'bg-amber-500/20', text: 'text-amber-400', label: 'MEDIUM' }\n    case 'low':\n      return { bg: 'bg-blue-500/20', text: 'text-blue-400', label: 'LOW' }\n    case 'info':\n      return { bg: 'bg-slate-500/20', text: 'text-slate-400', label: 'INFO' }\n    default:\n      return { bg: 'bg-slate-500/20', text: 'text-slate-400', label: severity }\n  }\n}\n</script>\n\n<template>\n  <!-- Empty state -->\n  <div\n    v-if=\"findings.length === 0 && headerChecks.every((h) => h.status === 'present')\"\n    class=\"glass-card rounded-xl p-8 text-center\"\n  >\n    <ShieldCheck class=\"mx-auto h-10 w-10 text-emerald-400\" />\n    <h3 class=\"mt-3 text-lg font-medium text-white\">All headers present</h3>\n    <p class=\"mt-1 text-sm text-slate-400\">All recommended security headers are configured correctly.</p>\n  </div>\n\n  <div v-else class=\"glass-card rounded-xl p-5\">\n    <h3 class=\"text-sm font-semibold text-white mb-4 flex items-center gap-2\">\n      <ShieldCheck class=\"h-4 w-4 text-cyan-400\" />\n      Security Headers Checklist\n    </h3>\n\n    <!-- Summary -->\n    <div class=\"mb-4 text-sm text-slate-400\">\n      <span class=\"font-mono font-semibold text-white\">{{ presentCount }}</span>\n      / {{ totalHeaders }} headers configured\n    </div>\n\n    <!-- Checklist -->\n    <div class=\"divide-y divide-[var(--border-glass)]\">\n      <div\n        v-for=\"header in headerChecks\"\n        :key=\"header.key\"\n      >\n        <!-- Row -->\n        <button\n          class=\"flex w-full items-center gap-3 px-2 py-3 text-left text-sm transition-colors hover:bg-white/5\"\n          :class=\"{ 'cursor-default': !header.finding }\"\n          @click=\"header.finding ? toggleExpand(header.key) : undefined\"\n        >\n          <!-- Status icon -->\n          <component\n            :is=\"statusConfig(header.status).icon\"\n            :class=\"['h-4 w-4 shrink-0', statusConfig(header.status).text]\"\n          />\n\n          <!-- Header name -->\n          <span\n            :class=\"[\n              'flex-1 font-mono text-xs',\n              header.status === 'present' ? 'text-emerald-400' : header.status === 'info_leak' ? 'text-amber-400' : 'text-rose-400',\n            ]\"\n          >\n            {{ header.name }}\n          </span>\n\n          <!-- Status label -->\n          <span :class=\"['text-xs', statusConfig(header.status).text]\">\n            {{ statusConfig(header.status).label }}\n          </span>\n\n          <!-- Severity badge (if finding exists) -->\n          <span\n            v-if=\"header.severity\"\n            :class=\"[\n              'inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold',\n              severityConfig(header.severity).bg,\n              severityConfig(header.severity).text,\n            ]\"\n          >\n            {{ severityConfig(header.severity).label }}\n          </span>\n\n          <!-- Expand icon -->\n          <component\n            v-if=\"header.finding\"\n            :is=\"expandedKey === header.key ? ChevronDown : ChevronRight\"\n            class=\"h-3.5 w-3.5 shrink-0 text-slate-500\"\n          />\n        </button>\n\n        <!-- Expanded remediation -->\n        <div\n          v-if=\"header.finding && expandedKey === header.key\"\n          class=\"border-t border-[var(--border-glass)] bg-white/[0.02] px-4 py-3\"\n        >\n          <div class=\"space-y-2 text-sm\">\n            <div>\n              <h4 class=\"mb-1 text-xs font-medium uppercase text-slate-500\">Description</h4>\n              <p class=\"text-slate-300\">{{ header.finding.description }}</p>\n            </div>\n            <div>\n              <h4 class=\"mb-1 text-xs font-medium uppercase text-slate-500\">Remediation</h4>\n              <p class=\"text-slate-300\">{{ header.finding.remediation }}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport {\n  Shield,\n  ShieldCheck,\n  ShieldAlert,\n  ShieldX,\n  CheckCircle,\n  XCircle,\n  Mail,\n  Globe,\n} from 'lucide-vue-next'\nimport type { ShieldFinding } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\ninterface DnsCheckResult {\n  name: string\n  key: string\n  status: 'pass' | 'warn' | 'fail'\n  detail: string\n  finding: ShieldFinding | null\n}\n\nfunction findByKey(key: string): ShieldFinding | null {\n  return (\n    props.findings.find((f) => {\n      const title = f.title.toLowerCase()\n      return title.includes(key.toLowerCase())\n    }) ?? null\n  )\n}\n\nconst spfCheck = computed<DnsCheckResult>(() => {\n  const finding = findByKey('SPF')\n  if (!finding) {\n    return { name: 'SPF', key: 'spf', status: 'pass', detail: 'SPF record configured', finding: null }\n  }\n  return {\n    name: 'SPF',\n    key: 'spf',\n    status: finding.severity === 'info' ? 'pass' : 'fail',\n    detail: finding.title,\n    finding,\n  }\n})\n\nconst dkimCheck = computed<DnsCheckResult>(() => {\n  const finding = findByKey('DKIM')\n  if (!finding) {\n    return { name: 'DKIM', key: 'dkim', status: 'pass', detail: 'DKIM record configured', finding: null }\n  }\n  return {\n    name: 'DKIM',\n    key: 'dkim',\n    status: finding.severity === 'info' ? 'pass' : finding.severity === 'low' ? 'warn' : 'fail',\n    detail: finding.title,\n    finding,\n  }\n})\n\nconst dmarcCheck = computed<DnsCheckResult>(() => {\n  const finding = findByKey('DMARC')\n  if (!finding) {\n    return { name: 'DMARC', key: 'dmarc', status: 'pass', detail: 'DMARC policy active', finding: null }\n  }\n  // Determine DMARC policy from evidence\n  const policy = (finding.evidence?.policy as string) ?? ''\n  const status = policy === 'none' ? 'fail' : policy === 'quarantine' ? 'warn' : 'fail'\n  return {\n    name: 'DMARC',\n    key: 'dmarc',\n    status,\n    detail: finding.title,\n    finding,\n  }\n})\n\nconst caaCheck = computed<DnsCheckResult>(() => {\n  const finding = findByKey('CAA')\n  if (!finding) {\n    return { name: 'CAA', key: 'caa', status: 'pass', detail: 'CAA record present', finding: null }\n  }\n  return {\n    name: 'CAA',\n    key: 'caa',\n    status: finding.severity === 'low' ? 'warn' : 'fail',\n    detail: finding.title,\n    finding,\n  }\n})\n\nconst allChecks = computed(() => [spfCheck.value, dkimCheck.value, dmarcCheck.value, caaCheck.value])\n\nconst dmarcPolicy = computed(() => {\n  const f = dmarcCheck.value.finding\n  if (!f) return 'reject'\n  return (f.evidence?.policy as string) ?? 'none'\n})\n\nfunction dmarcPolicyConfig(policy: string) {\n  switch (policy) {\n    case 'reject':\n      return { icon: ShieldCheck, color: 'text-emerald-400', bg: 'bg-emerald-500/10', border: 'border-emerald-500/20', label: 'Reject' }\n    case 'quarantine':\n      return { icon: ShieldAlert, color: 'text-amber-400', bg: 'bg-amber-500/10', border: 'border-amber-500/20', label: 'Quarantine' }\n    default:\n      return { icon: ShieldX, color: 'text-rose-400', bg: 'bg-rose-500/10', border: 'border-rose-500/20', label: 'None' }\n  }\n}\n\nconst emailScore = computed(() => {\n  let score = 0\n  if (spfCheck.value.status === 'pass') score += 30\n  if (dkimCheck.value.status === 'pass') score += 30\n  else if (dkimCheck.value.status === 'warn') score += 15\n  if (dmarcCheck.value.status === 'pass') score += 30\n  else if (dmarcCheck.value.status === 'warn') score += 15\n  if (caaCheck.value.status === 'pass') score += 10\n  else if (caaCheck.value.status === 'warn') score += 5\n  return score\n})\n\nfunction statusIcon(status: 'pass' | 'warn' | 'fail') {\n  switch (status) {\n    case 'pass':\n      return CheckCircle\n    case 'warn':\n      return ShieldAlert\n    case 'fail':\n      return XCircle\n  }\n}\n\nfunction statusColor(status: 'pass' | 'warn' | 'fail') {\n  switch (status) {\n    case 'pass':\n      return 'text-emerald-400'\n    case 'warn':\n      return 'text-amber-400'\n    case 'fail':\n      return 'text-rose-400'\n  }\n}\n\nfunction scoreColor(score: number) {\n  if (score >= 80) return 'text-emerald-400'\n  if (score >= 50) return 'text-amber-400'\n  return 'text-rose-400'\n}\n</script>\n\n<template>\n  <!-- Empty state -->\n  <div\n    v-if=\"findings.length === 0 && allChecks.every((c) => c.status === 'pass')\"\n    class=\"glass-card rounded-xl p-8 text-center\"\n  >\n    <ShieldCheck class=\"mx-auto h-10 w-10 text-emerald-400\" />\n    <h3 class=\"mt-3 text-lg font-medium text-white\">DNS security configured</h3>\n    <p class=\"mt-1 text-sm text-slate-400\">All DNS security records are properly configured.</p>\n  </div>\n\n  <div v-else class=\"glass-card rounded-xl p-5\">\n    <h3 class=\"text-sm font-semibold text-white mb-4 flex items-center gap-2\">\n      <Globe class=\"h-4 w-4 text-cyan-400\" />\n      DNS Security\n    </h3>\n\n    <div class=\"grid gap-5 lg:grid-cols-2\">\n      <!-- Left: Email authentication checks -->\n      <div>\n        <h4 class=\"mb-3 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500\">\n          <Mail class=\"h-3.5 w-3.5\" />\n          Email Authentication\n        </h4>\n\n        <div class=\"space-y-2\">\n          <!-- SPF, DKIM, DMARC main checks -->\n          <div\n            v-for=\"check in [spfCheck, dkimCheck, dmarcCheck]\"\n            :key=\"check.key\"\n            class=\"flex items-center gap-3 rounded-lg border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2.5\"\n          >\n            <component\n              :is=\"statusIcon(check.status)\"\n              :class=\"['h-4 w-4 shrink-0', statusColor(check.status)]\"\n            />\n            <div class=\"min-w-0 flex-1\">\n              <span class=\"text-sm font-medium text-white\">{{ check.name }}</span>\n              <p class=\"truncate text-xs text-slate-500\">{{ check.detail }}</p>\n            </div>\n          </div>\n        </div>\n\n        <!-- DMARC Policy indicator -->\n        <div class=\"mt-3\">\n          <h4 class=\"mb-2 text-xs font-medium uppercase text-slate-500\">DMARC Policy</h4>\n          <div\n            :class=\"[\n              'flex items-center gap-2 rounded-lg border p-3',\n              dmarcPolicyConfig(dmarcPolicy).bg,\n              dmarcPolicyConfig(dmarcPolicy).border,\n            ]\"\n          >\n            <component\n              :is=\"dmarcPolicyConfig(dmarcPolicy).icon\"\n              :class=\"['h-5 w-5', dmarcPolicyConfig(dmarcPolicy).color]\"\n            />\n            <div>\n              <span :class=\"['text-sm font-semibold', dmarcPolicyConfig(dmarcPolicy).color]\">\n                p={{ dmarcPolicy }}\n              </span>\n              <p class=\"text-xs text-slate-500\">\n                {{\n                  dmarcPolicy === 'reject'\n                    ? 'Unauthorized emails are rejected'\n                    : dmarcPolicy === 'quarantine'\n                      ? 'Unauthorized emails are quarantined'\n                      : 'No enforcement - emails pass through'\n                }}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Right: CAA + summary -->\n      <div>\n        <!-- CAA record -->\n        <h4 class=\"mb-3 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500\">\n          <Shield class=\"h-3.5 w-3.5\" />\n          Certificate Authority\n        </h4>\n\n        <div class=\"flex items-center gap-3 rounded-lg border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2.5\">\n          <component\n            :is=\"statusIcon(caaCheck.status)\"\n            :class=\"['h-4 w-4 shrink-0', statusColor(caaCheck.status)]\"\n          />\n          <div class=\"min-w-0 flex-1\">\n            <span class=\"text-sm font-medium text-white\">CAA Record</span>\n            <p class=\"truncate text-xs text-slate-500\">{{ caaCheck.detail }}</p>\n          </div>\n        </div>\n\n        <!-- Email security summary score -->\n        <div class=\"mt-4\">\n          <h4 class=\"mb-3 text-xs font-medium uppercase text-slate-500\">Email Security Score</h4>\n          <div class=\"rounded-lg border border-[var(--border-glass)] bg-white/[0.02] p-4 text-center\">\n            <span :class=\"['text-3xl font-bold tabular-nums', scoreColor(emailScore)]\">\n              {{ emailScore }}\n            </span>\n            <span class=\"text-sm text-slate-500\"> / 100</span>\n            <div class=\"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-white/5\">\n              <div\n                :class=\"[\n                  'h-full rounded-full transition-all duration-700',\n                  emailScore >= 80 ? 'bg-emerald-400' : emailScore >= 50 ? 'bg-amber-400' : 'bg-rose-400',\n                ]\"\n                :style=\"{ width: `${emailScore}%` }\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <!-- Findings detail (if any) -->\n        <div v-if=\"findings.length > 0\" class=\"mt-4\">\n          <h4 class=\"mb-2 text-xs font-medium uppercase text-slate-500\">Issues Found</h4>\n          <div class=\"space-y-1.5\">\n            <div\n              v-for=\"finding in findings\"\n              :key=\"finding.id\"\n              class=\"rounded border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs\"\n            >\n              <span class=\"text-slate-300\">{{ finding.title }}</span>\n              <p class=\"mt-0.5 text-slate-500\">{{ finding.remediation }}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { CheckCircle, XCircle, Loader2, Clock, Play, Flag } from 'lucide-vue-next'\nimport type { ShieldScan } from '@/types/shield'\n\nconst props = defineProps<{\n  scan: ShieldScan\n}>()\n\ninterface TimelineEntry {\n  key: string\n  label: string\n  timestamp: string | null\n  status: 'completed' | 'running' | 'pending' | 'failed'\n  duration: string | null\n  type: 'start' | 'module' | 'end'\n}\n\nconst moduleLabels: Record<string, string> = {\n  tls: 'TLS / SSL Check',\n  ports: 'Port Scan',\n  headers: 'HTTP Headers',\n  dns: 'DNS Security',\n  cve: 'CVE Matching',\n  creds: 'Credential Testing',\n  owasp: 'OWASP Probes',\n}\n\nfunction formatTimestamp(iso: string | null): string {\n  if (!iso) return '--'\n  const d = new Date(iso)\n  return d.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit', second: '2-digit' })\n}\n\nfunction estimateModuleDuration(_moduleIndex: number, totalModules: number, totalDuration: number | null): string | null {\n  if (!totalDuration || totalDuration <= 0) return null\n  // Rough estimate: distribute duration across modules\n  const perModule = totalDuration / totalModules\n  return `${perModule.toFixed(1)}s`\n}\n\nconst entries = computed<TimelineEntry[]>(() => {\n  const result: TimelineEntry[] = []\n  const scan = props.scan\n\n  // Scan created\n  result.push({\n    key: 'created',\n    label: 'Scan created',\n    timestamp: scan.created_at,\n    status: 'completed',\n    duration: null,\n    type: 'start',\n  })\n\n  // Module entries\n  const modules = scan.modules_enabled\n  const isComplete = scan.status === 'completed'\n  const isFailed = scan.status === 'failed'\n  const isRunning = scan.status === 'running'\n\n  modules.forEach((mod, idx) => {\n    let status: TimelineEntry['status'] = 'pending'\n    if (isComplete) {\n      status = 'completed'\n    } else if (isFailed) {\n      // If failed, mark last module as failed, earlier as completed\n      if (idx === modules.length - 1) {\n        status = 'failed'\n      } else {\n        status = 'completed'\n      }\n    } else if (isRunning) {\n      // Assume modules run sequentially - estimate which one is active\n      status = idx === 0 ? 'running' : 'pending'\n    }\n\n    result.push({\n      key: `module-${mod}`,\n      label: moduleLabels[mod] ?? mod.toUpperCase(),\n      timestamp: isComplete || status === 'completed' ? scan.started_at : null,\n      status,\n      duration: isComplete ? estimateModuleDuration(idx, modules.length, scan.duration_seconds) : null,\n      type: 'module',\n    })\n  })\n\n  // Scan completed/failed\n  if (isComplete) {\n    result.push({\n      key: 'completed',\n      label: 'Scan completed',\n      timestamp: scan.completed_at,\n      status: 'completed',\n      duration: scan.duration_seconds ? `${scan.duration_seconds}s total` : null,\n      type: 'end',\n    })\n  } else if (isFailed) {\n    result.push({\n      key: 'failed',\n      label: 'Scan failed',\n      timestamp: scan.completed_at,\n      status: 'failed',\n      duration: null,\n      type: 'end',\n    })\n  } else {\n    result.push({\n      key: 'pending',\n      label: 'Awaiting completion',\n      timestamp: null,\n      status: 'pending',\n      duration: null,\n      type: 'end',\n    })\n  }\n\n  return result\n})\n\nfunction entryIcon(entry: TimelineEntry) {\n  if (entry.type === 'start') return Play\n  if (entry.type === 'end') return Flag\n  switch (entry.status) {\n    case 'completed':\n      return CheckCircle\n    case 'running':\n      return Loader2\n    case 'failed':\n      return XCircle\n    default:\n      return Clock\n  }\n}\n\nfunction entryIconClass(entry: TimelineEntry) {\n  switch (entry.status) {\n    case 'completed':\n      return 'text-cyan-400'\n    case 'running':\n      return 'text-cyan-400 animate-spin'\n    case 'failed':\n      return 'text-rose-400'\n    default:\n      return 'text-slate-600'\n  }\n}\n\nfunction lineClass(entry: TimelineEntry) {\n  switch (entry.status) {\n    case 'completed':\n      return 'bg-cyan-500/40'\n    case 'running':\n      return 'bg-cyan-500/20'\n    case 'failed':\n      return 'bg-rose-500/40'\n    default:\n      return 'bg-slate-700'\n  }\n}\n\nfunction dotGlowClass(entry: TimelineEntry) {\n  if (entry.status === 'completed') return 'shadow-[0_0_6px_rgba(34,211,238,0.4)]'\n  if (entry.status === 'running') return 'shadow-[0_0_8px_rgba(34,211,238,0.6)]'\n  return ''\n}\n</script>\n\n<template>\n  <div class=\"glass-card rounded-xl p-5\">\n    <h3 class=\"text-sm font-semibold text-white mb-4 flex items-center gap-2\">\n      <Clock class=\"h-4 w-4 text-cyan-400\" />\n      Scan Timeline\n    </h3>\n\n    <!-- Vertical timeline -->\n    <div class=\"relative ml-3\">\n      <div\n        v-for=\"(entry, idx) in entries\"\n        :key=\"entry.key\"\n        class=\"relative flex gap-4 pb-6 last:pb-0\"\n      >\n        <!-- Timeline line (not on last item) -->\n        <div\n          v-if=\"idx < entries.length - 1\"\n          :class=\"[\n            'absolute left-[7px] top-5 w-0.5',\n            lineClass(entries[idx + 1] ?? entry),\n          ]\"\n          :style=\"{ height: 'calc(100% - 8px)' }\"\n        />\n\n        <!-- Dot -->\n        <div\n          :class=\"[\n            'relative z-10 flex h-4 w-4 shrink-0 items-center justify-center rounded-full',\n            dotGlowClass(entry),\n          ]\"\n        >\n          <component\n            :is=\"entryIcon(entry)\"\n            :class=\"['h-4 w-4', entryIconClass(entry)]\"\n          />\n        </div>\n\n        <!-- Content -->\n        <div class=\"min-w-0 flex-1 -mt-0.5\">\n          <div class=\"flex items-center gap-2\">\n            <span\n              :class=\"[\n                'text-sm font-medium',\n                entry.status === 'completed' ? 'text-white' :\n                entry.status === 'running' ? 'text-cyan-400' :\n                entry.status === 'failed' ? 'text-rose-400' :\n                'text-slate-500',\n              ]\"\n            >\n              {{ entry.label }}\n            </span>\n            <span\n              v-if=\"entry.duration\"\n              class=\"rounded bg-white/5 px-1.5 py-0.5 font-mono text-xs text-slate-500\"\n            >\n              {{ entry.duration }}\n            </span>\n          </div>\n          <span v-if=\"entry.timestamp\" class=\"mt-0.5 block font-mono text-xs text-slate-600\">\n            {{ formatTimestamp(entry.timestamp) }}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport {\n  ShieldAlert,\n  ShieldCheck,\n  CheckCircle,\n  ExternalLink,\n  ArrowUpDown,\n  Filter,\n  ChevronDown,\n  ChevronRight,\n} from 'lucide-vue-next'\nimport type { ShieldFinding, FindingSeverity } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\ntype SortField = 'severity' | 'cvss' | 'epss'\n\nconst sortBy = ref<SortField>('severity')\nconst expandedId = ref<string | null>(null)\nconst severityFilter = ref<Set<FindingSeverity>>(\n  new Set(['critical', 'high', 'medium', 'low', 'info']),\n)\n\nconst severityOrder: Record<FindingSeverity, number> = {\n  critical: 0,\n  high: 1,\n  medium: 2,\n  low: 3,\n  info: 4,\n}\n\nconst sortedFindings = computed(() => {\n  const filtered = props.findings.filter((f) =>\n    severityFilter.value.has(f.severity),\n  )\n  return [...filtered].sort((a, b) => {\n    switch (sortBy.value) {\n      case 'cvss':\n        return (b.cvss_score ?? 0) - (a.cvss_score ?? 0)\n      case 'epss':\n        return (b.epss_score ?? 0) - (a.epss_score ?? 0)\n      default:\n        return (severityOrder[a.severity] ?? 5) - (severityOrder[b.severity] ?? 5)\n    }\n  })\n})\n\nconst criticalCount = computed(\n  () => props.findings.filter((f) => f.severity === 'critical').length,\n)\nconst kevCount = computed(\n  () => props.findings.filter((f) => f.cisa_kev).length,\n)\n\nfunction toggleRow(id: string) {\n  expandedId.value = expandedId.value === id ? null : id\n}\n\nfunction toggleSeverityFilter(severity: FindingSeverity) {\n  const next = new Set(severityFilter.value)\n  if (next.has(severity)) {\n    next.delete(severity)\n  } else {\n    next.add(severity)\n  }\n  severityFilter.value = next\n}\n\nfunction cvssConfig(score: number | null) {\n  if (score === null) return { bg: 'bg-slate-500/20', text: 'text-slate-400', label: 'N/A' }\n  if (score >= 9.0) return { bg: 'bg-red-500/20', text: 'text-red-400', label: 'Critical' }\n  if (score >= 7.0) return { bg: 'bg-rose-500/20', text: 'text-rose-400', label: 'High' }\n  if (score >= 4.0) return { bg: 'bg-amber-500/20', text: 'text-amber-400', label: 'Medium' }\n  return { bg: 'bg-slate-500/20', text: 'text-slate-400', label: 'Low' }\n}\n\nfunction severityConfig(severity: FindingSeverity) {\n  switch (severity) {\n    case 'critical':\n      return { bg: 'bg-rose-500/20', text: 'text-rose-400', label: 'CRITICAL' }\n    case 'high':\n      return { bg: 'bg-orange-500/20', text: 'text-orange-400', label: 'HIGH' }\n    case 'medium':\n      return { bg: 'bg-amber-500/20', text: 'text-amber-400', label: 'MEDIUM' }\n    case 'low':\n      return { bg: 'bg-blue-500/20', text: 'text-blue-400', label: 'LOW' }\n    case 'info':\n      return { bg: 'bg-slate-500/20', text: 'text-slate-400', label: 'INFO' }\n    default:\n      return { bg: 'bg-slate-500/20', text: 'text-slate-400', label: severity }\n  }\n}\n\nfunction epssPercent(score: number | null): number {\n  if (score === null) return 0\n  return Math.round(score * 100)\n}\n\nfunction epssBarColor(score: number | null): string {\n  if (score === null) return 'bg-slate-500'\n  if (score >= 0.7) return 'bg-red-400'\n  if (score >= 0.4) return 'bg-amber-400'\n  return 'bg-cyan-400'\n}\n\nconst sortOptions: { value: SortField; label: string }[] = [\n  { value: 'severity', label: 'Severity' },\n  { value: 'cvss', label: 'CVSS Score' },\n  { value: 'epss', label: 'EPSS Score' },\n]\n\nconst filterSeverities: FindingSeverity[] = ['critical', 'high', 'medium', 'low', 'info']\n</script>\n\n<template>\n  <!-- Empty state -->\n  <div\n    v-if=\"findings.length === 0\"\n    class=\"glass-card rounded-xl p-8 text-center\"\n  >\n    <CheckCircle class=\"mx-auto h-10 w-10 text-emerald-400\" />\n    <h3 class=\"mt-3 text-lg font-medium text-white\">No CVEs Detected</h3>\n    <p class=\"mt-1 text-sm text-slate-400\">No known vulnerabilities were found for the target services.</p>\n  </div>\n\n  <div v-else class=\"glass-card overflow-hidden rounded-xl\">\n    <!-- Summary bar -->\n    <div class=\"border-b border-[var(--border-glass)] px-4 py-3\">\n      <div class=\"flex flex-wrap items-center gap-4 text-sm\">\n        <h3 class=\"font-semibold text-white flex items-center gap-2\">\n          <ShieldAlert class=\"h-4 w-4 text-rose-400\" />\n          CVE Intelligence\n        </h3>\n        <span class=\"text-slate-400\">\n          <span class=\"font-mono font-semibold text-white\">{{ findings.length }}</span>\n          CVE{{ findings.length !== 1 ? 's' : '' }} found\n        </span>\n        <span v-if=\"criticalCount > 0\" class=\"text-rose-400\">\n          <span class=\"font-mono font-semibold\">{{ criticalCount }}</span> critical\n        </span>\n        <span v-if=\"kevCount > 0\" class=\"flex items-center gap-1 text-red-400\">\n          <ShieldAlert class=\"h-3.5 w-3.5\" />\n          <span class=\"font-mono font-semibold\">{{ kevCount }}</span> actively exploited (KEV)\n        </span>\n      </div>\n    </div>\n\n    <!-- Controls: Sort + Filter -->\n    <div class=\"flex flex-wrap items-center gap-3 border-b border-[var(--border-glass)] px-4 py-2.5\">\n      <!-- Sort -->\n      <div class=\"flex items-center gap-1.5 text-xs text-slate-500\">\n        <ArrowUpDown class=\"h-3.5 w-3.5\" />\n        <span>Sort:</span>\n        <div class=\"flex gap-1\">\n          <button\n            v-for=\"opt in sortOptions\"\n            :key=\"opt.value\"\n            :class=\"[\n              'rounded px-2 py-0.5 transition-colors',\n              sortBy === opt.value\n                ? 'bg-cyan-500/20 text-cyan-400'\n                : 'text-slate-400 hover:bg-white/5 hover:text-slate-300',\n            ]\"\n            @click=\"sortBy = opt.value\"\n          >\n            {{ opt.label }}\n          </button>\n        </div>\n      </div>\n\n      <span class=\"text-slate-700\">|</span>\n\n      <!-- Filter -->\n      <div class=\"flex items-center gap-1.5 text-xs text-slate-500\">\n        <Filter class=\"h-3.5 w-3.5\" />\n        <span>Filter:</span>\n        <div class=\"flex gap-1\">\n          <button\n            v-for=\"sev in filterSeverities\"\n            :key=\"sev\"\n            :class=\"[\n              'rounded px-2 py-0.5 transition-colors',\n              severityFilter.has(sev)\n                ? `${severityConfig(sev).bg} ${severityConfig(sev).text}`\n                : 'text-slate-600 hover:text-slate-400',\n            ]\"\n            @click=\"toggleSeverityFilter(sev)\"\n          >\n            {{ sev }}\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Table header -->\n    <div\n      class=\"hidden md:grid grid-cols-[110px_70px_120px_70px_90px_1fr] gap-2 border-b border-[var(--border-glass)] px-4 py-2 text-xs font-medium text-slate-500\"\n    >\n      <span>CVE ID</span>\n      <span>CVSS</span>\n      <span>EPSS</span>\n      <span>KEV</span>\n      <span>Severity</span>\n      <span>Title</span>\n    </div>\n\n    <!-- Rows -->\n    <div\n      v-for=\"finding in sortedFindings\"\n      :key=\"finding.id\"\n      class=\"border-b border-[var(--border-glass)] last:border-0\"\n    >\n      <!-- Main row -->\n      <button\n        class=\"w-full px-4 py-3 text-left text-sm transition-colors hover:bg-white/5 md:grid md:grid-cols-[110px_70px_120px_70px_90px_1fr] md:items-center md:gap-2\"\n        @click=\"toggleRow(finding.id)\"\n      >\n        <!-- CVE ID -->\n        <a\n          v-if=\"finding.cve_id\"\n          :href=\"`https://nvd.nist.gov/vuln/detail/${finding.cve_id}`\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          class=\"inline-flex items-center gap-1 font-mono text-xs font-semibold text-cyan-400 hover:text-cyan-300\"\n          @click.stop\n        >\n          {{ finding.cve_id }}\n          <ExternalLink class=\"h-2.5 w-2.5\" />\n        </a>\n        <span v-else class=\"text-xs text-slate-600\">--</span>\n\n        <!-- CVSS Badge -->\n        <span\n          :class=\"[\n            'inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-bold tabular-nums',\n            cvssConfig(finding.cvss_score).bg,\n            cvssConfig(finding.cvss_score).text,\n          ]\"\n        >\n          {{ finding.cvss_score !== null ? finding.cvss_score.toFixed(1) : 'N/A' }}\n        </span>\n\n        <!-- EPSS bar -->\n        <div class=\"flex items-center gap-1.5\">\n          <div class=\"h-1.5 w-16 overflow-hidden rounded-full bg-white/5\">\n            <div\n              :class=\"['h-full rounded-full transition-all', epssBarColor(finding.epss_score)]\"\n              :style=\"{ width: `${epssPercent(finding.epss_score)}%` }\"\n            />\n          </div>\n          <span class=\"font-mono text-xs text-slate-400\">\n            {{ finding.epss_score !== null ? `${epssPercent(finding.epss_score)}%` : '--' }}\n          </span>\n        </div>\n\n        <!-- KEV -->\n        <span v-if=\"finding.cisa_kev\" class=\"flex items-center gap-1 text-red-400\">\n          <ShieldAlert class=\"h-3.5 w-3.5\" />\n          <span class=\"text-[10px] font-semibold uppercase\">KEV</span>\n        </span>\n        <span v-else>\n          <ShieldCheck class=\"h-3.5 w-3.5 text-slate-600\" />\n        </span>\n\n        <!-- Severity badge -->\n        <span\n          :class=\"[\n            'inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-semibold',\n            severityConfig(finding.severity).bg,\n            severityConfig(finding.severity).text,\n          ]\"\n        >\n          {{ severityConfig(finding.severity).label }}\n        </span>\n\n        <!-- Title -->\n        <span class=\"flex items-center gap-1.5 truncate text-slate-300\">\n          <component\n            :is=\"expandedId === finding.id ? ChevronDown : ChevronRight\"\n            class=\"h-3.5 w-3.5 shrink-0 text-slate-500\"\n          />\n          {{ finding.title }}\n        </span>\n      </button>\n\n      <!-- Expanded detail -->\n      <div\n        v-if=\"expandedId === finding.id\"\n        class=\"border-t border-[var(--border-glass)] bg-white/[0.02] px-6 py-4\"\n      >\n        <div class=\"space-y-3 text-sm\">\n          <div>\n            <h4 class=\"mb-1 text-xs font-medium uppercase text-slate-500\">Description</h4>\n            <p class=\"text-slate-300\">{{ finding.description }}</p>\n          </div>\n          <div>\n            <h4 class=\"mb-1 text-xs font-medium uppercase text-slate-500\">Remediation</h4>\n            <p class=\"text-slate-300\">{{ finding.remediation }}</p>\n          </div>\n          <div class=\"flex flex-wrap gap-4 text-xs\">\n            <div v-if=\"finding.target_port\">\n              <span class=\"text-slate-500\">Port:</span>\n              <span class=\"ml-1 font-mono text-slate-300\">{{ finding.target_ip }}:{{ finding.target_port }}</span>\n            </div>\n            <div v-if=\"finding.attack_technique\">\n              <span class=\"text-slate-500\">Technique:</span>\n              <span class=\"ml-1 text-slate-300\">{{ finding.attack_technique }}</span>\n            </div>\n            <div v-if=\"finding.attack_tactic\">\n              <span class=\"text-slate-500\">Tactic:</span>\n              <span class=\"ml-1 text-slate-300\">{{ finding.attack_tactic }}</span>\n            </div>\n            <div v-if=\"finding.cisa_kev\">\n              <span class=\"rounded bg-red-500/20 px-1.5 py-0.5 font-semibold text-red-400\">\n                Actively Exploited\n              </span>\n            </div>\n          </div>\n          <div v-if=\"finding.evidence && Object.keys(finding.evidence).length > 0\">\n            <h4 class=\"mb-1 text-xs font-medium uppercase text-slate-500\">Evidence</h4>\n            <pre class=\"overflow-x-auto rounded-lg bg-black/30 p-3 font-mono text-xs text-slate-400\">{{ JSON.stringify(finding.evidence, null, 2) }}</pre>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- No results after filter -->\n    <div\n      v-if=\"sortedFindings.length === 0 && findings.length > 0\"\n      class=\"px-4 py-6 text-center text-sm text-slate-500\"\n    >\n      No CVEs match the current filter. Adjust filters to see results.\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { KeyRound, ShieldCheck } from 'lucide-vue-next'\nimport type { ShieldFinding, FindingSeverity } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\nconst criticalCount = computed(\n  () => props.findings.filter((f) => f.severity === 'critical').length,\n)\nconst highCount = computed(\n  () => props.findings.filter((f) => f.severity === 'high').length,\n)\n\nfunction severityClass(s: FindingSeverity) {\n  const map: Record<string, string> = {\n    critical: 'bg-rose-500/20 text-rose-400',\n    high: 'bg-amber-500/20 text-amber-400',\n    medium: 'bg-yellow-500/20 text-yellow-400',\n    low: 'bg-blue-500/20 text-blue-400',\n    info: 'bg-slate-500/20 text-slate-400',\n  }\n  return map[s] || map.info\n}\n\nfunction severityBorder(s: FindingSeverity) {\n  const map: Record<string, string> = {\n    critical: 'border-rose-500/50',\n    high: 'border-amber-500/50',\n    medium: 'border-yellow-500/50',\n    low: 'border-blue-500/50',\n    info: 'border-slate-500/50',\n  }\n  return map[s] || map.info\n}\n</script>\n\n<template>\n  <div class=\"space-y-4\">\n    <!-- Summary Bar -->\n    <div class=\"glass-card rounded-lg px-4 py-3 flex items-center justify-between\">\n      <div class=\"flex items-center gap-2\">\n        <KeyRound class=\"h-4 w-4 text-amber-400\" />\n        <span class=\"text-sm text-slate-300\">\n          {{ findings.length }} credential {{ findings.length === 1 ? 'issue' : 'issues' }} found\n        </span>\n      </div>\n      <div class=\"flex items-center gap-3 text-xs\">\n        <span v-if=\"criticalCount > 0\" class=\"text-rose-400\">{{ criticalCount }} critical</span>\n        <span v-if=\"highCount > 0\" class=\"text-amber-400\">{{ highCount }} high</span>\n      </div>\n    </div>\n\n    <!-- Empty State -->\n    <div v-if=\"findings.length === 0\" class=\"glass-card rounded-xl p-8 text-center\">\n      <ShieldCheck class=\"mx-auto h-10 w-10 text-emerald-400\" />\n      <h3 class=\"mt-3 text-sm font-medium text-white\">No Default Credentials Found</h3>\n      <p class=\"mt-1 text-xs text-slate-500\">All tested services require proper authentication</p>\n    </div>\n\n    <!-- Findings Grid -->\n    <div v-else class=\"grid gap-3 sm:grid-cols-2\">\n      <div\n        v-for=\"finding in findings\"\n        :key=\"finding.id\"\n        class=\"glass-card rounded-lg p-4 border-l-2\"\n        :class=\"severityBorder(finding.severity)\"\n      >\n        <div class=\"flex items-start justify-between\">\n          <div>\n            <h4 class=\"text-sm font-medium text-white\">{{ finding.title }}</h4>\n            <p class=\"mt-1 text-xs text-slate-400\">{{ finding.description }}</p>\n          </div>\n          <span\n            class=\"ml-2 inline-flex shrink-0 items-center rounded-full px-2 py-0.5 text-[10px] font-semibold uppercase\"\n            :class=\"severityClass(finding.severity)\"\n          >\n            {{ finding.severity }}\n          </span>\n        </div>\n        <div\n          v-if=\"finding.evidence && Object.keys(finding.evidence).length > 0\"\n          class=\"mt-3 rounded bg-black/30 p-2 font-mono text-xs text-slate-400\"\n        >\n          <div v-if=\"(finding.evidence as Record<string, unknown>).service\">\n            Service: {{ (finding.evidence as Record<string, unknown>).service }}\n          </div>\n          <div v-if=\"(finding.evidence as Record<string, unknown>).port\">\n            Port: {{ (finding.evidence as Record<string, unknown>).port }}\n          </div>\n          <div v-if=\"(finding.evidence as Record<string, unknown>).path\">\n            Path: {{ (finding.evidence as Record<string, unknown>).path }}\n          </div>\n        </div>\n        <p v-if=\"finding.remediation\" class=\"mt-2 text-xs text-cyan-400/80\">\n          {{ finding.remediation }}\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { Bug, CheckCircle, XCircle } from 'lucide-vue-next'\nimport type { ShieldFinding, FindingSeverity } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\nconst PROBE_NAMES = [\n  'SQL Injection',\n  'Cross-Site Scripting (XSS)',\n  'Directory Traversal',\n  'Information Disclosure',\n  'Open Redirect',\n]\n\n/** Map probe names to keywords we look for in finding titles/evidence */\nconst PROBE_KEYWORDS: Record<string, string[]> = {\n  'SQL Injection': ['sql injection', 'sqli'],\n  'Cross-Site Scripting (XSS)': ['cross-site scripting', 'xss'],\n  'Directory Traversal': ['directory traversal', 'path traversal', 'lfi'],\n  'Information Disclosure': ['information disclosure', 'info_disclosure', 'exposed', 'git repository'],\n  'Open Redirect': ['open redirect', 'redirect'],\n}\n\ninterface ProbeResult {\n  name: string\n  passed: boolean\n  finding: ShieldFinding | null\n}\n\nfunction matchesProbe(finding: ShieldFinding, keywords: string[]): boolean {\n  const titleLower = finding.title.toLowerCase()\n  const evidence = finding.evidence as Record<string, unknown> | null\n  const probe = evidence?.probe as string | undefined\n  return keywords.some(\n    (kw) =>\n      titleLower.includes(kw) ||\n      (probe && probe.toLowerCase().includes(kw)),\n  )\n}\n\nconst probeResults = computed<ProbeResult[]>(() => {\n  return PROBE_NAMES.map((name) => {\n    const keywords = PROBE_KEYWORDS[name] ?? [name.toLowerCase()]\n    const finding = props.findings.find((f) => matchesProbe(f, keywords)) ?? null\n    return {\n      name,\n      passed: finding === null,\n      finding,\n    }\n  })\n})\n\nconst passCount = computed(\n  () => probeResults.value.filter((p) => p.passed).length,\n)\nconst failCount = computed(\n  () => probeResults.value.filter((p) => !p.passed).length,\n)\n\nconst failedFindings = computed(() =>\n  props.findings.filter((f) => f.severity !== 'info'),\n)\n\nfunction severityTextClass(s: FindingSeverity) {\n  const map: Record<string, string> = {\n    critical: 'text-rose-400',\n    high: 'text-amber-400',\n    medium: 'text-yellow-400',\n    low: 'text-blue-400',\n    info: 'text-slate-400',\n  }\n  return map[s] || map.info\n}\n\nfunction severityClass(s: FindingSeverity) {\n  const map: Record<string, string> = {\n    critical: 'bg-rose-500/20 text-rose-400',\n    high: 'bg-amber-500/20 text-amber-400',\n    medium: 'bg-yellow-500/20 text-yellow-400',\n    low: 'bg-blue-500/20 text-blue-400',\n    info: 'bg-slate-500/20 text-slate-400',\n  }\n  return map[s] || map.info\n}\n</script>\n\n<template>\n  <div class=\"space-y-4\">\n    <!-- Summary -->\n    <div class=\"glass-card rounded-lg px-4 py-3 flex items-center justify-between\">\n      <div class=\"flex items-center gap-2\">\n        <Bug class=\"h-4 w-4 text-purple-400\" />\n        <span class=\"text-sm text-slate-300\">OWASP Probe Results</span>\n      </div>\n      <div class=\"flex items-center gap-3 text-xs\">\n        <span class=\"flex items-center gap-1 text-emerald-400\">\n          <CheckCircle class=\"h-3 w-3\" /> {{ passCount }} passed\n        </span>\n        <span v-if=\"failCount > 0\" class=\"flex items-center gap-1 text-rose-400\">\n          <XCircle class=\"h-3 w-3\" /> {{ failCount }} failed\n        </span>\n      </div>\n    </div>\n\n    <!-- Probe checklist -->\n    <div class=\"glass-card divide-y divide-white/5 rounded-xl\">\n      <div\n        v-for=\"probe in probeResults\"\n        :key=\"probe.name\"\n        class=\"flex items-center gap-3 px-4 py-3\"\n      >\n        <component\n          :is=\"probe.passed ? CheckCircle : XCircle\"\n          class=\"h-4 w-4 shrink-0\"\n          :class=\"probe.passed ? 'text-emerald-400' : 'text-rose-400'\"\n        />\n        <div class=\"min-w-0 flex-1\">\n          <span\n            class=\"text-sm\"\n            :class=\"probe.passed ? 'text-slate-400' : 'text-white'\"\n          >\n            {{ probe.name }}\n          </span>\n          <p\n            v-if=\"!probe.passed && probe.finding\"\n            class=\"mt-0.5 text-xs text-slate-500\"\n          >\n            {{ probe.finding.title }}\n          </p>\n        </div>\n        <span\n          v-if=\"!probe.passed && probe.finding\"\n          class=\"text-[10px] font-semibold uppercase\"\n          :class=\"severityTextClass(probe.finding.severity)\"\n        >\n          {{ probe.finding.severity }}\n        </span>\n      </div>\n    </div>\n\n    <!-- Detailed findings for failed probes -->\n    <div v-if=\"failedFindings.length > 0\" class=\"space-y-3\">\n      <h3 class=\"text-xs font-medium uppercase tracking-wider text-slate-500\">Details</h3>\n      <div\n        v-for=\"finding in failedFindings\"\n        :key=\"finding.id\"\n        class=\"glass-card rounded-lg p-4\"\n      >\n        <div class=\"flex items-start justify-between\">\n          <h4 class=\"text-sm font-medium text-white\">{{ finding.title }}</h4>\n          <span\n            class=\"ml-2 inline-flex shrink-0 items-center rounded-full px-2 py-0.5 text-[10px] font-semibold uppercase\"\n            :class=\"severityClass(finding.severity)\"\n          >\n            {{ finding.severity }}\n          </span>\n        </div>\n        <p class=\"mt-1 text-xs text-slate-400\">{{ finding.description }}</p>\n        <div\n          v-if=\"finding.evidence && Object.keys(finding.evidence).length > 0\"\n          class=\"mt-2 rounded bg-black/30 p-2 font-mono text-xs text-slate-400\"\n        >\n          <template v-for=\"(val, key) in (finding.evidence as Record<string, unknown>)\" :key=\"key\">\n            <div>{{ key }}: {{ val }}</div>\n          </template>\n        </div>\n        <p v-if=\"finding.remediation\" class=\"mt-2 text-xs text-cyan-400/80\">\n          {{ finding.remediation }}\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { Wrench } from 'lucide-vue-next'\nimport type { ShieldFinding, FindingSeverity } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\ninterface PlanItem {\n  finding: ShieldFinding\n  effort: string\n  impact: string\n  label: string\n}\n\nfunction computePriority(finding: ShieldFinding): { effort: string; impact: string; label: string } {\n  const impact = (['critical', 'high'] as FindingSeverity[]).includes(finding.severity) ? 'high' : 'low'\n\n  const lowEffortModules = ['headers', 'dns', 'tls']\n  const highEffortModules = ['cve', 'owasp']\n  let effort: string\n  if (lowEffortModules.includes(finding.module)) {\n    effort = 'low'\n  } else if (highEffortModules.includes(finding.module)) {\n    effort = 'high'\n  } else {\n    effort = 'medium'\n  }\n\n  if (impact === 'high' && effort === 'low') return { effort, impact, label: 'Quick Win' }\n  if (impact === 'high' && effort !== 'low') return { effort, impact, label: 'Important' }\n  if (impact === 'low' && effort !== 'high') return { effort, impact, label: 'Nice to Have' }\n  return { effort, impact, label: 'Deprioritize' }\n}\n\nconst labelOrder: Record<string, number> = {\n  'Quick Win': 0,\n  'Important': 1,\n  'Nice to Have': 2,\n  'Deprioritize': 3,\n}\n\nconst planItems = computed<PlanItem[]>(() => {\n  return props.findings\n    .filter((f) => f.remediation)\n    .map((f) => ({\n      finding: f,\n      ...computePriority(f),\n    }))\n    .sort((a, b) => (labelOrder[a.label] ?? 4) - (labelOrder[b.label] ?? 4))\n})\n\ninterface Quadrant {\n  label: string\n  count: number\n  color: string\n}\n\nconst quadrants = computed<Quadrant[]>(() => {\n  const counts: Record<string, number> = {\n    'Quick Win': 0,\n    'Important': 0,\n    'Nice to Have': 0,\n    'Deprioritize': 0,\n  }\n  for (const item of planItems.value) {\n    counts[item.label] = (counts[item.label] ?? 0) + 1\n  }\n  return [\n    { label: 'Quick Win', count: counts['Quick Win'] ?? 0, color: 'text-emerald-400' },\n    { label: 'Important', count: counts['Important'] ?? 0, color: 'text-amber-400' },\n    { label: 'Nice to Have', count: counts['Nice to Have'] ?? 0, color: 'text-cyan-400' },\n    { label: 'Deprioritize', count: counts['Deprioritize'] ?? 0, color: 'text-slate-400' },\n  ]\n})\n\nfunction priorityBadgeClass(label: string): string {\n  switch (label) {\n    case 'Quick Win':\n      return 'bg-emerald-500/20 text-emerald-400'\n    case 'Important':\n      return 'bg-amber-500/20 text-amber-400'\n    case 'Nice to Have':\n      return 'bg-cyan-500/20 text-cyan-400'\n    case 'Deprioritize':\n      return 'bg-slate-500/20 text-slate-400'\n    default:\n      return 'bg-slate-500/20 text-slate-400'\n  }\n}\n</script>\n\n<template>\n  <div class=\"space-y-4\">\n    <!-- Header -->\n    <div class=\"glass-card rounded-lg px-4 py-3 flex items-center gap-2\">\n      <Wrench class=\"h-4 w-4 text-cyan-400\" />\n      <span class=\"text-sm font-medium text-white\">Remediation Plan</span>\n      <span class=\"text-xs text-slate-500\">({{ planItems.length }} actions)</span>\n    </div>\n\n    <!-- Empty state -->\n    <div\n      v-if=\"planItems.length === 0\"\n      class=\"glass-card rounded-xl p-8 text-center\"\n    >\n      <Wrench class=\"mx-auto h-10 w-10 text-slate-500\" />\n      <h3 class=\"mt-3 text-sm font-medium text-white\">No Remediation Actions</h3>\n      <p class=\"mt-1 text-xs text-slate-500\">No findings with remediation steps available.</p>\n    </div>\n\n    <template v-else>\n      <!-- Quadrant Summary -->\n      <div class=\"grid grid-cols-2 gap-3 sm:grid-cols-4\">\n        <div\n          v-for=\"q in quadrants\"\n          :key=\"q.label\"\n          class=\"glass-card rounded-lg p-3 text-center\"\n        >\n          <div class=\"text-lg font-bold\" :class=\"q.color\">{{ q.count }}</div>\n          <div class=\"text-xs text-slate-500\">{{ q.label }}</div>\n        </div>\n      </div>\n\n      <!-- Plan Items -->\n      <div class=\"space-y-2\">\n        <div\n          v-for=\"(item, idx) in planItems\"\n          :key=\"item.finding.id\"\n          class=\"glass-card flex items-start gap-3 rounded-lg px-4 py-3\"\n        >\n          <span class=\"mt-0.5 flex h-5 w-5 shrink-0 items-center justify-center rounded-full bg-white/10 text-xs font-bold text-slate-400\">\n            {{ idx + 1 }}\n          </span>\n          <div class=\"min-w-0 flex-1\">\n            <div class=\"flex items-center gap-2\">\n              <span\n                class=\"rounded px-1.5 py-0.5 text-[10px] font-bold uppercase\"\n                :class=\"priorityBadgeClass(item.label)\"\n              >\n                {{ item.label }}\n              </span>\n              <span class=\"text-sm text-white\">{{ item.finding.title }}</span>\n            </div>\n            <p class=\"mt-1 text-xs text-slate-400\">{{ item.finding.remediation }}</p>\n            <div class=\"mt-2 flex items-center gap-3 text-[10px] text-slate-500\">\n              <span>Effort: {{ item.effort }}</span>\n              <span>Impact: {{ item.impact }}</span>\n              <span>Module: {{ item.finding.module }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </template>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { Network, ShieldAlert, CheckCircle, Server, Bug } from 'lucide-vue-next'\nimport type { ShieldFinding, FindingSeverity } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\ninterface PortNode {\n  port: number\n  ip: string\n}\n\ninterface ServiceNode {\n  name: string\n  version: string | null\n  ports: number[]\n}\n\ninterface CveNode {\n  cveId: string\n  severity: FindingSeverity\n  service: string\n  port: number | null\n}\n\ninterface AttackChain {\n  ports: PortNode[]\n  services: ServiceNode[]\n  cves: CveNode[]\n}\n\nconst portFindings = computed(() =>\n  props.findings.filter((f) => f.module === 'ports'),\n)\n\nconst cveFindings = computed(() =>\n  props.findings.filter((f) => f.module === 'cve'),\n)\n\nconst attackChain = computed<AttackChain>(() => {\n  const portsMap = new Map<number, PortNode>()\n  const servicesMap = new Map<string, ServiceNode>()\n  const cves: CveNode[] = []\n\n  // Extract ports and services from port findings\n  for (const f of portFindings.value) {\n    if (f.target_port !== null) {\n      if (!portsMap.has(f.target_port)) {\n        portsMap.set(f.target_port, { port: f.target_port, ip: f.target_ip })\n      }\n      const serviceName = (f.evidence?.service as string | undefined)?.toLowerCase() ?? 'unknown'\n      const banner = f.evidence?.banner as string | undefined\n      if (!servicesMap.has(serviceName)) {\n        servicesMap.set(serviceName, {\n          name: serviceName,\n          version: banner ?? null,\n          ports: [],\n        })\n      }\n      const svc = servicesMap.get(serviceName)\n      if (svc && !svc.ports.includes(f.target_port)) {\n        svc.ports.push(f.target_port)\n      }\n    }\n  }\n\n  // Extract CVEs and link to services\n  for (const f of cveFindings.value) {\n    if (f.cve_id) {\n      const serviceName = (f.evidence?.service as string | undefined)?.toLowerCase() ?? 'unknown'\n      cves.push({\n        cveId: f.cve_id,\n        severity: f.severity,\n        service: serviceName,\n        port: f.target_port,\n      })\n\n      // Ensure the service exists in the map\n      if (!servicesMap.has(serviceName)) {\n        servicesMap.set(serviceName, {\n          name: serviceName,\n          version: null,\n          ports: f.target_port !== null ? [f.target_port] : [],\n        })\n      }\n      // Ensure the port exists\n      if (f.target_port !== null && !portsMap.has(f.target_port)) {\n        portsMap.set(f.target_port, { port: f.target_port, ip: f.target_ip })\n      }\n    }\n  }\n\n  const ports = Array.from(portsMap.values()).sort((a, b) => a.port - b.port)\n  const services = Array.from(servicesMap.values()).sort((a, b) =>\n    a.name.localeCompare(b.name),\n  )\n\n  return { ports, services, cves }\n})\n\nconst hasCves = computed(() => attackChain.value.cves.length > 0)\nconst hasData = computed(\n  () => attackChain.value.ports.length > 0 || attackChain.value.cves.length > 0,\n)\n\nfunction sevColor(severity: FindingSeverity): string {\n  switch (severity) {\n    case 'critical':\n      return 'border-red-500/40 bg-red-500/10 text-red-400'\n    case 'high':\n      return 'border-rose-500/40 bg-rose-500/10 text-rose-400'\n    case 'medium':\n      return 'border-amber-500/40 bg-amber-500/10 text-amber-400'\n    case 'low':\n      return 'border-blue-500/40 bg-blue-500/10 text-blue-400'\n    default:\n      return 'border-slate-500/40 bg-slate-500/10 text-slate-400'\n  }\n}\n\nfunction sevDot(severity: FindingSeverity): string {\n  switch (severity) {\n    case 'critical':\n      return 'bg-red-400'\n    case 'high':\n      return 'bg-rose-400'\n    case 'medium':\n      return 'bg-amber-400'\n    case 'low':\n      return 'bg-blue-400'\n    default:\n      return 'bg-slate-400'\n  }\n}\n\nfunction getServiceCves(serviceName: string): CveNode[] {\n  return attackChain.value.cves.filter((c) => c.service === serviceName)\n}\n\nfunction getServicePorts(serviceName: string): number[] {\n  const svc = attackChain.value.services.find((s) => s.name === serviceName)\n  return svc?.ports ?? []\n}\n</script>\n\n<template>\n  <!-- Empty state -->\n  <div\n    v-if=\"!hasData\"\n    class=\"glass-card rounded-xl p-8 text-center\"\n  >\n    <CheckCircle class=\"mx-auto h-10 w-10 text-emerald-400\" />\n    <h3 class=\"mt-3 text-lg font-medium text-white\">No Attack Surface Data</h3>\n    <p class=\"mt-1 text-sm text-slate-400\">\n      No port or CVE findings available to map the attack surface.\n    </p>\n  </div>\n\n  <div v-else class=\"glass-card rounded-xl p-5\">\n    <h3 class=\"text-sm font-semibold text-white mb-4 flex items-center gap-2\">\n      <Network class=\"h-4 w-4 text-cyan-400\" />\n      Attack Surface Map\n    </h3>\n\n    <p class=\"mb-4 text-xs text-slate-500\">\n      Showing port-to-service-to-CVE chain. Connections indicate potential attack paths.\n    </p>\n\n    <!-- 3-Column Flow -->\n    <div class=\"grid grid-cols-1 gap-4 md:grid-cols-3\">\n      <!-- Column 1: Ports -->\n      <div>\n        <h4 class=\"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500\">\n          <Network class=\"h-3.5 w-3.5\" />\n          Open Ports\n        </h4>\n        <div class=\"space-y-1.5\">\n          <div\n            v-for=\"port in attackChain.ports\"\n            :key=\"port.port\"\n            class=\"flex items-center gap-2 rounded-md border border-cyan-500/20 bg-cyan-500/5 px-3 py-2\"\n          >\n            <span class=\"font-mono text-sm font-bold text-cyan-400\">{{ port.port }}</span>\n            <span class=\"text-xs text-slate-500\">{{ port.ip }}</span>\n          </div>\n          <div\n            v-if=\"attackChain.ports.length === 0\"\n            class=\"rounded-md border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs text-slate-500\"\n          >\n            No ports detected\n          </div>\n        </div>\n      </div>\n\n      <!-- Column 2: Services (with connection indicators) -->\n      <div>\n        <h4 class=\"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500\">\n          <Server class=\"h-3.5 w-3.5\" />\n          Services\n        </h4>\n        <div class=\"space-y-1.5\">\n          <div\n            v-for=\"svc in attackChain.services\"\n            :key=\"svc.name\"\n            class=\"relative rounded-md border border-slate-500/20 bg-white/[0.03] px-3 py-2\"\n          >\n            <!-- Connection line left -->\n            <div class=\"absolute -left-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block\" />\n            <!-- Connection line right (only if has CVEs) -->\n            <div\n              v-if=\"getServiceCves(svc.name).length > 0\"\n              class=\"absolute -right-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block\"\n            />\n            <div class=\"flex items-center gap-2\">\n              <span class=\"text-sm font-medium text-white\">{{ svc.name }}</span>\n              <span v-if=\"svc.version\" class=\"truncate text-xs text-slate-500\">{{ svc.version }}</span>\n            </div>\n            <div class=\"mt-1 flex flex-wrap gap-1\">\n              <span\n                v-for=\"p in getServicePorts(svc.name)\"\n                :key=\"p\"\n                class=\"rounded bg-white/5 px-1.5 py-0.5 font-mono text-[10px] text-slate-400\"\n              >\n                :{{ p }}\n              </span>\n            </div>\n            <div\n              v-if=\"getServiceCves(svc.name).length > 0\"\n              class=\"mt-1.5 flex items-center gap-1 text-[10px] text-rose-400\"\n            >\n              <Bug class=\"h-3 w-3\" />\n              {{ getServiceCves(svc.name).length }} CVE{{ getServiceCves(svc.name).length !== 1 ? 's' : '' }}\n            </div>\n          </div>\n          <div\n            v-if=\"attackChain.services.length === 0\"\n            class=\"rounded-md border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs text-slate-500\"\n          >\n            No services detected\n          </div>\n        </div>\n      </div>\n\n      <!-- Column 3: CVEs -->\n      <div>\n        <h4 class=\"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500\">\n          <ShieldAlert class=\"h-3.5 w-3.5\" />\n          CVEs\n        </h4>\n        <div class=\"space-y-1.5\">\n          <div\n            v-for=\"cve in attackChain.cves\"\n            :key=\"cve.cveId\"\n            :class=\"[\n              'relative rounded-md border px-3 py-2',\n              sevColor(cve.severity),\n            ]\"\n          >\n            <!-- Connection line left -->\n            <div class=\"absolute -left-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block\" />\n            <div class=\"flex items-center gap-2\">\n              <span :class=\"['h-2 w-2 rounded-full', sevDot(cve.severity)]\" />\n              <a\n                :href=\"`https://nvd.nist.gov/vuln/detail/${cve.cveId}`\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                class=\"font-mono text-xs font-semibold hover:underline\"\n                @click.stop\n              >\n                {{ cve.cveId }}\n              </a>\n            </div>\n            <div class=\"mt-1 text-[10px] opacity-75\">\n              {{ cve.service }}{{ cve.port !== null ? ` :${cve.port}` : '' }}\n            </div>\n          </div>\n          <div\n            v-if=\"!hasCves\"\n            class=\"rounded-md border border-emerald-500/20 bg-emerald-500/5 px-3 py-4 text-center\"\n          >\n            <CheckCircle class=\"mx-auto h-5 w-5 text-emerald-400\" />\n            <p class=\"mt-1 text-xs text-emerald-400\">No CVE associations found</p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Flow arrows label (visible on md+) -->\n    <div class=\"mt-3 hidden items-center justify-center gap-6 text-xs text-slate-600 md:flex\">\n      <span>Ports</span>\n      <span>--&gt;</span>\n      <span>Services</span>\n      <span>--&gt;</span>\n      <span>Vulnerabilities</span>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport type { ShieldFinding } from '@/types/shield'\n\nconst props = defineProps<{\n  findings: ShieldFinding[]\n}>()\n\n// Filter to findings that have both CVSS and EPSS\nconst cvePoints = computed(() =>\n  props.findings.filter(f => f.cvss_score != null && f.epss_score != null)\n    .map(f => ({\n      id: f.id,\n      cveId: f.cve_id ?? f.title,\n      cvss: f.cvss_score!,\n      epss: f.epss_score! * 100, // Convert to percentage\n      severity: f.severity,\n      kev: f.cisa_kev,\n    }))\n)\n\n// Position calculation: X = CVSS (0-10)  0-100%, Y = EPSS (0-100)  inverted (100-0%)\nfunction dotStyle(point: { cvss: number; epss: number }) {\n  return {\n    left: `${(point.cvss / 10) * 100}%`,\n    bottom: `${point.epss}%`,\n  }\n}\n\nfunction dotColor(severity: string): string {\n  switch (severity) {\n    case 'critical': return 'bg-red-500'\n    case 'high': return 'bg-rose-500'\n    case 'medium': return 'bg-amber-500'\n    case 'low': return 'bg-slate-400'\n    default: return 'bg-slate-500'\n  }\n}\n\nconst quadrantCounts = computed(() => {\n  const q = { urgent: 0, monitor: 0, plan: 0, low: 0 }\n  for (const p of cvePoints.value) {\n    if (p.cvss >= 5 && p.epss >= 50) q.urgent++\n    else if (p.cvss < 5 && p.epss >= 50) q.monitor++\n    else if (p.cvss >= 5 && p.epss < 50) q.plan++\n    else q.low++\n  }\n  return q\n})\n</script>\n\n<template>\n  <div class=\"glass-card rounded-xl p-4\">\n    <h3 class=\"mb-3 text-sm font-medium text-white\">Priority Matrix</h3>\n\n    <div v-if=\"cvePoints.length === 0\" class=\"flex flex-col items-center justify-center py-12 text-slate-500\">\n      <p class=\"text-sm\">No CVE data for priority matrix</p>\n    </div>\n\n    <div v-else>\n      <!-- Quadrant summary -->\n      <div class=\"mb-4 grid grid-cols-4 gap-2 text-center text-xs\">\n        <div class=\"rounded bg-red-500/10 px-2 py-1\">\n          <span class=\"font-bold text-red-400\">{{ quadrantCounts.urgent }}</span>\n          <span class=\"text-slate-500\"> Urgent</span>\n        </div>\n        <div class=\"rounded bg-amber-500/10 px-2 py-1\">\n          <span class=\"font-bold text-amber-400\">{{ quadrantCounts.monitor }}</span>\n          <span class=\"text-slate-500\"> Monitor</span>\n        </div>\n        <div class=\"rounded bg-rose-500/10 px-2 py-1\">\n          <span class=\"font-bold text-rose-400\">{{ quadrantCounts.plan }}</span>\n          <span class=\"text-slate-500\"> Plan</span>\n        </div>\n        <div class=\"rounded bg-slate-500/10 px-2 py-1\">\n          <span class=\"font-bold text-slate-400\">{{ quadrantCounts.low }}</span>\n          <span class=\"text-slate-500\"> Low</span>\n        </div>\n      </div>\n\n      <!-- Scatter plot -->\n      <div class=\"relative\">\n        <!-- Y-axis label -->\n        <div class=\"absolute -left-6 top-1/2 -translate-y-1/2 -rotate-90 text-[10px] text-slate-500 whitespace-nowrap\">\n          EPSS Score (%)\n        </div>\n\n        <!-- Plot area -->\n        <div class=\"relative ml-4 aspect-square w-full overflow-hidden rounded-lg border border-white/5 bg-white/[0.02]\">\n          <!-- Quadrant backgrounds -->\n          <div class=\"absolute right-0 top-0 h-1/2 w-1/2 bg-red-500/5\" />\n          <div class=\"absolute left-0 top-0 h-1/2 w-1/2 bg-amber-500/5\" />\n          <div class=\"absolute bottom-0 right-0 h-1/2 w-1/2 bg-rose-500/5\" />\n          <div class=\"absolute bottom-0 left-0 h-1/2 w-1/2 bg-slate-500/5\" />\n\n          <!-- Grid lines -->\n          <div class=\"absolute left-1/2 top-0 h-full w-px bg-white/10\" />\n          <div class=\"absolute left-0 top-1/2 h-px w-full bg-white/10\" />\n\n          <!-- Quadrant labels -->\n          <span class=\"absolute right-2 top-2 text-[9px] font-medium text-red-400/60\">URGENT</span>\n          <span class=\"absolute left-2 top-2 text-[9px] font-medium text-amber-400/60\">MONITOR</span>\n          <span class=\"absolute bottom-2 right-2 text-[9px] font-medium text-rose-400/60\">PLAN</span>\n          <span class=\"absolute bottom-2 left-2 text-[9px] font-medium text-slate-400/60\">LOW</span>\n\n          <!-- Data points -->\n          <div\n            v-for=\"point in cvePoints\"\n            :key=\"point.id\"\n            class=\"group absolute -ml-1.5 -mb-1.5 h-3 w-3 rounded-full transition-transform hover:scale-150\"\n            :class=\"[dotColor(point.severity), point.kev ? 'ring-2 ring-red-400 animate-pulse' : '']\"\n            :style=\"dotStyle(point)\"\n          >\n            <!-- Tooltip -->\n            <div class=\"invisible absolute bottom-full left-1/2 mb-2 -translate-x-1/2 whitespace-nowrap rounded bg-slate-800 px-2 py-1 text-[10px] text-white shadow-lg group-hover:visible z-10\">\n              <div class=\"font-mono font-bold\">{{ point.cveId }}</div>\n              <div>CVSS: {{ point.cvss }} | EPSS: {{ point.epss.toFixed(0) }}%</div>\n              <div v-if=\"point.kev\" class=\"text-red-400\">CISA KEV</div>\n            </div>\n          </div>\n        </div>\n\n        <!-- X-axis label -->\n        <div class=\"mt-1 text-center text-[10px] text-slate-500\">CVSS Score (0-10)</div>\n\n        <!-- X-axis ticks -->\n        <div class=\"ml-4 flex justify-between text-[9px] text-slate-600\">\n          <span>0</span>\n          <span>5</span>\n          <span>10</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport {\n  Shield,\n  Loader2,\n  AlertTriangle,\n  RefreshCw,\n  CheckCircle,\n  XCircle,\n} from 'lucide-vue-next'\nimport { useShield } from '@/composables/useShield'\nimport type { ScanDepth } from '@/types/shield'\nimport ScanForm from '@/components/shield/ScanForm.vue'\nimport ShieldScore from '@/components/shield/ShieldScore.vue'\nimport ModuleScoreCards from '@/components/shield/ModuleScoreCards.vue'\nimport FindingsList from '@/components/shield/FindingsList.vue'\nimport PortScanResults from '@/components/shield/PortScanResults.vue'\nimport HeadersChecklist from '@/components/shield/HeadersChecklist.vue'\nimport DnsSecurityCard from '@/components/shield/DnsSecurityCard.vue'\nimport ShieldTimeline from '@/components/shield/ShieldTimeline.vue'\nimport CveFindings from '@/components/shield/CveFindings.vue'\nimport CredentialFindings from '@/components/shield/CredentialFindings.vue'\nimport OwaspResults from '@/components/shield/OwaspResults.vue'\nimport RemediationPlan from '@/components/shield/RemediationPlan.vue'\nimport AttackSurfaceMap from '@/components/shield/AttackSurfaceMap.vue'\nimport PriorityMatrix from '@/components/shield/PriorityMatrix.vue'\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from '@/components/ui/tabs'\n\nconst {\n  currentScan,\n  findings,\n  loading,\n  scanning,\n  error,\n  startScan,\n  fetchScan,\n} = useShield()\n\nasync function handleScan(target: string, depth: ScanDepth) {\n  await startScan(target, depth)\n}\n\nfunction handleRefresh() {\n  if (currentScan.value?.id) {\n    fetchScan(currentScan.value.id)\n  }\n}\n\nconst statusText = computed(() => {\n  if (!currentScan.value) return ''\n  switch (currentScan.value.status) {\n    case 'queued':\n      return 'Scan queued, waiting to start...'\n    case 'running':\n      return `Scanning ${currentScan.value.target}...`\n    case 'completed':\n      return `Scan completed in ${currentScan.value.duration_seconds ?? '?'}s`\n    case 'failed':\n      return 'Scan failed'\n    default:\n      return ''\n  }\n})\n\nconst isComplete = computed(() => currentScan.value?.status === 'completed')\nconst isFailed = computed(() => currentScan.value?.status === 'failed')\nconst hasModuleScores = computed(\n  () =>\n    currentScan.value?.module_scores &&\n    Object.keys(currentScan.value.module_scores).length > 0,\n)\n\nconst portFindings = computed(() =>\n  currentScan.value?.findings.filter((f) => f.module === 'ports') ?? [],\n)\nconst headerFindings = computed(() =>\n  currentScan.value?.findings.filter((f) => f.module === 'headers') ?? [],\n)\nconst dnsFindings = computed(() =>\n  currentScan.value?.findings.filter((f) => f.module === 'dns') ?? [],\n)\nconst cveFindings = computed(() =>\n  currentScan.value?.findings.filter((f) => f.module === 'cve') ?? [],\n)\n\nconst hasPortModule = computed(() =>\n  currentScan.value?.modules_enabled.includes('ports') ?? false,\n)\nconst hasHeaderModule = computed(() =>\n  currentScan.value?.modules_enabled.includes('headers') ?? false,\n)\nconst hasDnsModule = computed(() =>\n  currentScan.value?.modules_enabled.includes('dns') ?? false,\n)\nconst hasCveModule = computed(() =>\n  currentScan.value?.modules_enabled.includes('cve') ?? false,\n)\nconst credFindings = computed(() =>\n  currentScan.value?.findings.filter((f) => f.module === 'creds') ?? [],\n)\nconst owaspFindings = computed(() =>\n  currentScan.value?.findings.filter((f) => f.module === 'owasp') ?? [],\n)\n\nconst hasCredModule = computed(() =>\n  currentScan.value?.modules_enabled.includes('creds') ?? false,\n)\nconst hasOwaspModule = computed(() =>\n  currentScan.value?.modules_enabled.includes('owasp') ?? false,\n)\n</script>\n\n<template>\n  <div class=\"space-y-6\">\n    <!-- Header -->\n    <div class=\"flex items-center justify-between\">\n      <div>\n        <h1 class=\"text-2xl font-bold text-white\">Shield - Security Validation</h1>\n        <p class=\"mt-1 text-sm text-slate-400\">\n          Comprehensive security scanning and vulnerability assessment\n        </p>\n      </div>\n      <button\n        class=\"flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 text-xs text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200\"\n        :disabled=\"loading || scanning\"\n        @click=\"handleRefresh\"\n      >\n        <RefreshCw class=\"h-3.5 w-3.5\" :class=\"{ 'animate-spin': loading }\" />\n        Refresh\n      </button>\n    </div>\n\n    <!-- Scan Form -->\n    <ScanForm :scanning=\"scanning\" @scan=\"handleScan\" />\n\n    <!-- Error State -->\n    <div\n      v-if=\"error && !currentScan\"\n      class=\"glass-card mx-auto max-w-md rounded-xl p-8 text-center\"\n    >\n      <AlertTriangle class=\"mx-auto h-10 w-10 text-amber-400\" />\n      <h2 class=\"mt-3 text-lg font-semibold text-white\">Unable to Start Scan</h2>\n      <p class=\"mt-2 text-sm text-slate-400\">{{ error }}</p>\n    </div>\n\n    <!-- Empty State (no scan yet) -->\n    <div\n      v-if=\"!currentScan && !error\"\n      class=\"flex flex-col items-center justify-center py-20\"\n    >\n      <Shield class=\"h-16 w-16 text-slate-600\" />\n      <h2 class=\"mt-4 text-lg font-medium text-slate-400\">Enter a target to begin</h2>\n      <p class=\"mt-1 text-sm text-slate-500\">\n        Provide an IP address, domain, or CIDR range to start a security scan\n      </p>\n    </div>\n\n    <!-- Scanning State -->\n    <div\n      v-if=\"currentScan && scanning\"\n      class=\"glass-card rounded-xl p-8 text-center\"\n    >\n      <Loader2 class=\"mx-auto h-10 w-10 animate-spin text-cyan-400\" />\n      <p class=\"mt-3 text-sm text-slate-300\">{{ statusText }}</p>\n      <div class=\"mx-auto mt-4 flex max-w-xs items-center gap-3\">\n        <div class=\"h-1.5 flex-1 overflow-hidden rounded-full bg-white/5\">\n          <div class=\"h-full w-1/3 animate-pulse rounded-full bg-cyan-500/50\" />\n        </div>\n        <span class=\"text-xs text-slate-500\">{{ currentScan.status }}</span>\n      </div>\n      <div v-if=\"currentScan.modules_enabled.length > 0\" class=\"mt-3\">\n        <span class=\"text-xs text-slate-500\">\n          Modules: {{ currentScan.modules_enabled.join(', ') }}\n        </span>\n      </div>\n    </div>\n\n    <!-- Failed State -->\n    <div\n      v-if=\"isFailed && !scanning\"\n      class=\"glass-card mx-auto max-w-md rounded-xl p-8 text-center\"\n    >\n      <XCircle class=\"mx-auto h-10 w-10 text-rose-400\" />\n      <h2 class=\"mt-3 text-lg font-semibold text-white\">Scan Failed</h2>\n      <p class=\"mt-2 text-sm text-slate-400\">\n        The scan for {{ currentScan?.target }} could not be completed.\n      </p>\n    </div>\n\n    <!-- Completed State -->\n    <template v-if=\"isComplete && !scanning\">\n      <!-- Score + Module Scores + Timeline -->\n      <div class=\"flex flex-col gap-6 lg:flex-row\">\n        <!-- Left: Shield Score -->\n        <div class=\"glass-card flex items-center justify-center rounded-xl p-6 lg:w-72\">\n          <ShieldScore\n            :score=\"currentScan?.shield_score ?? null\"\n            :grade=\"currentScan?.grade ?? null\"\n            :loading=\"loading\"\n          />\n        </div>\n\n        <!-- Center: Module Score Cards -->\n        <div class=\"min-w-0 flex-1\">\n          <div class=\"mb-3 flex items-center justify-between\">\n            <h2 class=\"text-sm font-medium text-white\">Module Scores</h2>\n            <div class=\"flex items-center gap-3 text-xs text-slate-500\">\n              <span class=\"flex items-center gap-1\">\n                <CheckCircle class=\"h-3 w-3 text-emerald-400\" />\n                {{ currentScan?.passed_checks ?? 0 }} passed\n              </span>\n              <span class=\"flex items-center gap-1\">\n                <XCircle class=\"h-3 w-3 text-rose-400\" />\n                {{ currentScan?.failed_checks ?? 0 }} failed\n              </span>\n            </div>\n          </div>\n\n          <ModuleScoreCards\n            v-if=\"hasModuleScores\"\n            :scores=\"currentScan!.module_scores\"\n          />\n          <div v-else class=\"glass-card rounded-xl p-6 text-center\">\n            <p class=\"text-sm text-slate-500\">No module breakdown available</p>\n          </div>\n        </div>\n\n        <!-- Right: Timeline -->\n        <div v-if=\"currentScan\" class=\"lg:w-64\">\n          <ShieldTimeline :scan=\"currentScan\" />\n        </div>\n      </div>\n\n      <!-- Scan Info Bar -->\n      <div class=\"glass-card flex flex-wrap items-center gap-4 rounded-lg px-4 py-2.5 text-xs text-slate-500\">\n        <span>\n          Target:\n          <span class=\"font-mono text-slate-300\">{{ currentScan?.target }}</span>\n        </span>\n        <span>\n          Depth:\n          <span class=\"text-slate-300\">{{ currentScan?.scan_depth }}</span>\n        </span>\n        <span>\n          Duration:\n          <span class=\"font-mono text-slate-300\">{{ currentScan?.duration_seconds ?? '?' }}s</span>\n        </span>\n        <span>\n          Checks:\n          <span class=\"font-mono text-slate-300\">{{ currentScan?.total_checks }}</span>\n        </span>\n      </div>\n\n      <!-- Tabbed Findings View -->\n      <Tabs default-value=\"findings\">\n        <TabsList class=\"bg-white/5\">\n          <TabsTrigger value=\"findings\" class=\"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400\">\n            All Findings\n          </TabsTrigger>\n          <TabsTrigger\n            v-if=\"hasPortModule\"\n            value=\"ports\"\n            class=\"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400\"\n          >\n            Ports\n            <span v-if=\"portFindings.length > 0\" class=\"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400\">\n              {{ portFindings.length }}\n            </span>\n          </TabsTrigger>\n          <TabsTrigger\n            v-if=\"hasHeaderModule\"\n            value=\"headers\"\n            class=\"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400\"\n          >\n            Headers\n            <span v-if=\"headerFindings.length > 0\" class=\"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400\">\n              {{ headerFindings.length }}\n            </span>\n          </TabsTrigger>\n          <TabsTrigger\n            v-if=\"hasDnsModule\"\n            value=\"dns\"\n            class=\"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400\"\n          >\n            DNS\n            <span v-if=\"dnsFindings.length > 0\" class=\"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400\">\n              {{ dnsFindings.length }}\n            </span>\n          </TabsTrigger>\n          <TabsTrigger\n            v-if=\"hasCveModule\"\n            value=\"cve\"\n            class=\"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400\"\n          >\n            CVE\n            <span v-if=\"cveFindings.length > 0\" class=\"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400\">\n              {{ cveFindings.length }}\n            </span>\n          </TabsTrigger>\n          <TabsTrigger\n            v-if=\"hasCredModule\"\n            value=\"creds\"\n            class=\"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400\"\n          >\n            Credentials\n            <span v-if=\"credFindings.length > 0\" class=\"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400\">\n              {{ credFindings.length }}\n            </span>\n          </TabsTrigger>\n          <TabsTrigger\n            v-if=\"hasOwaspModule\"\n            value=\"owasp\"\n            class=\"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400\"\n          >\n            OWASP\n            <span v-if=\"owaspFindings.length > 0\" class=\"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400\">\n              {{ owaspFindings.length }}\n            </span>\n          </TabsTrigger>\n          <TabsTrigger\n            value=\"remediation\"\n            class=\"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400\"\n          >\n            Remediation\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"findings\">\n          <FindingsList :findings=\"findings\" />\n        </TabsContent>\n\n        <TabsContent v-if=\"hasPortModule\" value=\"ports\">\n          <PortScanResults :findings=\"portFindings\" />\n        </TabsContent>\n\n        <TabsContent v-if=\"hasHeaderModule\" value=\"headers\">\n          <HeadersChecklist :findings=\"headerFindings\" />\n        </TabsContent>\n\n        <TabsContent v-if=\"hasDnsModule\" value=\"dns\">\n          <DnsSecurityCard :findings=\"dnsFindings\" />\n        </TabsContent>\n\n        <TabsContent v-if=\"hasCveModule\" value=\"cve\">\n          <div class=\"space-y-6\">\n            <CveFindings :findings=\"cveFindings\" />\n            <div class=\"grid gap-6 lg:grid-cols-2\">\n              <AttackSurfaceMap :findings=\"findings\" />\n              <PriorityMatrix :findings=\"cveFindings\" />\n            </div>\n          </div>\n        </TabsContent>\n\n        <TabsContent v-if=\"hasCredModule\" value=\"creds\">\n          <CredentialFindings :findings=\"credFindings\" />\n        </TabsContent>\n\n        <TabsContent v-if=\"hasOwaspModule\" value=\"owasp\">\n          <OwaspResults :findings=\"owaspFindings\" />\n        </TabsContent>\n\n        <TabsContent value=\"remediation\">\n          <RemediationPlan :findings=\"findings\" />\n        </TabsContent>\n      </Tabs>\n    </template>\n  </div>\n</template>\n"],"names":["Filter","createLucideIcon","Flag","Mail","Play","ShieldX","Wrench","useShieldStore","defineStore","recentScans","ref","currentScanId","currentScan","computed","s","addScan","scan","updateScan","idx","$reset","useShield","findings","loading","scanning","error","pollTimer","store","stopPolling","startScan","target","depth","modules","bigrApi","pollScan","e","message","fetchScan","scanId","fetchFindings","data","onUnmounted","props","__props","emit","__emit","depths","handleSubmit","trimmed","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_cache","$event","_hoisted_3","_Fragment","_renderList","d","_normalizeClass","_hoisted_5","_toDisplayString","_hoisted_6","_createBlock","_unref","Loader2","Shield","animated","displayScore","animFrame","onMounted","animateScore","watch","newVal","start","diff","duration","startTime","step","now","elapsed","progress","eased","circumference","dashOffset","scoreColor","gradeConfig","g","_hoisted_2","_hoisted_4","moduleLabels","moduleList","key","score","mod","_normalizeStyle","_hoisted_7","expandedId","severityOrder","sortedFindings","a","b","toggleRow","id","severityConfig","severity","formatTarget","finding","_createVNode","CheckCircle","_resolveDynamicComponent","ChevronDown","ChevronRight","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","ExternalLink","_hoisted_27","_hoisted_28","safePortSet","dangerousPortSet","commonPortSet","serviceNames","getPortRisk","port","portEntries","entries","seen","f","service","_a","dangerousPorts","totalOpen","totalDangerous","riskClasses","risk","Network","AlertTriangle","entry","ShieldAlert","EXPECTED_HEADERS","INFO_LEAK_HEADERS","expandedKey","toggleExpand","headerChecks","header","titleLower","keyLower","isInfoLeak","isLeaking","presentCount","h","totalHeaders","statusConfig","status","XCircle","ShieldCheck","findByKey","spfCheck","dkimCheck","dmarcCheck","policy","caaCheck","allChecks","dmarcPolicy","dmarcPolicyConfig","emailScore","statusIcon","statusColor","c","Globe","check","formatTimestamp","iso","estimateModuleDuration","_moduleIndex","totalModules","totalDuration","result","isComplete","isFailed","isRunning","entryIcon","Clock","entryIconClass","lineClass","dotGlowClass","sortBy","severityFilter","criticalCount","kevCount","toggleSeverityFilter","next","cvssConfig","epssPercent","epssBarColor","sortOptions","filterSeverities","_createTextVNode","ArrowUpDown","opt","sev","_hoisted_26","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","highCount","severityClass","map","severityBorder","KeyRound","PROBE_NAMES","PROBE_KEYWORDS","matchesProbe","keywords","evidence","probe","kw","probeResults","name","passCount","p","failCount","failedFindings","severityTextClass","Bug","val","computePriority","impact","lowEffortModules","highEffortModules","effort","labelOrder","planItems","quadrants","counts","item","priorityBadgeClass","label","q","portFindings","cveFindings","attackChain","portsMap","servicesMap","cves","serviceName","_b","banner","_c","svc","_e","_d","ports","services","hasCves","hasData","sevColor","sevDot","getServiceCves","getServicePorts","Server","cve","cvePoints","dotStyle","point","dotColor","quadrantCounts","handleScan","handleRefresh","statusText","hasModuleScores","headerFindings","dnsFindings","hasPortModule","hasHeaderModule","hasDnsModule","hasCveModule","credFindings","owaspFindings","hasCredModule","hasOwaspModule","RefreshCw","ScanForm","ShieldScore","ModuleScoreCards","ShieldTimeline","Tabs","TabsList","TabsTrigger","TabsContent","FindingsList","PortScanResults","HeadersChecklist","DnsSecurityCard","CveFindings","AttackSurfaceMap","PriorityMatrix","CredentialFindings","OwaspResults","RemediationPlan"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}