import{b as z}from"./index-BJnaPNgl.js";import{r as y,d as $,o as N,c as u,e as _,g as n,f as g,y as p,z as v,F as B,p as D,E as G,j as t,k as e,q as I,l as a,H as x,m as j}from"./vendor-B81oEKTZ.js";import{_ as h,a as k,b as C,c as w}from"./CardContent.vue_vue_type_script_setup_true_lang-C8e3AKqd.js";import{_ as O,b as V,a as L}from"./LoadingState.vue_vue_type_script_setup_true_lang-CWAk-IiO.js";import{C as M,A as T,p as W,a as P,D as q}from"./charts-D5_agQ_E.js";import{B as R}from"./bigr-BzhtauNA.js";import{c as H,a as E,b as S,e as K,d as A,_ as U}from"./TableCell.vue_vue_type_script_setup_true_lang-BqriAm9j.js";import{_ as J}from"./IpLink.vue_vue_type_script_setup_true_lang-QduQDQx1.js";import"./utils-CytzSlOG.js";import"./index-B4X1KNOo.js";import"./loader-circle-BP_2q-Q8.js";function Q(){const f=y(null),s=y(!1),r=y(null);async function d(){s.value=!0,r.value=null;try{const m=await z.getCompliance();f.value=m.data}catch(m){const l=m instanceof Error?m.message:"Failed to load compliance data";r.value=l}finally{s.value=!1}}return{data:f,loading:s,error:r,fetchCompliance:d}}const X={class:"flex flex-col items-center justify-center"},Y={class:"relative w-48 h-48"},Z={viewBox:"0 0 160 160",class:"w-full h-full -rotate-90"},ee=["stroke","stroke-dashoffset"],te={class:"absolute inset-0 flex flex-col items-center justify-center"},se={class:"text-lg font-semibold text-muted-foreground"},ae=$({__name:"ComplianceGauge",props:{score:{},grade:{}},setup(f){const s=f,r=y(!1);N(()=>{requestAnimationFrame(()=>{r.value=!0})});const d=v(()=>s.score>=90?{stroke:"#34d399",text:"text-emerald-400"}:s.score>=70?{stroke:"#22d3ee",text:"text-cyan-400"}:s.score>=50?{stroke:"#fbbf24",text:"text-amber-400"}:{stroke:"#fb7185",text:"text-rose-400"}),m=2*Math.PI*70,l=v(()=>{const i=r.value?s.score/100:0;return m*(1-i)});return(i,c)=>(u(),_("div",X,[n("div",Y,[(u(),_("svg",Z,[c[0]||(c[0]=n("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"rgba(255, 255, 255, 0.05)","stroke-width":"10"},null,-1)),n("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:d.value.stroke,"stroke-width":"10","stroke-linecap":"round","stroke-dasharray":m,"stroke-dashoffset":l.value,class:"transition-[stroke-dashoffset] duration-1000 ease-out"},null,8,ee)])),n("div",te,[n("span",{class:g(["text-4xl font-bold tabular-nums",d.value.text])},p(f.score),3),n("span",se,p(f.grade),1)])]),c[1]||(c[1]=n("p",{class:"mt-2 text-sm text-muted-foreground"},"Compliance Score",-1))]))}}),le={class:"space-y-4"},oe={class:"flex items-center justify-between text-sm"},re={class:"font-semibold text-white tabular-nums"},ne={class:"h-4 w-full flex rounded-full overflow-hidden bg-white/5"},ie={class:"grid grid-cols-2 gap-3"},ce={class:"flex flex-col"},ue={class:"text-xs text-muted-foreground"},de=$({__name:"ComplianceBreakdown",props:{breakdown:{}},setup(f){const s=f,r=v(()=>{const d=s.breakdown.total_assets;return d===0?[]:[{label:"Fully Classified",value:s.breakdown.fully_classified,pct:s.breakdown.fully_classified/d*100,color:"bg-emerald-400",textColor:"text-emerald-400"},{label:"Partially Classified",value:s.breakdown.partially_classified,pct:s.breakdown.partially_classified/d*100,color:"bg-amber-400",textColor:"text-amber-400"},{label:"Unclassified",value:s.breakdown.unclassified,pct:s.breakdown.unclassified/d*100,color:"bg-rose-400",textColor:"text-rose-400"},{label:"Manual Overrides",value:s.breakdown.manual_overrides,pct:s.breakdown.manual_overrides/d*100,color:"bg-cyan-400",textColor:"text-cyan-400"}]});return(d,m)=>(u(),_("div",le,[n("div",oe,[m[0]||(m[0]=n("span",{class:"text-muted-foreground"},"Total Assets",-1)),n("span",re,p(f.breakdown.total_assets),1)]),n("div",ne,[(u(!0),_(B,null,D(r.value,l=>(u(),_("div",{key:l.label,class:g([l.color,"transition-all duration-500"]),style:G({width:`${l.pct}%`})},null,6))),128))]),n("div",ie,[(u(!0),_(B,null,D(r.value,l=>(u(),_("div",{key:l.label,class:"flex items-center gap-2"},[n("span",{class:g([l.color,"h-2.5 w-2.5 rounded-full shrink-0"])},null,2),n("div",ce,[n("span",ue,p(l.label),1),n("span",{class:g(["text-sm font-medium tabular-nums",l.textColor])},p(l.value),3)])]))),128))])]))}}),fe={class:"h-64"},me=$({__name:"ComplianceDistribution",props:{distribution:{}},setup(f){M.register(T,W,P);const s=f,r=["ag_ve_sistemler","uygulamalar","iot","tasinabilir","unclassified"],d=v(()=>({labels:r.map(l=>R[l].label),datasets:[{data:r.map(l=>s.distribution.counts[l]||0),backgroundColor:r.map(l=>R[l].color+"80"),borderColor:r.map(l=>R[l].color),borderWidth:1,hoverBorderWidth:2,hoverOffset:6}]})),m={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"#94a3b8",padding:12,font:{size:11},usePointStyle:!0,pointStyleWidth:8}},tooltip:{backgroundColor:"rgba(15, 23, 42, 0.9)",titleColor:"#e2e8f0",bodyColor:"#94a3b8",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:10,cornerRadius:8,callbacks:{label:l=>{const i=l.dataset.data.reduce((o,b)=>o+b,0),c=i>0?(l.parsed/i*100).toFixed(1):"0";return` ${l.label}: ${l.parsed} (${c}%)`}}}},cutout:"65%",animation:{animateRotate:!0,animateScale:!0}};return(l,i)=>(u(),_("div",fe,[t(e(q),{data:d.value,options:m},null,8,["data"])]))}}),_e={class:"ml-1 text-xs"},pe=$({__name:"SubnetComplianceTable",props:{subnets:{}},setup(f){const s=f,r=y("desc");function d(){r.value=r.value==="desc"?"asc":"desc"}const m=v(()=>{const c=[...s.subnets];return c.sort((o,b)=>r.value==="desc"?b.score-o.score:o.score-b.score),c});function l(c){return c>=90?"text-emerald-400":c>=70?"text-cyan-400":c>=50?"text-amber-400":"text-rose-400"}function i(c){const o="inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold";switch(c){case"A":return`${o} bg-emerald-500/20 text-emerald-400`;case"B":return`${o} bg-cyan-500/20 text-cyan-400`;case"C":return`${o} bg-amber-500/20 text-amber-400`;case"D":return`${o} bg-orange-500/20 text-orange-400`;default:return`${o} bg-rose-500/20 text-rose-400`}}return(c,o)=>(u(),I(e(U),null,{default:a(()=>[t(e(H),null,{default:a(()=>[t(e(E),null,{default:a(()=>[t(e(S),null,{default:a(()=>[...o[0]||(o[0]=[x("CIDR",-1)])]),_:1}),t(e(S),null,{default:a(()=>[...o[1]||(o[1]=[x("Label",-1)])]),_:1}),t(e(S),{class:"cursor-pointer select-none",onClick:d},{default:a(()=>[o[2]||(o[2]=x(" Score ",-1)),n("span",_e,p(r.value==="desc"?"▼":"▲"),1)]),_:1}),t(e(S),null,{default:a(()=>[...o[3]||(o[3]=[x("Grade",-1)])]),_:1})]),_:1})]),_:1}),t(e(K),null,{default:a(()=>[(u(!0),_(B,null,D(m.value,b=>(u(),I(e(E),{key:b.cidr},{default:a(()=>[t(e(A),{class:"font-mono text-sm"},{default:a(()=>[x(p(b.cidr),1)]),_:2},1024),t(e(A),null,{default:a(()=>[x(p(b.label||"—"),1)]),_:2},1024),t(e(A),null,{default:a(()=>[n("span",{class:g(["font-semibold tabular-nums",l(b.score)])},p(b.score),3)]),_:2},1024),t(e(A),null,{default:a(()=>[n("span",{class:g(i(b.grade))},p(b.grade),3)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}}),be={class:"space-y-2"},xe={class:"text-xs text-muted-foreground"},ge={class:"ml-auto text-sm text-muted-foreground truncate max-w-[40%]"},ve={key:0,class:"py-4 text-center text-sm text-muted-foreground"},ye={key:1,class:"flex justify-center pt-2"},F=10,$e=$({__name:"ActionItemsList",props:{items:{}},setup(f){const s=f,r=y(!1),d=v(()=>r.value?s.items:s.items.slice(0,F)),m=v(()=>s.items.length>F);function l(i){const c="inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold";switch(i){case"critical":return`${c} bg-rose-500/20 text-rose-400`;case"high":return`${c} bg-amber-500/20 text-amber-400`;case"medium":return`${c} bg-cyan-500/20 text-cyan-400`;default:return`${c} bg-slate-500/20 text-slate-400`}}return(i,c)=>(u(),_("div",be,[(u(!0),_(B,null,D(d.value,(o,b)=>(u(),_("div",{key:`${o.ip}-${o.type}-${b}`,class:"flex items-center gap-3 rounded-lg border border-border bg-white/5 px-4 py-3"},[n("span",{class:g(l(o.priority))},p(o.priority),3),t(J,{ip:o.ip},null,8,["ip"]),n("span",xe,p(o.type),1),n("span",ge,p(o.reason),1)]))),128)),f.items.length===0?(u(),_("div",ve," No action items ")):j("",!0),m.value?(u(),_("div",ye,[t(e(O),{variant:"ghost",size:"sm",class:"text-xs text-muted-foreground hover:text-white",onClick:c[0]||(c[0]=o=>r.value=!r.value)},{default:a(()=>[x(p(r.value?"Show less":`Show all (${f.items.length})`),1)]),_:1})])):j("",!0)]))}}),he={class:"space-y-6"},ke={key:1,class:"rounded-lg border border-rose-500/30 bg-rose-500/10 p-4"},Ce={class:"text-sm text-rose-400"},we={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Be={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Oe=$({__name:"ComplianceView",setup(f){const{data:s,loading:r,error:d,fetchCompliance:m}=Q();return N(()=>{m()}),(l,i)=>(u(),_("div",he,[i[5]||(i[5]=n("h1",{class:"text-2xl font-bold text-white"},"BIGR Compliance",-1)),e(r)?(u(),I(V,{key:0,message:"Loading compliance data..."})):e(d)?(u(),_("div",ke,[n("p",Ce,p(e(d)),1)])):e(s)?(u(),_(B,{key:3},[n("div",we,[t(e(h),null,{default:a(()=>[t(e(k),null,{default:a(()=>[t(e(C),{class:"text-base"},{default:a(()=>[...i[0]||(i[0]=[x("Compliance Score",-1)])]),_:1})]),_:1}),t(e(w),{class:"flex justify-center"},{default:a(()=>[t(ae,{score:e(s).compliance_score,grade:e(s).grade},null,8,["score","grade"])]),_:1})]),_:1}),t(e(h),null,{default:a(()=>[t(e(k),null,{default:a(()=>[t(e(C),{class:"text-base"},{default:a(()=>[...i[1]||(i[1]=[x("Classification Breakdown",-1)])]),_:1})]),_:1}),t(e(w),null,{default:a(()=>[t(de,{breakdown:e(s).breakdown},null,8,["breakdown"])]),_:1})]),_:1})]),n("div",Be,[t(e(h),null,{default:a(()=>[t(e(k),null,{default:a(()=>[t(e(C),{class:"text-base"},{default:a(()=>[...i[2]||(i[2]=[x("Category Distribution",-1)])]),_:1})]),_:1}),t(e(w),null,{default:a(()=>[t(me,{distribution:e(s).distribution},null,8,["distribution"])]),_:1})]),_:1}),t(e(h),null,{default:a(()=>[t(e(k),null,{default:a(()=>[t(e(C),{class:"text-base"},{default:a(()=>[...i[3]||(i[3]=[x("Subnet Compliance",-1)])]),_:1})]),_:1}),t(e(w),null,{default:a(()=>[t(pe,{subnets:e(s).subnet_compliance},null,8,["subnets"])]),_:1})]),_:1})]),t(e(h),null,{default:a(()=>[t(e(k),null,{default:a(()=>[t(e(C),{class:"text-base"},{default:a(()=>[...i[4]||(i[4]=[x("Action Items",-1)])]),_:1})]),_:1}),t(e(w),null,{default:a(()=>[t($e,{items:e(s).action_items},null,8,["items"])]),_:1})]),_:1})],64)):(u(),I(L,{key:2,title:"No Compliance Data",description:"Run a scan to generate compliance metrics."}))]))}});export{Oe as default};
//# sourceMappingURL=ComplianceView-CXc6OjU_.js.map
