import{c as W,b as X,d as Y,N as J,T as Z,a as z,S as me,B as fe}from"./index-DonMIFpr.js";import{I as ve,r as L,z as M,a as ge,d as R,e as s,g as e,N as be,W as he,F as N,p as T,f as E,q as D,k as i,H as I,y as o,Q as ee,c as t,o as _e,w as ye,m as h,E as Q,j as k,x as H,S as we,l as V}from"./vendor-B81oEKTZ.js";import{L as te}from"./loader-circle-DVGlt9Lo.js";import{C as j}from"./circle-check-big-C5k96PZA.js";import{C as se}from"./chevron-down-DLE_T_X5.js";import{C as le,E as pe,S as q}from"./shield-alert-DfelDUVs.js";import{C as G}from"./circle-x-C5SVqk_f.js";import{G as ke}from"./globe-BZSEGERi.js";import{C as xe}from"./clock-Cxr2yEnv.js";import{A as $e}from"./arrow-up-down-toPQgATG.js";import{_ as Se,a as Ce,b as U,c as K}from"./TabsContent.vue_vue_type_script_setup_true_lang-4t9VYY79.js";import{R as Pe}from"./refresh-cw-CafbXUaY.js";import"./index-B4X1KNOo.js";import"./utils-CytzSlOG.js";/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=W("FilterIcon",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=W("FlagIcon",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=W("MailIcon",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=W("PlayIcon",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=W("ShieldXIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]),Ne=ve("shield",()=>{const $=L([]),c=L(null),y=M(()=>$.value.find(u=>u.id===c.value)??null);function A(u){$.value=[u,...$.value.filter(x=>x.id!==u.id)].slice(0,50),c.value=u.id}function f(u){const x=$.value.findIndex(v=>v.id===u.id);x!==-1?$.value[x]=u:A(u)}function w(){$.value=[],c.value=null}return{recentScans:$,currentScanId:c,currentScan:y,addScan:A,updateScan:f,$reset:w}});function De(){const $=L(null),c=L([]),y=L(!1),A=L(!1),f=L(null);let w=null;const u=Ne();function x(){w!==null&&(clearInterval(w),w=null)}async function v(l,n,a){y.value=!0,A.value=!0,f.value=null;try{const P=(await X.startShieldScan(l,n,a)).data.scan;return $.value=P,u.addScan(P),d(P.id),P}catch(b){const P=b instanceof Error?b.message:"Failed to start scan";return f.value=P,A.value=!1,null}finally{y.value=!1}}async function p(l){y.value=!0,f.value=null;try{const a=(await X.getShieldScan(l)).data.scan;return $.value=a,u.updateScan(a),a}catch(n){const a=n instanceof Error?n.message:"Failed to fetch scan";return f.value=a,null}finally{y.value=!1}}async function r(l){y.value=!0,f.value=null;try{const a=(await X.getShieldFindings(l)).data;return c.value=a.findings,a.findings}catch(n){const a=n instanceof Error?n.message:"Failed to fetch findings";return f.value=a,[]}finally{y.value=!1}}function d(l){x(),w=setInterval(async()=>{try{const a=(await X.getShieldScan(l)).data.scan;$.value=a,u.updateScan(a),(a.status==="completed"||a.status==="failed")&&(x(),A.value=!1,a.status==="completed"&&(c.value=a.findings??[],c.value.length===0&&await r(l)))}catch{}},2e3)}return ge(()=>{x()}),{currentScan:$,findings:c,loading:y,scanning:A,error:f,startScan:v,fetchScan:p,fetchFindings:r,pollScan:d,stopPolling:x}}const Te={class:"glass-card rounded-xl p-5"},Le=["disabled"],Ve={class:"flex gap-2"},Re=["disabled","onClick"],je={class:"font-medium"},Oe={class:"mt-0.5 text-xs opacity-60"},He=["disabled"],qe=R({__name:"ScanForm",props:{scanning:{type:Boolean}},emits:["scan"],setup($,{emit:c}){const y=$,A=c,f=L(""),w=L("standard"),u=[{value:"quick",label:"Quick",desc:"~30s"},{value:"standard",label:"Standard",desc:"~2min"},{value:"deep",label:"Deep",desc:"~5min"}];function x(){const v=f.value.trim();v&&A("scan",v,w.value)}return(v,p)=>(t(),s("div",Te,[e("form",{onSubmit:ee(x,["prevent"]),class:"space-y-4"},[e("div",null,[p[1]||(p[1]=e("label",{class:"mb-1.5 block text-sm font-medium text-slate-300"}," Target ",-1)),be(e("input",{"onUpdate:modelValue":p[0]||(p[0]=r=>f.value=r),type:"text",placeholder:"example.com or 192.168.1.0/24",disabled:y.scanning,class:"w-full rounded-lg border border-[var(--border-glass)] bg-white/5 px-4 py-2.5 text-sm text-white placeholder-slate-500 outline-none transition-colors focus:border-cyan-500/50 focus:bg-white/10 disabled:opacity-50"},null,8,Le),[[he,f.value]])]),e("div",null,[p[2]||(p[2]=e("label",{class:"mb-1.5 block text-sm font-medium text-slate-300"}," Scan Depth ",-1)),e("div",Ve,[(t(),s(N,null,T(u,r=>e("button",{key:r.value,type:"button",disabled:y.scanning,onClick:d=>w.value=r.value,class:E(["flex-1 rounded-lg border px-3 py-2 text-center text-sm transition-all",w.value===r.value?"border-cyan-500/50 bg-cyan-500/10 text-cyan-400":"border-[var(--border-glass)] bg-white/5 text-slate-400 hover:bg-white/10 hover:text-slate-300",y.scanning?"opacity-50 cursor-not-allowed":"cursor-pointer"])},[e("div",je,o(r.label),1),e("div",Oe,o(r.desc),1)],10,Re)),64))])]),e("button",{type:"submit",disabled:!f.value.trim()||y.scanning,class:E(["flex w-full items-center justify-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium transition-all",!f.value.trim()||y.scanning?"cursor-not-allowed bg-white/5 text-slate-500":"bg-cyan-500/20 text-cyan-400 hover:bg-cyan-500/30"])},[y.scanning?(t(),D(i(te),{key:0,class:"h-4 w-4 animate-spin"})):(t(),D(i(Y),{key:1,class:"h-4 w-4"})),I(" "+o(y.scanning?"Scanning...":"Start Scan"),1)],10,He)],32)]))}}),Be={class:"flex flex-col items-center justify-center"},Ue={key:1,class:"relative h-48 w-48"},Ke={class:"relative h-48 w-48"},ze={viewBox:"0 0 160 160",class:"h-full w-full -rotate-90"},Ge=["stroke","stroke-dashoffset"],We={class:"absolute inset-0 flex flex-col items-center justify-center"},Xe=R({__name:"ShieldScore",props:{score:{},grade:{},loading:{type:Boolean}},setup($){const c=$,y=L(!1),A=L(0);let f=null;_e(()=>{requestAnimationFrame(()=>{y.value=!0,w(c.score??0)})}),ye(()=>c.score,r=>{r!==null&&w(r)});function w(r){f&&cancelAnimationFrame(f);const d=A.value,l=r-d,n=1e3,a=performance.now();function b(P){const S=P-a,m=Math.min(S/n,1),g=1-Math.pow(1-m,3);A.value=Math.round(d+l*g),m<1&&(f=requestAnimationFrame(b))}f=requestAnimationFrame(b)}const u=2*Math.PI*70,x=M(()=>{const r=y.value?(c.score??0)/100:0;return u*(1-r)}),v=M(()=>{const r=c.score??0;return r>=90?{stroke:"#34d399",text:"text-emerald-400"}:r>=70?{stroke:"#22d3ee",text:"text-cyan-400"}:r>=50?{stroke:"#fbbf24",text:"text-amber-400"}:{stroke:"#fb7185",text:"text-rose-400"}}),p=M(()=>{const r=c.grade;if(!r)return null;switch(r){case"A+":return{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30"};case"A":case"B+":return{bg:"bg-cyan-500/20",text:"text-cyan-400",border:"border-cyan-500/30"};case"B":case"C+":return{bg:"bg-amber-500/20",text:"text-amber-400",border:"border-amber-500/30"};case"C":case"D":case"F":return{bg:"bg-rose-500/20",text:"text-rose-400",border:"border-rose-500/30"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",border:"border-slate-500/30"}}});return(r,d)=>(t(),s("div",Be,[$.loading?(t(),s(N,{key:0},[d[0]||(d[0]=e("div",{class:"relative h-48 w-48"},[e("div",{class:"absolute inset-0 animate-pulse rounded-full bg-white/5"})],-1)),d[1]||(d[1]=e("div",{class:"mt-3 h-6 w-16 animate-pulse rounded bg-white/5"},null,-1))],64)):$.score===null?(t(),s("div",Ue,[...d[2]||(d[2]=[e("svg",{viewBox:"0 0 160 160",class:"h-full w-full -rotate-90"},[e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"rgba(255, 255, 255, 0.05)","stroke-width":"10"})],-1),e("div",{class:"absolute inset-0 flex flex-col items-center justify-center"},[e("span",{class:"text-sm text-slate-500"},"No scan yet")],-1)])])):(t(),s(N,{key:2},[e("div",Ke,[(t(),s("svg",ze,[d[3]||(d[3]=e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"rgba(255, 255, 255, 0.05)","stroke-width":"10"},null,-1)),e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:v.value.stroke,"stroke-width":"10","stroke-linecap":"round","stroke-dasharray":u,"stroke-dashoffset":x.value,class:"transition-[stroke-dashoffset] duration-1000 ease-out"},null,8,Ge)])),e("div",We,[e("span",{class:E(["text-4xl font-bold tabular-nums",v.value.text])},o(A.value),3),d[4]||(d[4]=e("span",{class:"text-xs text-slate-500"},"/ 100",-1))])]),p.value?(t(),s("div",{key:0,class:E(["mt-3 rounded-lg border px-4 py-1 text-lg font-bold",p.value.bg,p.value.text,p.value.border])},o($.grade),3)):h("",!0),d[5]||(d[5]=e("p",{class:"mt-2 text-sm text-slate-500"},"Shield Score",-1))],64))]))}}),Qe={key:0,class:"glass-card rounded-xl p-6 text-center"},Je={key:1,class:"grid grid-cols-2 gap-3 sm:grid-cols-3 lg:grid-cols-4"},Ye={class:"mb-2 flex items-center justify-between"},Ze={class:"text-sm font-medium text-slate-300"},et={class:"mb-2 h-1.5 w-full overflow-hidden rounded-full bg-white/5"},tt={class:"flex items-center justify-between text-xs text-slate-500"},st={key:0,class:"text-rose-400"},lt=R({__name:"ModuleScoreCards",props:{scores:{}},setup($){const c=$,y={tls:"TLS",ports:"Ports",cve:"CVE",headers:"Headers",dns:"DNS",creds:"Creds",owasp:"OWASP"},A=M(()=>Object.entries(c.scores).map(([w,u])=>({key:w,label:y[w]??w.toUpperCase(),...u})));function f(w){return w>=80?{bar:"bg-emerald-400",text:"text-emerald-400"}:w>=60?{bar:"bg-amber-400",text:"text-amber-400"}:{bar:"bg-rose-400",text:"text-rose-400"}}return(w,u)=>A.value.length===0?(t(),s("div",Qe,[...u[0]||(u[0]=[e("p",{class:"text-sm text-slate-500"},"No module scores available",-1)])])):(t(),s("div",Je,[(t(!0),s(N,null,T(A.value,x=>(t(),s("div",{key:x.key,class:"glass-card rounded-lg p-4"},[e("div",Ye,[e("span",Ze,o(x.label),1),e("span",{class:E(["text-sm font-bold tabular-nums",f(x.score).text])},o(x.score),3)]),e("div",et,[e("div",{class:E(["h-full rounded-full transition-all duration-700",f(x.score).bar]),style:Q({width:`${x.score}%`})},null,6)]),e("div",tt,[e("span",null,o(x.passed_checks)+"/"+o(x.total_checks)+" checks",1),x.findings_count>0?(t(),s("span",st,o(x.findings_count)+" finding"+o(x.findings_count!==1?"s":""),1)):h("",!0)])]))),128))]))}}),nt={key:0,class:"glass-card rounded-xl p-8 text-center"},at={key:1,class:"glass-card overflow-hidden rounded-xl"},ot={class:"border-b border-[var(--border-glass)] px-4 py-3"},rt={class:"text-sm font-medium text-white"},it={class:"ml-1 text-slate-500"},dt=["onClick"],ct={class:"flex items-center gap-1.5 truncate text-slate-300"},ut={class:"text-xs text-slate-500"},xt={class:"truncate font-mono text-xs text-slate-400"},pt={key:0,class:"font-mono text-xs text-cyan-400"},mt={key:1,class:"text-xs text-slate-600"},ft={key:0,class:"border-t border-[var(--border-glass)] bg-white/[0.02] px-6 py-4"},vt={class:"space-y-3 text-sm"},gt={class:"text-slate-300"},bt={class:"text-slate-300"},ht={class:"flex flex-wrap gap-4 text-xs"},_t={key:0},yt={class:"ml-1 font-mono font-semibold text-white"},wt={key:1},kt={class:"ml-1 font-mono text-slate-300"},$t={key:2},St={key:3},Ct={class:"ml-1 text-slate-300"},Pt={key:4},Mt={class:"ml-1 text-slate-300"},At=["href"],It={key:0},Et={class:"overflow-x-auto rounded-lg bg-black/30 p-3 font-mono text-xs text-slate-400"},Ft=R({__name:"FindingsList",props:{findings:{}},setup($){const c=$,y=L(null),A={critical:0,high:1,medium:2,low:3,info:4},f=M(()=>[...c.findings].sort((v,p)=>(A[v.severity]??5)-(A[p.severity]??5)));function w(v){y.value=y.value===v?null:v}function u(v){switch(v){case"critical":return{bg:"bg-rose-500/20",text:"text-rose-400",label:"CRITICAL"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"HIGH"};case"medium":return{bg:"bg-amber-500/20",text:"text-amber-400",label:"MEDIUM"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"LOW"};case"info":return{bg:"bg-slate-500/20",text:"text-slate-400",label:"INFO"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",label:v}}}function x(v){return v.target_port?`${v.target_ip}:${v.target_port}`:v.target_ip}return(v,p)=>$.findings.length===0?(t(),s("div",nt,[k(i(j),{class:"mx-auto h-10 w-10 text-emerald-400"}),p[0]||(p[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No findings",-1)),p[1]||(p[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"Your target looks secure!",-1))])):(t(),s("div",at,[e("div",ot,[e("h3",rt,[p[2]||(p[2]=I(" Findings ",-1)),e("span",it,"("+o($.findings.length)+")",1)])]),p[12]||(p[12]=e("div",{class:"grid grid-cols-[100px_1fr_80px_140px_100px] gap-2 border-b border-[var(--border-glass)] px-4 py-2 text-xs font-medium text-slate-500"},[e("span",null,"Severity"),e("span",null,"Title"),e("span",null,"Module"),e("span",null,"Target"),e("span",null,"CVE")],-1)),(t(!0),s(N,null,T(f.value,r=>(t(),s("div",{key:r.id,class:"border-b border-[var(--border-glass)] last:border-0"},[e("button",{class:"grid w-full grid-cols-[100px_1fr_80px_140px_100px] items-center gap-2 px-4 py-3 text-left text-sm transition-colors hover:bg-white/5",onClick:d=>w(r.id)},[e("span",{class:E(["inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-semibold",u(r.severity).bg,u(r.severity).text])},o(u(r.severity).label),3),e("span",ct,[(t(),D(H(y.value===r.id?i(se):i(le)),{class:"h-3.5 w-3.5 shrink-0 text-slate-500"})),I(" "+o(r.title),1)]),e("span",ut,o(r.module),1),e("span",xt,o(x(r)),1),r.cve_id?(t(),s("span",pt,o(r.cve_id),1)):(t(),s("span",mt,"--"))],8,dt),y.value===r.id?(t(),s("div",ft,[e("div",vt,[e("div",null,[p[3]||(p[3]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Description",-1)),e("p",gt,o(r.description),1)]),e("div",null,[p[4]||(p[4]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Remediation",-1)),e("p",bt,o(r.remediation),1)]),e("div",ht,[r.cvss_score!==null?(t(),s("div",_t,[p[5]||(p[5]=e("span",{class:"text-slate-500"},"CVSS:",-1)),e("span",yt,o(r.cvss_score),1)])):h("",!0),r.epss_score!==null?(t(),s("div",wt,[p[6]||(p[6]=e("span",{class:"text-slate-500"},"EPSS:",-1)),e("span",kt,o((r.epss_score*100).toFixed(1))+"% ",1)])):h("",!0),r.cisa_kev?(t(),s("div",$t,[...p[7]||(p[7]=[e("span",{class:"rounded bg-rose-500/20 px-1.5 py-0.5 font-semibold text-rose-400"}," CISA KEV ",-1)])])):h("",!0),r.attack_technique?(t(),s("div",St,[p[8]||(p[8]=e("span",{class:"text-slate-500"},"Technique:",-1)),e("span",Ct,o(r.attack_technique),1)])):h("",!0),r.attack_tactic?(t(),s("div",Pt,[p[9]||(p[9]=e("span",{class:"text-slate-500"},"Tactic:",-1)),e("span",Mt,o(r.attack_tactic),1)])):h("",!0),r.cve_id?(t(),s("a",{key:5,href:`https://nvd.nist.gov/vuln/detail/${r.cve_id}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center gap-1 text-cyan-400 hover:text-cyan-300"},[p[10]||(p[10]=I(" NVD ",-1)),k(i(pe),{class:"h-3 w-3"})],8,At)):h("",!0)]),r.evidence&&Object.keys(r.evidence).length>0?(t(),s("div",It,[p[11]||(p[11]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Evidence",-1)),e("pre",Et,o(JSON.stringify(r.evidence,null,2)),1)])):h("",!0)])])):h("",!0)]))),128))]))}}),Nt={key:0,class:"glass-card rounded-xl p-8 text-center"},Dt={key:1,class:"glass-card rounded-xl p-5"},Tt={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},Lt={class:"mb-4 flex items-center gap-4 text-sm"},Vt={class:"text-slate-400"},Rt={class:"font-mono font-semibold text-white"},jt={key:0,class:"flex items-center gap-1 text-rose-400"},Ot={class:"font-mono font-semibold"},Ht={key:1,class:"flex items-center gap-1 text-emerald-400"},qt={class:"grid gap-5 lg:grid-cols-2"},Bt={class:"flex flex-wrap gap-2"},Ut={class:"font-mono font-bold"},Kt={class:"opacity-75"},zt={key:0},Gt={class:"space-y-2"},Wt={class:"flex items-start gap-2"},Xt={class:"min-w-0"},Qt={class:"flex items-center gap-2"},Jt={class:"font-mono text-sm font-bold text-rose-400"},Yt={class:"text-xs text-slate-400"},Zt={key:0,class:"mt-1 text-xs text-slate-400"},es={key:1,class:"mt-1 text-xs text-slate-500"},ts={key:1,class:"flex items-center justify-center rounded-lg border border-emerald-500/10 bg-emerald-500/5 p-6"},ss={class:"text-center"},ls=R({__name:"PortScanResults",props:{findings:{}},setup($){const c=$,y=new Set([80,443]),A=new Set([21,23,135,139,445,1433,1521,3306,3389,5432,5900,6379,8443,27017]),f=new Set([22,25,53,110,143,587,993,995,8080,8443]),w={21:"FTP",22:"SSH",23:"Telnet",25:"SMTP",53:"DNS",80:"HTTP",110:"POP3",135:"MSRPC",139:"NetBIOS",143:"IMAP",443:"HTTPS",445:"SMB",587:"Submission",993:"IMAPS",995:"POP3S",1433:"MSSQL",1521:"Oracle",3306:"MySQL",3389:"RDP",5432:"PostgreSQL",5900:"VNC",6379:"Redis",8080:"HTTP-Alt",8443:"HTTPS-Alt",27017:"MongoDB"};function u(l){return A.has(l)?"dangerous":y.has(l)?"safe":(f.has(l),"common")}const x=M(()=>{var a;const l=[],n=new Set;for(const b of c.findings){const P=b.target_port;if(P!==null&&!n.has(P)){n.add(P);const S=(a=b.evidence)==null?void 0:a.service;l.push({port:P,service:S||w[P]||"Unknown",risk:u(P),finding:b})}}return l.sort((b,P)=>b.port-P.port)}),v=M(()=>x.value.filter(l=>l.risk==="dangerous")),p=M(()=>x.value.length),r=M(()=>v.value.length);function d(l){switch(l){case"safe":return"border-emerald-500/30 bg-emerald-500/10 text-emerald-400";case"common":return"border-amber-500/30 bg-amber-500/10 text-amber-400";case"dangerous":return"border-rose-500/30 bg-rose-500/10 text-rose-400"}}return(l,n)=>$.findings.length===0?(t(),s("div",Nt,[k(i(j),{class:"mx-auto h-10 w-10 text-emerald-400"}),n[0]||(n[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No port findings",-1)),n[1]||(n[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"No open ports detected or port scan was not run.",-1))])):(t(),s("div",Dt,[e("h3",Tt,[k(i(J),{class:"h-4 w-4 text-cyan-400"}),n[2]||(n[2]=I(" Port Scan Results ",-1))]),e("div",Lt,[e("span",Vt,[e("span",Rt,o(p.value),1),I(" port"+o(p.value!==1?"s":"")+" open ",1)]),r.value>0?(t(),s("span",jt,[k(i(Z),{class:"h-3.5 w-3.5"}),e("span",Ot,o(r.value),1),n[3]||(n[3]=I(" dangerous ",-1))])):(t(),s("span",Ht,[k(i(j),{class:"h-3.5 w-3.5"}),n[4]||(n[4]=I(" No dangerous ports ",-1))]))]),e("div",qt,[e("div",null,[n[5]||(n[5]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Open Ports",-1)),e("div",Bt,[(t(!0),s(N,null,T(x.value,a=>(t(),s("div",{key:a.port,class:E(["inline-flex items-center gap-1.5 rounded-md border px-2.5 py-1 text-xs font-medium",d(a.risk)])},[e("span",Ut,o(a.port),1),e("span",Kt,o(a.service),1)],2))),128))])]),v.value.length>0?(t(),s("div",zt,[n[6]||(n[6]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Dangerous Ports",-1)),e("div",Gt,[(t(!0),s(N,null,T(v.value,a=>{var b;return t(),s("div",{key:a.port,class:"rounded-lg border border-rose-500/20 bg-rose-500/5 p-3"},[e("div",Wt,[k(i(q),{class:"mt-0.5 h-4 w-4 shrink-0 text-rose-400"}),e("div",Xt,[e("div",Qt,[e("span",Jt," Port "+o(a.port),1),e("span",Yt,o(a.service),1)]),a.finding?(t(),s("p",Zt,o(a.finding.description),1)):h("",!0),(b=a.finding)!=null&&b.remediation?(t(),s("p",es,o(a.finding.remediation),1)):h("",!0)])])])}),128))])])):(t(),s("div",ts,[e("div",ss,[k(i(j),{class:"mx-auto h-8 w-8 text-emerald-400"}),n[7]||(n[7]=e("p",{class:"mt-2 text-sm text-emerald-400"},"No dangerous ports detected",-1))])]))])]))}}),ns={key:0,class:"glass-card rounded-xl p-8 text-center"},as={key:1,class:"glass-card rounded-xl p-5"},os={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},rs={class:"mb-4 text-sm text-slate-400"},is={class:"font-mono font-semibold text-white"},ds={class:"divide-y divide-[var(--border-glass)]"},cs=["onClick"],us={key:0,class:"border-t border-[var(--border-glass)] bg-white/[0.02] px-4 py-3"},xs={class:"space-y-2 text-sm"},ps={class:"text-slate-300"},ms={class:"text-slate-300"},fs=R({__name:"HeadersChecklist",props:{findings:{}},setup($){const c=$,y=[{name:"Strict-Transport-Security (HSTS)",key:"strict-transport-security"},{name:"Content-Security-Policy (CSP)",key:"content-security-policy"},{name:"X-Frame-Options",key:"x-frame-options"},{name:"X-Content-Type-Options",key:"x-content-type-options"},{name:"Referrer-Policy",key:"referrer-policy"},{name:"Permissions-Policy",key:"permissions-policy"},{name:"Server",key:"server"},{name:"X-Powered-By",key:"x-powered-by"}],A=new Set(["server","x-powered-by"]),f=L(null);function w(d){f.value=f.value===d?null:d}const u=M(()=>y.map(d=>{const l=c.findings.find(P=>{const S=P.title.toLowerCase(),m=d.key.toLowerCase();return S.includes(m)||S.includes(d.name.toLowerCase().split(" (")[0]??"")});if(!l)return{name:d.name,key:d.key,status:"present",severity:null,finding:null};const n=A.has(d.key),a=l.title.toLowerCase(),b=n&&(a.includes("leak")||a.includes("exposed")||a.includes("server header"));return{name:d.name,key:d.key,status:b?"info_leak":"missing",severity:l.severity,finding:l}})),x=M(()=>u.value.filter(d=>d.status==="present").length),v=M(()=>u.value.length);function p(d){switch(d){case"present":return{icon:j,text:"text-emerald-400",label:"Present"};case"missing":return{icon:G,text:"text-rose-400",label:"Missing"};case"info_leak":return{icon:Z,text:"text-amber-400",label:"Info Leak"}}}function r(d){switch(d){case"critical":return{bg:"bg-rose-500/20",text:"text-rose-400",label:"CRITICAL"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"HIGH"};case"medium":return{bg:"bg-amber-500/20",text:"text-amber-400",label:"MEDIUM"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"LOW"};case"info":return{bg:"bg-slate-500/20",text:"text-slate-400",label:"INFO"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",label:d}}}return(d,l)=>$.findings.length===0&&u.value.every(n=>n.status==="present")?(t(),s("div",ns,[k(i(z),{class:"mx-auto h-10 w-10 text-emerald-400"}),l[0]||(l[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"All headers present",-1)),l[1]||(l[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"All recommended security headers are configured correctly.",-1))])):(t(),s("div",as,[e("h3",os,[k(i(z),{class:"h-4 w-4 text-cyan-400"}),l[2]||(l[2]=I(" Security Headers Checklist ",-1))]),e("div",rs,[e("span",is,o(x.value),1),I(" / "+o(v.value)+" headers configured ",1)]),e("div",ds,[(t(!0),s(N,null,T(u.value,n=>(t(),s("div",{key:n.key},[e("button",{class:E(["flex w-full items-center gap-3 px-2 py-3 text-left text-sm transition-colors hover:bg-white/5",{"cursor-default":!n.finding}]),onClick:a=>n.finding?w(n.key):void 0},[(t(),D(H(p(n.status).icon),{class:E(["h-4 w-4 shrink-0",p(n.status).text])},null,8,["class"])),e("span",{class:E(["flex-1 font-mono text-xs",n.status==="present"?"text-emerald-400":n.status==="info_leak"?"text-amber-400":"text-rose-400"])},o(n.name),3),e("span",{class:E(["text-xs",p(n.status).text])},o(p(n.status).label),3),n.severity?(t(),s("span",{key:0,class:E(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold",r(n.severity).bg,r(n.severity).text])},o(r(n.severity).label),3)):h("",!0),n.finding?(t(),D(H(f.value===n.key?i(se):i(le)),{key:1,class:"h-3.5 w-3.5 shrink-0 text-slate-500"})):h("",!0)],10,cs),n.finding&&f.value===n.key?(t(),s("div",us,[e("div",xs,[e("div",null,[l[3]||(l[3]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Description",-1)),e("p",ps,o(n.finding.description),1)]),e("div",null,[l[4]||(l[4]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Remediation",-1)),e("p",ms,o(n.finding.remediation),1)])])])):h("",!0)]))),128))])]))}}),vs={key:0,class:"glass-card rounded-xl p-8 text-center"},gs={key:1,class:"glass-card rounded-xl p-5"},bs={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},hs={class:"grid gap-5 lg:grid-cols-2"},_s={class:"mb-3 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},ys={class:"space-y-2"},ws={class:"min-w-0 flex-1"},ks={class:"text-sm font-medium text-white"},$s={class:"truncate text-xs text-slate-500"},Ss={class:"mt-3"},Cs={class:"text-xs text-slate-500"},Ps={class:"mb-3 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},Ms={class:"flex items-center gap-3 rounded-lg border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2.5"},As={class:"min-w-0 flex-1"},Is={class:"truncate text-xs text-slate-500"},Es={class:"mt-4"},Fs={class:"rounded-lg border border-[var(--border-glass)] bg-white/[0.02] p-4 text-center"},Ns={class:"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-white/5"},Ds={key:0,class:"mt-4"},Ts={class:"space-y-1.5"},Ls={class:"text-slate-300"},Vs={class:"mt-0.5 text-slate-500"},Rs=R({__name:"DnsSecurityCard",props:{findings:{}},setup($){const c=$;function y(a){return c.findings.find(b=>b.title.toLowerCase().includes(a.toLowerCase()))??null}const A=M(()=>{const a=y("SPF");return a?{name:"SPF",key:"spf",status:a.severity==="info"?"pass":"fail",detail:a.title,finding:a}:{name:"SPF",key:"spf",status:"pass",detail:"SPF record configured",finding:null}}),f=M(()=>{const a=y("DKIM");return a?{name:"DKIM",key:"dkim",status:a.severity==="info"?"pass":a.severity==="low"?"warn":"fail",detail:a.title,finding:a}:{name:"DKIM",key:"dkim",status:"pass",detail:"DKIM record configured",finding:null}}),w=M(()=>{var S;const a=y("DMARC");if(!a)return{name:"DMARC",key:"dmarc",status:"pass",detail:"DMARC policy active",finding:null};const b=((S=a.evidence)==null?void 0:S.policy)??"";return{name:"DMARC",key:"dmarc",status:b==="none"?"fail":b==="quarantine"?"warn":"fail",detail:a.title,finding:a}}),u=M(()=>{const a=y("CAA");return a?{name:"CAA",key:"caa",status:a.severity==="low"?"warn":"fail",detail:a.title,finding:a}:{name:"CAA",key:"caa",status:"pass",detail:"CAA record present",finding:null}}),x=M(()=>[A.value,f.value,w.value,u.value]),v=M(()=>{var b;const a=w.value.finding;return a?((b=a.evidence)==null?void 0:b.policy)??"none":"reject"});function p(a){switch(a){case"reject":return{icon:z,color:"text-emerald-400",bg:"bg-emerald-500/10",border:"border-emerald-500/20",label:"Reject"};case"quarantine":return{icon:q,color:"text-amber-400",bg:"bg-amber-500/10",border:"border-amber-500/20",label:"Quarantine"};default:return{icon:Fe,color:"text-rose-400",bg:"bg-rose-500/10",border:"border-rose-500/20",label:"None"}}}const r=M(()=>{let a=0;return A.value.status==="pass"&&(a+=30),f.value.status==="pass"?a+=30:f.value.status==="warn"&&(a+=15),w.value.status==="pass"?a+=30:w.value.status==="warn"&&(a+=15),u.value.status==="pass"?a+=10:u.value.status==="warn"&&(a+=5),a});function d(a){switch(a){case"pass":return j;case"warn":return q;case"fail":return G}}function l(a){switch(a){case"pass":return"text-emerald-400";case"warn":return"text-amber-400";case"fail":return"text-rose-400"}}function n(a){return a>=80?"text-emerald-400":a>=50?"text-amber-400":"text-rose-400"}return(a,b)=>$.findings.length===0&&x.value.every(P=>P.status==="pass")?(t(),s("div",vs,[k(i(z),{class:"mx-auto h-10 w-10 text-emerald-400"}),b[0]||(b[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"DNS security configured",-1)),b[1]||(b[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"All DNS security records are properly configured.",-1))])):(t(),s("div",gs,[e("h3",bs,[k(i(ke),{class:"h-4 w-4 text-cyan-400"}),b[2]||(b[2]=I(" DNS Security ",-1))]),e("div",hs,[e("div",null,[e("h4",_s,[k(i(Ie),{class:"h-3.5 w-3.5"}),b[3]||(b[3]=I(" Email Authentication ",-1))]),e("div",ys,[(t(!0),s(N,null,T([A.value,f.value,w.value],P=>(t(),s("div",{key:P.key,class:"flex items-center gap-3 rounded-lg border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2.5"},[(t(),D(H(d(P.status)),{class:E(["h-4 w-4 shrink-0",l(P.status)])},null,8,["class"])),e("div",ws,[e("span",ks,o(P.name),1),e("p",$s,o(P.detail),1)])]))),128))]),e("div",Ss,[b[4]||(b[4]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"DMARC Policy",-1)),e("div",{class:E(["flex items-center gap-2 rounded-lg border p-3",p(v.value).bg,p(v.value).border])},[(t(),D(H(p(v.value).icon),{class:E(["h-5 w-5",p(v.value).color])},null,8,["class"])),e("div",null,[e("span",{class:E(["text-sm font-semibold",p(v.value).color])}," p="+o(v.value),3),e("p",Cs,o(v.value==="reject"?"Unauthorized emails are rejected":v.value==="quarantine"?"Unauthorized emails are quarantined":"No enforcement - emails pass through"),1)])],2)])]),e("div",null,[e("h4",Ps,[k(i(Y),{class:"h-3.5 w-3.5"}),b[5]||(b[5]=I(" Certificate Authority ",-1))]),e("div",Ms,[(t(),D(H(d(u.value.status)),{class:E(["h-4 w-4 shrink-0",l(u.value.status)])},null,8,["class"])),e("div",As,[b[6]||(b[6]=e("span",{class:"text-sm font-medium text-white"},"CAA Record",-1)),e("p",Is,o(u.value.detail),1)])]),e("div",Es,[b[8]||(b[8]=e("h4",{class:"mb-3 text-xs font-medium uppercase text-slate-500"},"Email Security Score",-1)),e("div",Fs,[e("span",{class:E(["text-3xl font-bold tabular-nums",n(r.value)])},o(r.value),3),b[7]||(b[7]=e("span",{class:"text-sm text-slate-500"}," / 100",-1)),e("div",Ns,[e("div",{class:E(["h-full rounded-full transition-all duration-700",r.value>=80?"bg-emerald-400":r.value>=50?"bg-amber-400":"bg-rose-400"]),style:Q({width:`${r.value}%`})},null,6)])])]),$.findings.length>0?(t(),s("div",Ds,[b[9]||(b[9]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Issues Found",-1)),e("div",Ts,[(t(!0),s(N,null,T($.findings,P=>(t(),s("div",{key:P.id,class:"rounded border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs"},[e("span",Ls,o(P.title),1),e("p",Vs,o(P.remediation),1)]))),128))])])):h("",!0)])])]))}}),js={class:"glass-card rounded-xl p-5"},Os={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},Hs={class:"relative ml-3"},qs={class:"min-w-0 flex-1 -mt-0.5"},Bs={class:"flex items-center gap-2"},Us={key:0,class:"rounded bg-white/5 px-1.5 py-0.5 font-mono text-xs text-slate-500"},Ks={key:0,class:"mt-0.5 block font-mono text-xs text-slate-600"},zs=R({__name:"ShieldTimeline",props:{scan:{}},setup($){const c=$,y={tls:"TLS / SSL Check",ports:"Port Scan",headers:"HTTP Headers",dns:"DNS Security",cve:"CVE Matching",creds:"Credential Testing",owasp:"OWASP Probes"};function A(r){return r?new Date(r).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--"}function f(r,d,l){return!l||l<=0?null:`${(l/d).toFixed(1)}s`}const w=M(()=>{const r=[],d=c.scan;r.push({key:"created",label:"Scan created",timestamp:d.created_at,status:"completed",duration:null,type:"start"});const l=d.modules_enabled,n=d.status==="completed",a=d.status==="failed",b=d.status==="running";return l.forEach((P,S)=>{let m="pending";n?m="completed":a?S===l.length-1?m="failed":m="completed":b&&(m=S===0?"running":"pending"),r.push({key:`module-${P}`,label:y[P]??P.toUpperCase(),timestamp:n||m==="completed"?d.started_at:null,status:m,duration:n?f(S,l.length,d.duration_seconds):null,type:"module"})}),n?r.push({key:"completed",label:"Scan completed",timestamp:d.completed_at,status:"completed",duration:d.duration_seconds?`${d.duration_seconds}s total`:null,type:"end"}):a?r.push({key:"failed",label:"Scan failed",timestamp:d.completed_at,status:"failed",duration:null,type:"end"}):r.push({key:"pending",label:"Awaiting completion",timestamp:null,status:"pending",duration:null,type:"end"}),r});function u(r){if(r.type==="start")return Ee;if(r.type==="end")return Ae;switch(r.status){case"completed":return j;case"running":return te;case"failed":return G;default:return xe}}function x(r){switch(r.status){case"completed":return"text-cyan-400";case"running":return"text-cyan-400 animate-spin";case"failed":return"text-rose-400";default:return"text-slate-600"}}function v(r){switch(r.status){case"completed":return"bg-cyan-500/40";case"running":return"bg-cyan-500/20";case"failed":return"bg-rose-500/40";default:return"bg-slate-700"}}function p(r){return r.status==="completed"?"shadow-[0_0_6px_rgba(34,211,238,0.4)]":r.status==="running"?"shadow-[0_0_8px_rgba(34,211,238,0.6)]":""}return(r,d)=>(t(),s("div",js,[e("h3",Os,[k(i(xe),{class:"h-4 w-4 text-cyan-400"}),d[0]||(d[0]=I(" Scan Timeline ",-1))]),e("div",Hs,[(t(!0),s(N,null,T(w.value,(l,n)=>(t(),s("div",{key:l.key,class:"relative flex gap-4 pb-6 last:pb-0"},[n<w.value.length-1?(t(),s("div",{key:0,class:E(["absolute left-[7px] top-5 w-0.5",v(w.value[n+1]??l)]),style:{height:"calc(100% - 8px)"}},null,2)):h("",!0),e("div",{class:E(["relative z-10 flex h-4 w-4 shrink-0 items-center justify-center rounded-full",p(l)])},[(t(),D(H(u(l)),{class:E(["h-4 w-4",x(l)])},null,8,["class"]))],2),e("div",qs,[e("div",Bs,[e("span",{class:E(["text-sm font-medium",l.status==="completed"?"text-white":l.status==="running"?"text-cyan-400":l.status==="failed"?"text-rose-400":"text-slate-500"])},o(l.label),3),l.duration?(t(),s("span",Us,o(l.duration),1)):h("",!0)]),l.timestamp?(t(),s("span",Ks,o(A(l.timestamp)),1)):h("",!0)])]))),128))])]))}}),Gs={key:0,class:"glass-card rounded-xl p-8 text-center"},Ws={key:1,class:"glass-card overflow-hidden rounded-xl"},Xs={class:"border-b border-[var(--border-glass)] px-4 py-3"},Qs={class:"flex flex-wrap items-center gap-4 text-sm"},Js={class:"font-semibold text-white flex items-center gap-2"},Ys={class:"text-slate-400"},Zs={class:"font-mono font-semibold text-white"},el={key:0,class:"text-rose-400"},tl={class:"font-mono font-semibold"},sl={key:1,class:"flex items-center gap-1 text-red-400"},ll={class:"font-mono font-semibold"},nl={class:"flex flex-wrap items-center gap-3 border-b border-[var(--border-glass)] px-4 py-2.5"},al={class:"flex items-center gap-1.5 text-xs text-slate-500"},ol={class:"flex gap-1"},rl=["onClick"],il={class:"flex items-center gap-1.5 text-xs text-slate-500"},dl={class:"flex gap-1"},cl=["onClick"],ul=["onClick"],xl=["href"],pl={key:1,class:"text-xs text-slate-600"},ml={class:"flex items-center gap-1.5"},fl={class:"h-1.5 w-16 overflow-hidden rounded-full bg-white/5"},vl={class:"font-mono text-xs text-slate-400"},gl={key:2,class:"flex items-center gap-1 text-red-400"},bl={key:3},hl={class:"flex items-center gap-1.5 truncate text-slate-300"},_l={key:0,class:"border-t border-[var(--border-glass)] bg-white/[0.02] px-6 py-4"},yl={class:"space-y-3 text-sm"},wl={class:"text-slate-300"},kl={class:"text-slate-300"},$l={class:"flex flex-wrap gap-4 text-xs"},Sl={key:0},Cl={class:"ml-1 font-mono text-slate-300"},Pl={key:1},Ml={class:"ml-1 text-slate-300"},Al={key:2},Il={class:"ml-1 text-slate-300"},El={key:3},Fl={key:0},Nl={class:"overflow-x-auto rounded-lg bg-black/30 p-3 font-mono text-xs text-slate-400"},Dl={key:0,class:"px-4 py-6 text-center text-sm text-slate-500"},Tl=R({__name:"CveFindings",props:{findings:{}},setup($){const c=$,y=L("severity"),A=L(null),f=L(new Set(["critical","high","medium","low","info"])),w={critical:0,high:1,medium:2,low:3,info:4},u=M(()=>[...c.findings.filter(m=>f.value.has(m.severity))].sort((m,g)=>{switch(y.value){case"cvss":return(g.cvss_score??0)-(m.cvss_score??0);case"epss":return(g.epss_score??0)-(m.epss_score??0);default:return(w[m.severity]??5)-(w[g.severity]??5)}})),x=M(()=>c.findings.filter(S=>S.severity==="critical").length),v=M(()=>c.findings.filter(S=>S.cisa_kev).length);function p(S){A.value=A.value===S?null:S}function r(S){const m=new Set(f.value);m.has(S)?m.delete(S):m.add(S),f.value=m}function d(S){return S===null?{bg:"bg-slate-500/20",text:"text-slate-400",label:"N/A"}:S>=9?{bg:"bg-red-500/20",text:"text-red-400",label:"Critical"}:S>=7?{bg:"bg-rose-500/20",text:"text-rose-400",label:"High"}:S>=4?{bg:"bg-amber-500/20",text:"text-amber-400",label:"Medium"}:{bg:"bg-slate-500/20",text:"text-slate-400",label:"Low"}}function l(S){switch(S){case"critical":return{bg:"bg-rose-500/20",text:"text-rose-400",label:"CRITICAL"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"HIGH"};case"medium":return{bg:"bg-amber-500/20",text:"text-amber-400",label:"MEDIUM"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"LOW"};case"info":return{bg:"bg-slate-500/20",text:"text-slate-400",label:"INFO"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",label:S}}}function n(S){return S===null?0:Math.round(S*100)}function a(S){return S===null?"bg-slate-500":S>=.7?"bg-red-400":S>=.4?"bg-amber-400":"bg-cyan-400"}const b=[{value:"severity",label:"Severity"},{value:"cvss",label:"CVSS Score"},{value:"epss",label:"EPSS Score"}],P=["critical","high","medium","low","info"];return(S,m)=>$.findings.length===0?(t(),s("div",Gs,[k(i(j),{class:"mx-auto h-10 w-10 text-emerald-400"}),m[1]||(m[1]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No CVEs Detected",-1)),m[2]||(m[2]=e("p",{class:"mt-1 text-sm text-slate-400"},"No known vulnerabilities were found for the target services.",-1))])):(t(),s("div",Ws,[e("div",Xs,[e("div",Qs,[e("h3",Js,[k(i(q),{class:"h-4 w-4 text-rose-400"}),m[3]||(m[3]=I(" CVE Intelligence ",-1))]),e("span",Ys,[e("span",Zs,o($.findings.length),1),I(" CVE"+o($.findings.length!==1?"s":"")+" found ",1)]),x.value>0?(t(),s("span",el,[e("span",tl,o(x.value),1),m[4]||(m[4]=I(" critical ",-1))])):h("",!0),v.value>0?(t(),s("span",sl,[k(i(q),{class:"h-3.5 w-3.5"}),e("span",ll,o(v.value),1),m[5]||(m[5]=I(" actively exploited (KEV) ",-1))])):h("",!0)])]),e("div",nl,[e("div",al,[k(i($e),{class:"h-3.5 w-3.5"}),m[6]||(m[6]=e("span",null,"Sort:",-1)),e("div",ol,[(t(),s(N,null,T(b,g=>e("button",{key:g.value,class:E(["rounded px-2 py-0.5 transition-colors",y.value===g.value?"bg-cyan-500/20 text-cyan-400":"text-slate-400 hover:bg-white/5 hover:text-slate-300"]),onClick:O=>y.value=g.value},o(g.label),11,rl)),64))])]),m[8]||(m[8]=e("span",{class:"text-slate-700"},"|",-1)),e("div",il,[k(i(Me),{class:"h-3.5 w-3.5"}),m[7]||(m[7]=e("span",null,"Filter:",-1)),e("div",dl,[(t(),s(N,null,T(P,g=>e("button",{key:g,class:E(["rounded px-2 py-0.5 transition-colors",f.value.has(g)?`${l(g).bg} ${l(g).text}`:"text-slate-600 hover:text-slate-400"]),onClick:O=>r(g)},o(g),11,cl)),64))])])]),m[17]||(m[17]=e("div",{class:"hidden md:grid grid-cols-[110px_70px_120px_70px_90px_1fr] gap-2 border-b border-[var(--border-glass)] px-4 py-2 text-xs font-medium text-slate-500"},[e("span",null,"CVE ID"),e("span",null,"CVSS"),e("span",null,"EPSS"),e("span",null,"KEV"),e("span",null,"Severity"),e("span",null,"Title")],-1)),(t(!0),s(N,null,T(u.value,g=>(t(),s("div",{key:g.id,class:"border-b border-[var(--border-glass)] last:border-0"},[e("button",{class:"w-full px-4 py-3 text-left text-sm transition-colors hover:bg-white/5 md:grid md:grid-cols-[110px_70px_120px_70px_90px_1fr] md:items-center md:gap-2",onClick:O=>p(g.id)},[g.cve_id?(t(),s("a",{key:0,href:`https://nvd.nist.gov/vuln/detail/${g.cve_id}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center gap-1 font-mono text-xs font-semibold text-cyan-400 hover:text-cyan-300",onClick:m[0]||(m[0]=ee(()=>{},["stop"]))},[I(o(g.cve_id)+" ",1),k(i(pe),{class:"h-2.5 w-2.5"})],8,xl)):(t(),s("span",pl,"--")),e("span",{class:E(["inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-bold tabular-nums",d(g.cvss_score).bg,d(g.cvss_score).text])},o(g.cvss_score!==null?g.cvss_score.toFixed(1):"N/A"),3),e("div",ml,[e("div",fl,[e("div",{class:E(["h-full rounded-full transition-all",a(g.epss_score)]),style:Q({width:`${n(g.epss_score)}%`})},null,6)]),e("span",vl,o(g.epss_score!==null?`${n(g.epss_score)}%`:"--"),1)]),g.cisa_kev?(t(),s("span",gl,[k(i(q),{class:"h-3.5 w-3.5"}),m[9]||(m[9]=e("span",{class:"text-[10px] font-semibold uppercase"},"KEV",-1))])):(t(),s("span",bl,[k(i(z),{class:"h-3.5 w-3.5 text-slate-600"})])),e("span",{class:E(["inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-semibold",l(g.severity).bg,l(g.severity).text])},o(l(g.severity).label),3),e("span",hl,[(t(),D(H(A.value===g.id?i(se):i(le)),{class:"h-3.5 w-3.5 shrink-0 text-slate-500"})),I(" "+o(g.title),1)])],8,ul),A.value===g.id?(t(),s("div",_l,[e("div",yl,[e("div",null,[m[10]||(m[10]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Description",-1)),e("p",wl,o(g.description),1)]),e("div",null,[m[11]||(m[11]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Remediation",-1)),e("p",kl,o(g.remediation),1)]),e("div",$l,[g.target_port?(t(),s("div",Sl,[m[12]||(m[12]=e("span",{class:"text-slate-500"},"Port:",-1)),e("span",Cl,o(g.target_ip)+":"+o(g.target_port),1)])):h("",!0),g.attack_technique?(t(),s("div",Pl,[m[13]||(m[13]=e("span",{class:"text-slate-500"},"Technique:",-1)),e("span",Ml,o(g.attack_technique),1)])):h("",!0),g.attack_tactic?(t(),s("div",Al,[m[14]||(m[14]=e("span",{class:"text-slate-500"},"Tactic:",-1)),e("span",Il,o(g.attack_tactic),1)])):h("",!0),g.cisa_kev?(t(),s("div",El,[...m[15]||(m[15]=[e("span",{class:"rounded bg-red-500/20 px-1.5 py-0.5 font-semibold text-red-400"}," Actively Exploited ",-1)])])):h("",!0)]),g.evidence&&Object.keys(g.evidence).length>0?(t(),s("div",Fl,[m[16]||(m[16]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Evidence",-1)),e("pre",Nl,o(JSON.stringify(g.evidence,null,2)),1)])):h("",!0)])])):h("",!0)]))),128)),u.value.length===0&&$.findings.length>0?(t(),s("div",Dl," No CVEs match the current filter. Adjust filters to see results. ")):h("",!0)]))}}),Ll={key:0,class:"glass-card rounded-xl p-8 text-center"},Vl={key:1,class:"glass-card rounded-xl p-5"},Rl={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},jl={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},Ol={class:"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},Hl={class:"space-y-1.5"},ql={class:"font-mono text-sm font-bold text-cyan-400"},Bl={class:"text-xs text-slate-500"},Ul={key:0,class:"rounded-md border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs text-slate-500"},Kl={class:"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},zl={class:"space-y-1.5"},Gl={key:0,class:"absolute -right-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block"},Wl={class:"flex items-center gap-2"},Xl={class:"text-sm font-medium text-white"},Ql={key:0,class:"truncate text-xs text-slate-500"},Jl={class:"mt-1 flex flex-wrap gap-1"},Yl={key:1,class:"mt-1.5 flex items-center gap-1 text-[10px] text-rose-400"},Zl={key:0,class:"rounded-md border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs text-slate-500"},en={class:"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},tn={class:"space-y-1.5"},sn={class:"flex items-center gap-2"},ln=["href"],nn={class:"mt-1 text-[10px] opacity-75"},an={key:0,class:"rounded-md border border-emerald-500/20 bg-emerald-500/5 px-3 py-4 text-center"},on=R({__name:"AttackSurfaceMap",props:{findings:{}},setup($){const c=$,y=M(()=>c.findings.filter(d=>d.module==="ports")),A=M(()=>c.findings.filter(d=>d.module==="cve")),f=M(()=>{var P,S,m,g,O;const d=new Map,l=new Map,n=[];for(const F of y.value)if(F.target_port!==null){d.has(F.target_port)||d.set(F.target_port,{port:F.target_port,ip:F.target_ip});const _=((S=(P=F.evidence)==null?void 0:P.service)==null?void 0:S.toLowerCase())??"unknown",C=(m=F.evidence)==null?void 0:m.banner;l.has(_)||l.set(_,{name:_,version:C??null,ports:[]});const B=l.get(_);B&&!B.ports.includes(F.target_port)&&B.ports.push(F.target_port)}for(const F of A.value)if(F.cve_id){const _=((O=(g=F.evidence)==null?void 0:g.service)==null?void 0:O.toLowerCase())??"unknown";n.push({cveId:F.cve_id,severity:F.severity,service:_,port:F.target_port}),l.has(_)||l.set(_,{name:_,version:null,ports:F.target_port!==null?[F.target_port]:[]}),F.target_port!==null&&!d.has(F.target_port)&&d.set(F.target_port,{port:F.target_port,ip:F.target_ip})}const a=Array.from(d.values()).sort((F,_)=>F.port-_.port),b=Array.from(l.values()).sort((F,_)=>F.name.localeCompare(_.name));return{ports:a,services:b,cves:n}}),w=M(()=>f.value.cves.length>0),u=M(()=>f.value.ports.length>0||f.value.cves.length>0);function x(d){switch(d){case"critical":return"border-red-500/40 bg-red-500/10 text-red-400";case"high":return"border-rose-500/40 bg-rose-500/10 text-rose-400";case"medium":return"border-amber-500/40 bg-amber-500/10 text-amber-400";case"low":return"border-blue-500/40 bg-blue-500/10 text-blue-400";default:return"border-slate-500/40 bg-slate-500/10 text-slate-400"}}function v(d){switch(d){case"critical":return"bg-red-400";case"high":return"bg-rose-400";case"medium":return"bg-amber-400";case"low":return"bg-blue-400";default:return"bg-slate-400"}}function p(d){return f.value.cves.filter(l=>l.service===d)}function r(d){const l=f.value.services.find(n=>n.name===d);return(l==null?void 0:l.ports)??[]}return(d,l)=>u.value?(t(),s("div",Vl,[e("h3",Rl,[k(i(J),{class:"h-4 w-4 text-cyan-400"}),l[3]||(l[3]=I(" Attack Surface Map ",-1))]),l[10]||(l[10]=e("p",{class:"mb-4 text-xs text-slate-500"}," Showing port-to-service-to-CVE chain. Connections indicate potential attack paths. ",-1)),e("div",jl,[e("div",null,[e("h4",Ol,[k(i(J),{class:"h-3.5 w-3.5"}),l[4]||(l[4]=I(" Open Ports ",-1))]),e("div",Hl,[(t(!0),s(N,null,T(f.value.ports,n=>(t(),s("div",{key:n.port,class:"flex items-center gap-2 rounded-md border border-cyan-500/20 bg-cyan-500/5 px-3 py-2"},[e("span",ql,o(n.port),1),e("span",Bl,o(n.ip),1)]))),128)),f.value.ports.length===0?(t(),s("div",Ul," No ports detected ")):h("",!0)])]),e("div",null,[e("h4",Kl,[k(i(me),{class:"h-3.5 w-3.5"}),l[5]||(l[5]=I(" Services ",-1))]),e("div",zl,[(t(!0),s(N,null,T(f.value.services,n=>(t(),s("div",{key:n.name,class:"relative rounded-md border border-slate-500/20 bg-white/[0.03] px-3 py-2"},[l[6]||(l[6]=e("div",{class:"absolute -left-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block"},null,-1)),p(n.name).length>0?(t(),s("div",Gl)):h("",!0),e("div",Wl,[e("span",Xl,o(n.name),1),n.version?(t(),s("span",Ql,o(n.version),1)):h("",!0)]),e("div",Jl,[(t(!0),s(N,null,T(r(n.name),a=>(t(),s("span",{key:a,class:"rounded bg-white/5 px-1.5 py-0.5 font-mono text-[10px] text-slate-400"}," :"+o(a),1))),128))]),p(n.name).length>0?(t(),s("div",Yl,[k(i(fe),{class:"h-3 w-3"}),I(" "+o(p(n.name).length)+" CVE"+o(p(n.name).length!==1?"s":""),1)])):h("",!0)]))),128)),f.value.services.length===0?(t(),s("div",Zl," No services detected ")):h("",!0)])]),e("div",null,[e("h4",en,[k(i(q),{class:"h-3.5 w-3.5"}),l[7]||(l[7]=I(" CVEs ",-1))]),e("div",tn,[(t(!0),s(N,null,T(f.value.cves,n=>(t(),s("div",{key:n.cveId,class:E(["relative rounded-md border px-3 py-2",x(n.severity)])},[l[8]||(l[8]=e("div",{class:"absolute -left-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block"},null,-1)),e("div",sn,[e("span",{class:E(["h-2 w-2 rounded-full",v(n.severity)])},null,2),e("a",{href:`https://nvd.nist.gov/vuln/detail/${n.cveId}`,target:"_blank",rel:"noopener noreferrer",class:"font-mono text-xs font-semibold hover:underline",onClick:l[0]||(l[0]=ee(()=>{},["stop"]))},o(n.cveId),9,ln)]),e("div",nn,o(n.service)+o(n.port!==null?` :${n.port}`:""),1)],2))),128)),w.value?h("",!0):(t(),s("div",an,[k(i(j),{class:"mx-auto h-5 w-5 text-emerald-400"}),l[9]||(l[9]=e("p",{class:"mt-1 text-xs text-emerald-400"},"No CVE associations found",-1))]))])])]),l[11]||(l[11]=e("div",{class:"mt-3 hidden items-center justify-center gap-6 text-xs text-slate-600 md:flex"},[e("span",null,"Ports"),e("span",null,"-->"),e("span",null,"Services"),e("span",null,"-->"),e("span",null,"Vulnerabilities")],-1))])):(t(),s("div",Ll,[k(i(j),{class:"mx-auto h-10 w-10 text-emerald-400"}),l[1]||(l[1]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No Attack Surface Data",-1)),l[2]||(l[2]=e("p",{class:"mt-1 text-sm text-slate-400"}," No port or CVE findings available to map the attack surface. ",-1))]))}}),rn={class:"glass-card rounded-xl p-4"},dn={key:0,class:"flex flex-col items-center justify-center py-12 text-slate-500"},cn={key:1},un={class:"mb-4 grid grid-cols-4 gap-2 text-center text-xs"},xn={class:"rounded bg-red-500/10 px-2 py-1"},pn={class:"font-bold text-red-400"},mn={class:"rounded bg-amber-500/10 px-2 py-1"},fn={class:"font-bold text-amber-400"},vn={class:"rounded bg-rose-500/10 px-2 py-1"},gn={class:"font-bold text-rose-400"},bn={class:"rounded bg-slate-500/10 px-2 py-1"},hn={class:"font-bold text-slate-400"},_n={class:"relative"},yn={class:"relative ml-4 aspect-square w-full overflow-hidden rounded-lg border border-white/5 bg-white/[0.02]"},wn={class:"invisible absolute bottom-full left-1/2 mb-2 -translate-x-1/2 whitespace-nowrap rounded bg-slate-800 px-2 py-1 text-[10px] text-white shadow-lg group-hover:visible z-10"},kn={class:"font-mono font-bold"},$n={key:0,class:"text-red-400"},Sn=R({__name:"PriorityMatrix",props:{findings:{}},setup($){const c=$,y=M(()=>c.findings.filter(u=>u.cvss_score!=null&&u.epss_score!=null).map(u=>({id:u.id,cveId:u.cve_id??u.title,cvss:u.cvss_score,epss:u.epss_score*100,severity:u.severity,kev:u.cisa_kev})));function A(u){return{left:`${u.cvss/10*100}%`,bottom:`${u.epss}%`}}function f(u){switch(u){case"critical":return"bg-red-500";case"high":return"bg-rose-500";case"medium":return"bg-amber-500";case"low":return"bg-slate-400";default:return"bg-slate-500"}}const w=M(()=>{const u={urgent:0,monitor:0,plan:0,low:0};for(const x of y.value)x.cvss>=5&&x.epss>=50?u.urgent++:x.cvss<5&&x.epss>=50?u.monitor++:x.cvss>=5&&x.epss<50?u.plan++:u.low++;return u});return(u,x)=>(t(),s("div",rn,[x[9]||(x[9]=e("h3",{class:"mb-3 text-sm font-medium text-white"},"Priority Matrix",-1)),y.value.length===0?(t(),s("div",dn,[...x[0]||(x[0]=[e("p",{class:"text-sm"},"No CVE data for priority matrix",-1)])])):(t(),s("div",cn,[e("div",un,[e("div",xn,[e("span",pn,o(w.value.urgent),1),x[1]||(x[1]=e("span",{class:"text-slate-500"}," Urgent",-1))]),e("div",mn,[e("span",fn,o(w.value.monitor),1),x[2]||(x[2]=e("span",{class:"text-slate-500"}," Monitor",-1))]),e("div",vn,[e("span",gn,o(w.value.plan),1),x[3]||(x[3]=e("span",{class:"text-slate-500"}," Plan",-1))]),e("div",bn,[e("span",hn,o(w.value.low),1),x[4]||(x[4]=e("span",{class:"text-slate-500"}," Low",-1))])]),e("div",_n,[x[6]||(x[6]=e("div",{class:"absolute -left-6 top-1/2 -translate-y-1/2 -rotate-90 text-[10px] text-slate-500 whitespace-nowrap"}," EPSS Score (%) ",-1)),e("div",yn,[x[5]||(x[5]=we('<div class="absolute right-0 top-0 h-1/2 w-1/2 bg-red-500/5"></div><div class="absolute left-0 top-0 h-1/2 w-1/2 bg-amber-500/5"></div><div class="absolute bottom-0 right-0 h-1/2 w-1/2 bg-rose-500/5"></div><div class="absolute bottom-0 left-0 h-1/2 w-1/2 bg-slate-500/5"></div><div class="absolute left-1/2 top-0 h-full w-px bg-white/10"></div><div class="absolute left-0 top-1/2 h-px w-full bg-white/10"></div><span class="absolute right-2 top-2 text-[9px] font-medium text-red-400/60">URGENT</span><span class="absolute left-2 top-2 text-[9px] font-medium text-amber-400/60">MONITOR</span><span class="absolute bottom-2 right-2 text-[9px] font-medium text-rose-400/60">PLAN</span><span class="absolute bottom-2 left-2 text-[9px] font-medium text-slate-400/60">LOW</span>',10)),(t(!0),s(N,null,T(y.value,v=>(t(),s("div",{key:v.id,class:E(["group absolute -ml-1.5 -mb-1.5 h-3 w-3 rounded-full transition-transform hover:scale-150",[f(v.severity),v.kev?"ring-2 ring-red-400 animate-pulse":""]]),style:Q(A(v))},[e("div",wn,[e("div",kn,o(v.cveId),1),e("div",null,"CVSS: "+o(v.cvss)+" | EPSS: "+o(v.epss.toFixed(0))+"%",1),v.kev?(t(),s("div",$n,"CISA KEV")):h("",!0)])],6))),128))]),x[7]||(x[7]=e("div",{class:"mt-1 text-center text-[10px] text-slate-500"},"CVSS Score (0-10)",-1)),x[8]||(x[8]=e("div",{class:"ml-4 flex justify-between text-[9px] text-slate-600"},[e("span",null,"0"),e("span",null,"5"),e("span",null,"10")],-1))])]))]))}}),Cn={class:"space-y-6"},Pn={class:"flex items-center justify-between"},Mn=["disabled"],An={key:0,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},In={class:"mt-2 text-sm text-slate-400"},En={key:1,class:"flex flex-col items-center justify-center py-20"},Fn={key:2,class:"glass-card rounded-xl p-8 text-center"},Nn={class:"mt-3 text-sm text-slate-300"},Dn={class:"mx-auto mt-4 flex max-w-xs items-center gap-3"},Tn={class:"text-xs text-slate-500"},Ln={key:0,class:"mt-3"},Vn={class:"text-xs text-slate-500"},Rn={key:3,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},jn={class:"mt-2 text-sm text-slate-400"},On={class:"flex flex-col gap-6 lg:flex-row"},Hn={class:"glass-card flex items-center justify-center rounded-xl p-6 lg:w-72"},qn={class:"min-w-0 flex-1"},Bn={class:"mb-3 flex items-center justify-between"},Un={class:"flex items-center gap-3 text-xs text-slate-500"},Kn={class:"flex items-center gap-1"},zn={class:"flex items-center gap-1"},Gn={key:1,class:"glass-card rounded-xl p-6 text-center"},Wn={key:0,class:"lg:w-64"},Xn={class:"glass-card flex flex-wrap items-center gap-4 rounded-lg px-4 py-2.5 text-xs text-slate-500"},Qn={class:"font-mono text-slate-300"},Jn={class:"text-slate-300"},Yn={class:"font-mono text-slate-300"},Zn={class:"font-mono text-slate-300"},ea={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400"},ta={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400"},sa={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400"},la={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400"},na={class:"space-y-6"},aa={class:"grid gap-6 lg:grid-cols-2"},_a=R({__name:"ShieldView",setup($){const{currentScan:c,findings:y,loading:A,scanning:f,error:w,startScan:u,fetchScan:x}=De();async function v(_,C){await u(_,C)}function p(){var _;(_=c.value)!=null&&_.id&&x(c.value.id)}const r=M(()=>{if(!c.value)return"";switch(c.value.status){case"queued":return"Scan queued, waiting to start...";case"running":return`Scanning ${c.value.target}...`;case"completed":return`Scan completed in ${c.value.duration_seconds??"?"}s`;case"failed":return"Scan failed";default:return""}}),d=M(()=>{var _;return((_=c.value)==null?void 0:_.status)==="completed"}),l=M(()=>{var _;return((_=c.value)==null?void 0:_.status)==="failed"}),n=M(()=>{var _;return((_=c.value)==null?void 0:_.module_scores)&&Object.keys(c.value.module_scores).length>0}),a=M(()=>{var _;return((_=c.value)==null?void 0:_.findings.filter(C=>C.module==="ports"))??[]}),b=M(()=>{var _;return((_=c.value)==null?void 0:_.findings.filter(C=>C.module==="headers"))??[]}),P=M(()=>{var _;return((_=c.value)==null?void 0:_.findings.filter(C=>C.module==="dns"))??[]}),S=M(()=>{var _;return((_=c.value)==null?void 0:_.findings.filter(C=>C.module==="cve"))??[]}),m=M(()=>{var _;return((_=c.value)==null?void 0:_.modules_enabled.includes("ports"))??!1}),g=M(()=>{var _;return((_=c.value)==null?void 0:_.modules_enabled.includes("headers"))??!1}),O=M(()=>{var _;return((_=c.value)==null?void 0:_.modules_enabled.includes("dns"))??!1}),F=M(()=>{var _;return((_=c.value)==null?void 0:_.modules_enabled.includes("cve"))??!1});return(_,C)=>{var B,ne,ae,oe,re,ie,de,ce,ue;return t(),s("div",Cn,[e("div",Pn,[C[1]||(C[1]=e("div",null,[e("h1",{class:"text-2xl font-bold text-white"},"Shield - Security Validation"),e("p",{class:"mt-1 text-sm text-slate-400"}," Comprehensive security scanning and vulnerability assessment ")],-1)),e("button",{class:"flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 text-xs text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",disabled:i(A)||i(f),onClick:p},[k(i(Pe),{class:E(["h-3.5 w-3.5",{"animate-spin":i(A)}])},null,8,["class"]),C[0]||(C[0]=I(" Refresh ",-1))],8,Mn)]),k(qe,{scanning:i(f),onScan:v},null,8,["scanning"]),i(w)&&!i(c)?(t(),s("div",An,[k(i(Z),{class:"mx-auto h-10 w-10 text-amber-400"}),C[2]||(C[2]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Unable to Start Scan",-1)),e("p",In,o(i(w)),1)])):h("",!0),!i(c)&&!i(w)?(t(),s("div",En,[k(i(Y),{class:"h-16 w-16 text-slate-600"}),C[3]||(C[3]=e("h2",{class:"mt-4 text-lg font-medium text-slate-400"},"Enter a target to begin",-1)),C[4]||(C[4]=e("p",{class:"mt-1 text-sm text-slate-500"}," Provide an IP address, domain, or CIDR range to start a security scan ",-1))])):h("",!0),i(c)&&i(f)?(t(),s("div",Fn,[k(i(te),{class:"mx-auto h-10 w-10 animate-spin text-cyan-400"}),e("p",Nn,o(r.value),1),e("div",Dn,[C[5]||(C[5]=e("div",{class:"h-1.5 flex-1 overflow-hidden rounded-full bg-white/5"},[e("div",{class:"h-full w-1/3 animate-pulse rounded-full bg-cyan-500/50"})],-1)),e("span",Tn,o(i(c).status),1)]),i(c).modules_enabled.length>0?(t(),s("div",Ln,[e("span",Vn," Modules: "+o(i(c).modules_enabled.join(", ")),1)])):h("",!0)])):h("",!0),l.value&&!i(f)?(t(),s("div",Rn,[k(i(G),{class:"mx-auto h-10 w-10 text-rose-400"}),C[6]||(C[6]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Scan Failed",-1)),e("p",jn," The scan for "+o((B=i(c))==null?void 0:B.target)+" could not be completed. ",1)])):h("",!0),d.value&&!i(f)?(t(),s(N,{key:4},[e("div",On,[e("div",Hn,[k(Xe,{score:((ne=i(c))==null?void 0:ne.shield_score)??null,grade:((ae=i(c))==null?void 0:ae.grade)??null,loading:i(A)},null,8,["score","grade","loading"])]),e("div",qn,[e("div",Bn,[C[7]||(C[7]=e("h2",{class:"text-sm font-medium text-white"},"Module Scores",-1)),e("div",Un,[e("span",Kn,[k(i(j),{class:"h-3 w-3 text-emerald-400"}),I(" "+o(((oe=i(c))==null?void 0:oe.passed_checks)??0)+" passed ",1)]),e("span",zn,[k(i(G),{class:"h-3 w-3 text-rose-400"}),I(" "+o(((re=i(c))==null?void 0:re.failed_checks)??0)+" failed ",1)])])]),n.value?(t(),D(lt,{key:0,scores:i(c).module_scores},null,8,["scores"])):(t(),s("div",Gn,[...C[8]||(C[8]=[e("p",{class:"text-sm text-slate-500"},"No module breakdown available",-1)])]))]),i(c)?(t(),s("div",Wn,[k(zs,{scan:i(c)},null,8,["scan"])])):h("",!0)]),e("div",Xn,[e("span",null,[C[9]||(C[9]=I(" Target: ",-1)),e("span",Qn,o((ie=i(c))==null?void 0:ie.target),1)]),e("span",null,[C[10]||(C[10]=I(" Depth: ",-1)),e("span",Jn,o((de=i(c))==null?void 0:de.scan_depth),1)]),e("span",null,[C[11]||(C[11]=I(" Duration: ",-1)),e("span",Yn,o(((ce=i(c))==null?void 0:ce.duration_seconds)??"?")+"s",1)]),e("span",null,[C[12]||(C[12]=I(" Checks: ",-1)),e("span",Zn,o((ue=i(c))==null?void 0:ue.total_checks),1)])]),k(i(Se),{"default-value":"findings"},{default:V(()=>[k(i(Ce),{class:"bg-white/5"},{default:V(()=>[k(i(U),{value:"findings",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:V(()=>[...C[13]||(C[13]=[I(" All Findings ",-1)])]),_:1}),m.value?(t(),D(i(U),{key:0,value:"ports",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:V(()=>[C[14]||(C[14]=I(" Ports ",-1)),a.value.length>0?(t(),s("span",ea,o(a.value.length),1)):h("",!0)]),_:1})):h("",!0),g.value?(t(),D(i(U),{key:1,value:"headers",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:V(()=>[C[15]||(C[15]=I(" Headers ",-1)),b.value.length>0?(t(),s("span",ta,o(b.value.length),1)):h("",!0)]),_:1})):h("",!0),O.value?(t(),D(i(U),{key:2,value:"dns",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:V(()=>[C[16]||(C[16]=I(" DNS ",-1)),P.value.length>0?(t(),s("span",sa,o(P.value.length),1)):h("",!0)]),_:1})):h("",!0),F.value?(t(),D(i(U),{key:3,value:"cve",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:V(()=>[C[17]||(C[17]=I(" CVE ",-1)),S.value.length>0?(t(),s("span",la,o(S.value.length),1)):h("",!0)]),_:1})):h("",!0)]),_:1}),k(i(K),{value:"findings"},{default:V(()=>[k(Ft,{findings:i(y)},null,8,["findings"])]),_:1}),m.value?(t(),D(i(K),{key:0,value:"ports"},{default:V(()=>[k(ls,{findings:a.value},null,8,["findings"])]),_:1})):h("",!0),g.value?(t(),D(i(K),{key:1,value:"headers"},{default:V(()=>[k(fs,{findings:b.value},null,8,["findings"])]),_:1})):h("",!0),O.value?(t(),D(i(K),{key:2,value:"dns"},{default:V(()=>[k(Rs,{findings:P.value},null,8,["findings"])]),_:1})):h("",!0),F.value?(t(),D(i(K),{key:3,value:"cve"},{default:V(()=>[e("div",na,[k(Tl,{findings:S.value},null,8,["findings"]),e("div",aa,[k(on,{findings:i(y)},null,8,["findings"]),k(Sn,{findings:S.value},null,8,["findings"])])])]),_:1})):h("",!0)]),_:1})],64)):h("",!0)])}}});export{_a as default};
//# sourceMappingURL=ShieldView-Yu0VWluH.js.map
