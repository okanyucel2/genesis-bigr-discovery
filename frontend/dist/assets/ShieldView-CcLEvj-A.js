import{c as z,b as B,d as X,N as de,T as G,a as U}from"./index-CpS9bQ3X.js";import{I as ce,r as I,z as C,a as ue,d as E,e as l,g as e,N as me,W as xe,F,p as N,f as M,q as T,k as o,H as P,y as i,Q as pe,c as n,o as fe,w as ge,m as w,E as oe,j as $,x as j,l as L}from"./vendor-B81oEKTZ.js";import{L as Q}from"./loader-circle-GrpjL4Zy.js";import{C as R}from"./circle-check-big-DwLz-eYA.js";import{C as re}from"./chevron-down-_q7CsRwS.js";import{C as ie,E as ve,S as K}from"./shield-alert-BzWDHMCA.js";import{C as H}from"./circle-x-C2IgKrA8.js";import{G as be}from"./globe-RLrrrDcb.js";import{C as le}from"./clock-BJTe46H9.js";import{_ as he,a as _e,b as q,c as V}from"./TabsContent.vue_vue_type_script_setup_true_lang-4t9VYY79.js";import{R as ye}from"./refresh-cw-D5_ME20R.js";import"./index-B4X1KNOo.js";import"./utils-CytzSlOG.js";/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=z("FlagIcon",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=z("MailIcon",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=z("PlayIcon",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=z("ShieldXIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]),Ce=ce("shield",()=>{const _=I([]),d=I(null),h=C(()=>_.value.find(p=>p.id===d.value)??null);function k(p){_.value=[p,..._.value.filter(y=>y.id!==p.id)].slice(0,50),d.value=p.id}function x(p){const y=_.value.findIndex(f=>f.id===p.id);y!==-1?_.value[y]=p:k(p)}function v(){_.value=[],d.value=null}return{recentScans:_,currentScanId:d,currentScan:h,addScan:k,updateScan:x,$reset:v}});function Pe(){const _=I(null),d=I([]),h=I(!1),k=I(!1),x=I(null);let v=null;const p=Ce();function y(){v!==null&&(clearInterval(v),v=null)}async function f(r,a,t){h.value=!0,k.value=!0,x.value=null;try{const b=(await B.startShieldScan(r,a,t)).data.scan;return _.value=b,p.addScan(b),c(b.id),b}catch(m){const b=m instanceof Error?m.message:"Failed to start scan";return x.value=b,k.value=!1,null}finally{h.value=!1}}async function u(r){h.value=!0,x.value=null;try{const t=(await B.getShieldScan(r)).data.scan;return _.value=t,p.updateScan(t),t}catch(a){const t=a instanceof Error?a.message:"Failed to fetch scan";return x.value=t,null}finally{h.value=!1}}async function s(r){h.value=!0,x.value=null;try{const t=(await B.getShieldFindings(r)).data;return d.value=t.findings,t.findings}catch(a){const t=a instanceof Error?a.message:"Failed to fetch findings";return x.value=t,[]}finally{h.value=!1}}function c(r){y(),v=setInterval(async()=>{try{const t=(await B.getShieldScan(r)).data.scan;_.value=t,p.updateScan(t),(t.status==="completed"||t.status==="failed")&&(y(),k.value=!1,t.status==="completed"&&(d.value=t.findings??[],d.value.length===0&&await s(r)))}catch{}},2e3)}return ue(()=>{y()}),{currentScan:_,findings:d,loading:h,scanning:k,error:x,startScan:f,fetchScan:u,fetchFindings:s,pollScan:c,stopPolling:y}}const Me={class:"glass-card rounded-xl p-5"},Ae=["disabled"],Te={class:"flex gap-2"},De=["disabled","onClick"],Ie={class:"font-medium"},Fe={class:"mt-0.5 text-xs opacity-60"},Le=["disabled"],Ne=E({__name:"ScanForm",props:{scanning:{type:Boolean}},emits:["scan"],setup(_,{emit:d}){const h=_,k=d,x=I(""),v=I("standard"),p=[{value:"quick",label:"Quick",desc:"~30s"},{value:"standard",label:"Standard",desc:"~2min"},{value:"deep",label:"Deep",desc:"~5min"}];function y(){const f=x.value.trim();f&&k("scan",f,v.value)}return(f,u)=>(n(),l("div",Me,[e("form",{onSubmit:pe(y,["prevent"]),class:"space-y-4"},[e("div",null,[u[1]||(u[1]=e("label",{class:"mb-1.5 block text-sm font-medium text-slate-300"}," Target ",-1)),me(e("input",{"onUpdate:modelValue":u[0]||(u[0]=s=>x.value=s),type:"text",placeholder:"example.com or 192.168.1.0/24",disabled:h.scanning,class:"w-full rounded-lg border border-[var(--border-glass)] bg-white/5 px-4 py-2.5 text-sm text-white placeholder-slate-500 outline-none transition-colors focus:border-cyan-500/50 focus:bg-white/10 disabled:opacity-50"},null,8,Ae),[[xe,x.value]])]),e("div",null,[u[2]||(u[2]=e("label",{class:"mb-1.5 block text-sm font-medium text-slate-300"}," Scan Depth ",-1)),e("div",Te,[(n(),l(F,null,N(p,s=>e("button",{key:s.value,type:"button",disabled:h.scanning,onClick:c=>v.value=s.value,class:M(["flex-1 rounded-lg border px-3 py-2 text-center text-sm transition-all",v.value===s.value?"border-cyan-500/50 bg-cyan-500/10 text-cyan-400":"border-[var(--border-glass)] bg-white/5 text-slate-400 hover:bg-white/10 hover:text-slate-300",h.scanning?"opacity-50 cursor-not-allowed":"cursor-pointer"])},[e("div",Ie,i(s.label),1),e("div",Fe,i(s.desc),1)],10,De)),64))])]),e("button",{type:"submit",disabled:!x.value.trim()||h.scanning,class:M(["flex w-full items-center justify-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium transition-all",!x.value.trim()||h.scanning?"cursor-not-allowed bg-white/5 text-slate-500":"bg-cyan-500/20 text-cyan-400 hover:bg-cyan-500/30"])},[h.scanning?(n(),T(o(Q),{key:0,class:"h-4 w-4 animate-spin"})):(n(),T(o(X),{key:1,class:"h-4 w-4"})),P(" "+i(h.scanning?"Scanning...":"Start Scan"),1)],10,Le)],32)]))}}),Ee={class:"flex flex-col items-center justify-center"},Re={key:1,class:"relative h-48 w-48"},je={class:"relative h-48 w-48"},He={viewBox:"0 0 160 160",class:"h-full w-full -rotate-90"},Oe=["stroke","stroke-dashoffset"],Be={class:"absolute inset-0 flex flex-col items-center justify-center"},qe=E({__name:"ShieldScore",props:{score:{},grade:{},loading:{type:Boolean}},setup(_){const d=_,h=I(!1),k=I(0);let x=null;fe(()=>{requestAnimationFrame(()=>{h.value=!0,v(d.score??0)})}),ge(()=>d.score,s=>{s!==null&&v(s)});function v(s){x&&cancelAnimationFrame(x);const c=k.value,r=s-c,a=1e3,t=performance.now();function m(b){const A=b-t,D=Math.min(A/a,1),O=1-Math.pow(1-D,3);k.value=Math.round(c+r*O),D<1&&(x=requestAnimationFrame(m))}x=requestAnimationFrame(m)}const p=2*Math.PI*70,y=C(()=>{const s=h.value?(d.score??0)/100:0;return p*(1-s)}),f=C(()=>{const s=d.score??0;return s>=90?{stroke:"#34d399",text:"text-emerald-400"}:s>=70?{stroke:"#22d3ee",text:"text-cyan-400"}:s>=50?{stroke:"#fbbf24",text:"text-amber-400"}:{stroke:"#fb7185",text:"text-rose-400"}}),u=C(()=>{const s=d.grade;if(!s)return null;switch(s){case"A+":return{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30"};case"A":case"B+":return{bg:"bg-cyan-500/20",text:"text-cyan-400",border:"border-cyan-500/30"};case"B":case"C+":return{bg:"bg-amber-500/20",text:"text-amber-400",border:"border-amber-500/30"};case"C":case"D":case"F":return{bg:"bg-rose-500/20",text:"text-rose-400",border:"border-rose-500/30"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",border:"border-slate-500/30"}}});return(s,c)=>(n(),l("div",Ee,[_.loading?(n(),l(F,{key:0},[c[0]||(c[0]=e("div",{class:"relative h-48 w-48"},[e("div",{class:"absolute inset-0 animate-pulse rounded-full bg-white/5"})],-1)),c[1]||(c[1]=e("div",{class:"mt-3 h-6 w-16 animate-pulse rounded bg-white/5"},null,-1))],64)):_.score===null?(n(),l("div",Re,[...c[2]||(c[2]=[e("svg",{viewBox:"0 0 160 160",class:"h-full w-full -rotate-90"},[e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"rgba(255, 255, 255, 0.05)","stroke-width":"10"})],-1),e("div",{class:"absolute inset-0 flex flex-col items-center justify-center"},[e("span",{class:"text-sm text-slate-500"},"No scan yet")],-1)])])):(n(),l(F,{key:2},[e("div",je,[(n(),l("svg",He,[c[3]||(c[3]=e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"rgba(255, 255, 255, 0.05)","stroke-width":"10"},null,-1)),e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:f.value.stroke,"stroke-width":"10","stroke-linecap":"round","stroke-dasharray":p,"stroke-dashoffset":y.value,class:"transition-[stroke-dashoffset] duration-1000 ease-out"},null,8,Oe)])),e("div",Be,[e("span",{class:M(["text-4xl font-bold tabular-nums",f.value.text])},i(k.value),3),c[4]||(c[4]=e("span",{class:"text-xs text-slate-500"},"/ 100",-1))])]),u.value?(n(),l("div",{key:0,class:M(["mt-3 rounded-lg border px-4 py-1 text-lg font-bold",u.value.bg,u.value.text,u.value.border])},i(_.grade),3)):w("",!0),c[5]||(c[5]=e("p",{class:"mt-2 text-sm text-slate-500"},"Shield Score",-1))],64))]))}}),Ve={key:0,class:"glass-card rounded-xl p-6 text-center"},Ue={key:1,class:"grid grid-cols-2 gap-3 sm:grid-cols-3 lg:grid-cols-4"},ze={class:"mb-2 flex items-center justify-between"},Ke={class:"text-sm font-medium text-slate-300"},Xe={class:"mb-2 h-1.5 w-full overflow-hidden rounded-full bg-white/5"},Ge={class:"flex items-center justify-between text-xs text-slate-500"},Qe={key:0,class:"text-rose-400"},We=E({__name:"ModuleScoreCards",props:{scores:{}},setup(_){const d=_,h={tls:"TLS",ports:"Ports",cve:"CVE",headers:"Headers",dns:"DNS",creds:"Creds",owasp:"OWASP"},k=C(()=>Object.entries(d.scores).map(([v,p])=>({key:v,label:h[v]??v.toUpperCase(),...p})));function x(v){return v>=80?{bar:"bg-emerald-400",text:"text-emerald-400"}:v>=60?{bar:"bg-amber-400",text:"text-amber-400"}:{bar:"bg-rose-400",text:"text-rose-400"}}return(v,p)=>k.value.length===0?(n(),l("div",Ve,[...p[0]||(p[0]=[e("p",{class:"text-sm text-slate-500"},"No module scores available",-1)])])):(n(),l("div",Ue,[(n(!0),l(F,null,N(k.value,y=>(n(),l("div",{key:y.key,class:"glass-card rounded-lg p-4"},[e("div",ze,[e("span",Ke,i(y.label),1),e("span",{class:M(["text-sm font-bold tabular-nums",x(y.score).text])},i(y.score),3)]),e("div",Xe,[e("div",{class:M(["h-full rounded-full transition-all duration-700",x(y.score).bar]),style:oe({width:`${y.score}%`})},null,6)]),e("div",Ge,[e("span",null,i(y.passed_checks)+"/"+i(y.total_checks)+" checks",1),y.findings_count>0?(n(),l("span",Qe,i(y.findings_count)+" finding"+i(y.findings_count!==1?"s":""),1)):w("",!0)])]))),128))]))}}),Je={key:0,class:"glass-card rounded-xl p-8 text-center"},Ye={key:1,class:"glass-card overflow-hidden rounded-xl"},Ze={class:"border-b border-[var(--border-glass)] px-4 py-3"},et={class:"text-sm font-medium text-white"},tt={class:"ml-1 text-slate-500"},st=["onClick"],nt={class:"flex items-center gap-1.5 truncate text-slate-300"},at={class:"text-xs text-slate-500"},lt={class:"truncate font-mono text-xs text-slate-400"},ot={key:0,class:"font-mono text-xs text-cyan-400"},rt={key:1,class:"text-xs text-slate-600"},it={key:0,class:"border-t border-[var(--border-glass)] bg-white/[0.02] px-6 py-4"},dt={class:"space-y-3 text-sm"},ct={class:"text-slate-300"},ut={class:"text-slate-300"},mt={class:"flex flex-wrap gap-4 text-xs"},xt={key:0},pt={class:"ml-1 font-mono font-semibold text-white"},ft={key:1},gt={class:"ml-1 font-mono text-slate-300"},vt={key:2},bt={key:3},ht={class:"ml-1 text-slate-300"},_t={key:4},yt={class:"ml-1 text-slate-300"},wt=["href"],kt={key:0},$t={class:"overflow-x-auto rounded-lg bg-black/30 p-3 font-mono text-xs text-slate-400"},St=E({__name:"FindingsList",props:{findings:{}},setup(_){const d=_,h=I(null),k={critical:0,high:1,medium:2,low:3,info:4},x=C(()=>[...d.findings].sort((f,u)=>(k[f.severity]??5)-(k[u.severity]??5)));function v(f){h.value=h.value===f?null:f}function p(f){switch(f){case"critical":return{bg:"bg-rose-500/20",text:"text-rose-400",label:"CRITICAL"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"HIGH"};case"medium":return{bg:"bg-amber-500/20",text:"text-amber-400",label:"MEDIUM"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"LOW"};case"info":return{bg:"bg-slate-500/20",text:"text-slate-400",label:"INFO"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",label:f}}}function y(f){return f.target_port?`${f.target_ip}:${f.target_port}`:f.target_ip}return(f,u)=>_.findings.length===0?(n(),l("div",Je,[$(o(R),{class:"mx-auto h-10 w-10 text-emerald-400"}),u[0]||(u[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No findings",-1)),u[1]||(u[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"Your target looks secure!",-1))])):(n(),l("div",Ye,[e("div",Ze,[e("h3",et,[u[2]||(u[2]=P(" Findings ",-1)),e("span",tt,"("+i(_.findings.length)+")",1)])]),u[12]||(u[12]=e("div",{class:"grid grid-cols-[100px_1fr_80px_140px_100px] gap-2 border-b border-[var(--border-glass)] px-4 py-2 text-xs font-medium text-slate-500"},[e("span",null,"Severity"),e("span",null,"Title"),e("span",null,"Module"),e("span",null,"Target"),e("span",null,"CVE")],-1)),(n(!0),l(F,null,N(x.value,s=>(n(),l("div",{key:s.id,class:"border-b border-[var(--border-glass)] last:border-0"},[e("button",{class:"grid w-full grid-cols-[100px_1fr_80px_140px_100px] items-center gap-2 px-4 py-3 text-left text-sm transition-colors hover:bg-white/5",onClick:c=>v(s.id)},[e("span",{class:M(["inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-semibold",p(s.severity).bg,p(s.severity).text])},i(p(s.severity).label),3),e("span",nt,[(n(),T(j(h.value===s.id?o(re):o(ie)),{class:"h-3.5 w-3.5 shrink-0 text-slate-500"})),P(" "+i(s.title),1)]),e("span",at,i(s.module),1),e("span",lt,i(y(s)),1),s.cve_id?(n(),l("span",ot,i(s.cve_id),1)):(n(),l("span",rt,"--"))],8,st),h.value===s.id?(n(),l("div",it,[e("div",dt,[e("div",null,[u[3]||(u[3]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Description",-1)),e("p",ct,i(s.description),1)]),e("div",null,[u[4]||(u[4]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Remediation",-1)),e("p",ut,i(s.remediation),1)]),e("div",mt,[s.cvss_score!==null?(n(),l("div",xt,[u[5]||(u[5]=e("span",{class:"text-slate-500"},"CVSS:",-1)),e("span",pt,i(s.cvss_score),1)])):w("",!0),s.epss_score!==null?(n(),l("div",ft,[u[6]||(u[6]=e("span",{class:"text-slate-500"},"EPSS:",-1)),e("span",gt,i((s.epss_score*100).toFixed(1))+"% ",1)])):w("",!0),s.cisa_kev?(n(),l("div",vt,[...u[7]||(u[7]=[e("span",{class:"rounded bg-rose-500/20 px-1.5 py-0.5 font-semibold text-rose-400"}," CISA KEV ",-1)])])):w("",!0),s.attack_technique?(n(),l("div",bt,[u[8]||(u[8]=e("span",{class:"text-slate-500"},"Technique:",-1)),e("span",ht,i(s.attack_technique),1)])):w("",!0),s.attack_tactic?(n(),l("div",_t,[u[9]||(u[9]=e("span",{class:"text-slate-500"},"Tactic:",-1)),e("span",yt,i(s.attack_tactic),1)])):w("",!0),s.cve_id?(n(),l("a",{key:5,href:`https://nvd.nist.gov/vuln/detail/${s.cve_id}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center gap-1 text-cyan-400 hover:text-cyan-300"},[u[10]||(u[10]=P(" NVD ",-1)),$(o(ve),{class:"h-3 w-3"})],8,wt)):w("",!0)]),s.evidence&&Object.keys(s.evidence).length>0?(n(),l("div",kt,[u[11]||(u[11]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Evidence",-1)),e("pre",$t,i(JSON.stringify(s.evidence,null,2)),1)])):w("",!0)])])):w("",!0)]))),128))]))}}),Ct={key:0,class:"glass-card rounded-xl p-8 text-center"},Pt={key:1,class:"glass-card rounded-xl p-5"},Mt={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},At={class:"mb-4 flex items-center gap-4 text-sm"},Tt={class:"text-slate-400"},Dt={class:"font-mono font-semibold text-white"},It={key:0,class:"flex items-center gap-1 text-rose-400"},Ft={class:"font-mono font-semibold"},Lt={key:1,class:"flex items-center gap-1 text-emerald-400"},Nt={class:"grid gap-5 lg:grid-cols-2"},Et={class:"flex flex-wrap gap-2"},Rt={class:"font-mono font-bold"},jt={class:"opacity-75"},Ht={key:0},Ot={class:"space-y-2"},Bt={class:"flex items-start gap-2"},qt={class:"min-w-0"},Vt={class:"flex items-center gap-2"},Ut={class:"font-mono text-sm font-bold text-rose-400"},zt={class:"text-xs text-slate-400"},Kt={key:0,class:"mt-1 text-xs text-slate-400"},Xt={key:1,class:"mt-1 text-xs text-slate-500"},Gt={key:1,class:"flex items-center justify-center rounded-lg border border-emerald-500/10 bg-emerald-500/5 p-6"},Qt={class:"text-center"},Wt=E({__name:"PortScanResults",props:{findings:{}},setup(_){const d=_,h=new Set([80,443]),k=new Set([21,23,135,139,445,1433,1521,3306,3389,5432,5900,6379,8443,27017]),x=new Set([22,25,53,110,143,587,993,995,8080,8443]),v={21:"FTP",22:"SSH",23:"Telnet",25:"SMTP",53:"DNS",80:"HTTP",110:"POP3",135:"MSRPC",139:"NetBIOS",143:"IMAP",443:"HTTPS",445:"SMB",587:"Submission",993:"IMAPS",995:"POP3S",1433:"MSSQL",1521:"Oracle",3306:"MySQL",3389:"RDP",5432:"PostgreSQL",5900:"VNC",6379:"Redis",8080:"HTTP-Alt",8443:"HTTPS-Alt",27017:"MongoDB"};function p(r){return k.has(r)?"dangerous":h.has(r)?"safe":(x.has(r),"common")}const y=C(()=>{var t;const r=[],a=new Set;for(const m of d.findings){const b=m.target_port;if(b!==null&&!a.has(b)){a.add(b);const A=(t=m.evidence)==null?void 0:t.service;r.push({port:b,service:A||v[b]||"Unknown",risk:p(b),finding:m})}}return r.sort((m,b)=>m.port-b.port)}),f=C(()=>y.value.filter(r=>r.risk==="dangerous")),u=C(()=>y.value.length),s=C(()=>f.value.length);function c(r){switch(r){case"safe":return"border-emerald-500/30 bg-emerald-500/10 text-emerald-400";case"common":return"border-amber-500/30 bg-amber-500/10 text-amber-400";case"dangerous":return"border-rose-500/30 bg-rose-500/10 text-rose-400"}}return(r,a)=>_.findings.length===0?(n(),l("div",Ct,[$(o(R),{class:"mx-auto h-10 w-10 text-emerald-400"}),a[0]||(a[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No port findings",-1)),a[1]||(a[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"No open ports detected or port scan was not run.",-1))])):(n(),l("div",Pt,[e("h3",Mt,[$(o(de),{class:"h-4 w-4 text-cyan-400"}),a[2]||(a[2]=P(" Port Scan Results ",-1))]),e("div",At,[e("span",Tt,[e("span",Dt,i(u.value),1),P(" port"+i(u.value!==1?"s":"")+" open ",1)]),s.value>0?(n(),l("span",It,[$(o(G),{class:"h-3.5 w-3.5"}),e("span",Ft,i(s.value),1),a[3]||(a[3]=P(" dangerous ",-1))])):(n(),l("span",Lt,[$(o(R),{class:"h-3.5 w-3.5"}),a[4]||(a[4]=P(" No dangerous ports ",-1))]))]),e("div",Nt,[e("div",null,[a[5]||(a[5]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Open Ports",-1)),e("div",Et,[(n(!0),l(F,null,N(y.value,t=>(n(),l("div",{key:t.port,class:M(["inline-flex items-center gap-1.5 rounded-md border px-2.5 py-1 text-xs font-medium",c(t.risk)])},[e("span",Rt,i(t.port),1),e("span",jt,i(t.service),1)],2))),128))])]),f.value.length>0?(n(),l("div",Ht,[a[6]||(a[6]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Dangerous Ports",-1)),e("div",Ot,[(n(!0),l(F,null,N(f.value,t=>{var m;return n(),l("div",{key:t.port,class:"rounded-lg border border-rose-500/20 bg-rose-500/5 p-3"},[e("div",Bt,[$(o(K),{class:"mt-0.5 h-4 w-4 shrink-0 text-rose-400"}),e("div",qt,[e("div",Vt,[e("span",Ut," Port "+i(t.port),1),e("span",zt,i(t.service),1)]),t.finding?(n(),l("p",Kt,i(t.finding.description),1)):w("",!0),(m=t.finding)!=null&&m.remediation?(n(),l("p",Xt,i(t.finding.remediation),1)):w("",!0)])])])}),128))])])):(n(),l("div",Gt,[e("div",Qt,[$(o(R),{class:"mx-auto h-8 w-8 text-emerald-400"}),a[7]||(a[7]=e("p",{class:"mt-2 text-sm text-emerald-400"},"No dangerous ports detected",-1))])]))])]))}}),Jt={key:0,class:"glass-card rounded-xl p-8 text-center"},Yt={key:1,class:"glass-card rounded-xl p-5"},Zt={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},es={class:"mb-4 text-sm text-slate-400"},ts={class:"font-mono font-semibold text-white"},ss={class:"divide-y divide-[var(--border-glass)]"},ns=["onClick"],as={key:0,class:"border-t border-[var(--border-glass)] bg-white/[0.02] px-4 py-3"},ls={class:"space-y-2 text-sm"},os={class:"text-slate-300"},rs={class:"text-slate-300"},is=E({__name:"HeadersChecklist",props:{findings:{}},setup(_){const d=_,h=[{name:"Strict-Transport-Security (HSTS)",key:"strict-transport-security"},{name:"Content-Security-Policy (CSP)",key:"content-security-policy"},{name:"X-Frame-Options",key:"x-frame-options"},{name:"X-Content-Type-Options",key:"x-content-type-options"},{name:"Referrer-Policy",key:"referrer-policy"},{name:"Permissions-Policy",key:"permissions-policy"},{name:"Server",key:"server"},{name:"X-Powered-By",key:"x-powered-by"}],k=new Set(["server","x-powered-by"]),x=I(null);function v(c){x.value=x.value===c?null:c}const p=C(()=>h.map(c=>{const r=d.findings.find(b=>{const A=b.title.toLowerCase(),D=c.key.toLowerCase();return A.includes(D)||A.includes(c.name.toLowerCase().split(" (")[0]??"")});if(!r)return{name:c.name,key:c.key,status:"present",severity:null,finding:null};const a=k.has(c.key),t=r.title.toLowerCase(),m=a&&(t.includes("leak")||t.includes("exposed")||t.includes("server header"));return{name:c.name,key:c.key,status:m?"info_leak":"missing",severity:r.severity,finding:r}})),y=C(()=>p.value.filter(c=>c.status==="present").length),f=C(()=>p.value.length);function u(c){switch(c){case"present":return{icon:R,text:"text-emerald-400",label:"Present"};case"missing":return{icon:H,text:"text-rose-400",label:"Missing"};case"info_leak":return{icon:G,text:"text-amber-400",label:"Info Leak"}}}function s(c){switch(c){case"critical":return{bg:"bg-rose-500/20",text:"text-rose-400",label:"CRITICAL"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"HIGH"};case"medium":return{bg:"bg-amber-500/20",text:"text-amber-400",label:"MEDIUM"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"LOW"};case"info":return{bg:"bg-slate-500/20",text:"text-slate-400",label:"INFO"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",label:c}}}return(c,r)=>_.findings.length===0&&p.value.every(a=>a.status==="present")?(n(),l("div",Jt,[$(o(U),{class:"mx-auto h-10 w-10 text-emerald-400"}),r[0]||(r[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"All headers present",-1)),r[1]||(r[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"All recommended security headers are configured correctly.",-1))])):(n(),l("div",Yt,[e("h3",Zt,[$(o(U),{class:"h-4 w-4 text-cyan-400"}),r[2]||(r[2]=P(" Security Headers Checklist ",-1))]),e("div",es,[e("span",ts,i(y.value),1),P(" / "+i(f.value)+" headers configured ",1)]),e("div",ss,[(n(!0),l(F,null,N(p.value,a=>(n(),l("div",{key:a.key},[e("button",{class:M(["flex w-full items-center gap-3 px-2 py-3 text-left text-sm transition-colors hover:bg-white/5",{"cursor-default":!a.finding}]),onClick:t=>a.finding?v(a.key):void 0},[(n(),T(j(u(a.status).icon),{class:M(["h-4 w-4 shrink-0",u(a.status).text])},null,8,["class"])),e("span",{class:M(["flex-1 font-mono text-xs",a.status==="present"?"text-emerald-400":a.status==="info_leak"?"text-amber-400":"text-rose-400"])},i(a.name),3),e("span",{class:M(["text-xs",u(a.status).text])},i(u(a.status).label),3),a.severity?(n(),l("span",{key:0,class:M(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold",s(a.severity).bg,s(a.severity).text])},i(s(a.severity).label),3)):w("",!0),a.finding?(n(),T(j(x.value===a.key?o(re):o(ie)),{key:1,class:"h-3.5 w-3.5 shrink-0 text-slate-500"})):w("",!0)],10,ns),a.finding&&x.value===a.key?(n(),l("div",as,[e("div",ls,[e("div",null,[r[3]||(r[3]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Description",-1)),e("p",os,i(a.finding.description),1)]),e("div",null,[r[4]||(r[4]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Remediation",-1)),e("p",rs,i(a.finding.remediation),1)])])])):w("",!0)]))),128))])]))}}),ds={key:0,class:"glass-card rounded-xl p-8 text-center"},cs={key:1,class:"glass-card rounded-xl p-5"},us={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},ms={class:"grid gap-5 lg:grid-cols-2"},xs={class:"mb-3 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},ps={class:"space-y-2"},fs={class:"min-w-0 flex-1"},gs={class:"text-sm font-medium text-white"},vs={class:"truncate text-xs text-slate-500"},bs={class:"mt-3"},hs={class:"text-xs text-slate-500"},_s={class:"mb-3 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},ys={class:"flex items-center gap-3 rounded-lg border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2.5"},ws={class:"min-w-0 flex-1"},ks={class:"truncate text-xs text-slate-500"},$s={class:"mt-4"},Ss={class:"rounded-lg border border-[var(--border-glass)] bg-white/[0.02] p-4 text-center"},Cs={class:"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-white/5"},Ps={key:0,class:"mt-4"},Ms={class:"space-y-1.5"},As={class:"text-slate-300"},Ts={class:"mt-0.5 text-slate-500"},Ds=E({__name:"DnsSecurityCard",props:{findings:{}},setup(_){const d=_;function h(t){return d.findings.find(m=>m.title.toLowerCase().includes(t.toLowerCase()))??null}const k=C(()=>{const t=h("SPF");return t?{name:"SPF",key:"spf",status:t.severity==="info"?"pass":"fail",detail:t.title,finding:t}:{name:"SPF",key:"spf",status:"pass",detail:"SPF record configured",finding:null}}),x=C(()=>{const t=h("DKIM");return t?{name:"DKIM",key:"dkim",status:t.severity==="info"?"pass":t.severity==="low"?"warn":"fail",detail:t.title,finding:t}:{name:"DKIM",key:"dkim",status:"pass",detail:"DKIM record configured",finding:null}}),v=C(()=>{var A;const t=h("DMARC");if(!t)return{name:"DMARC",key:"dmarc",status:"pass",detail:"DMARC policy active",finding:null};const m=((A=t.evidence)==null?void 0:A.policy)??"";return{name:"DMARC",key:"dmarc",status:m==="none"?"fail":m==="quarantine"?"warn":"fail",detail:t.title,finding:t}}),p=C(()=>{const t=h("CAA");return t?{name:"CAA",key:"caa",status:t.severity==="low"?"warn":"fail",detail:t.title,finding:t}:{name:"CAA",key:"caa",status:"pass",detail:"CAA record present",finding:null}}),y=C(()=>[k.value,x.value,v.value,p.value]),f=C(()=>{var m;const t=v.value.finding;return t?((m=t.evidence)==null?void 0:m.policy)??"none":"reject"});function u(t){switch(t){case"reject":return{icon:U,color:"text-emerald-400",bg:"bg-emerald-500/10",border:"border-emerald-500/20",label:"Reject"};case"quarantine":return{icon:K,color:"text-amber-400",bg:"bg-amber-500/10",border:"border-amber-500/20",label:"Quarantine"};default:return{icon:Se,color:"text-rose-400",bg:"bg-rose-500/10",border:"border-rose-500/20",label:"None"}}}const s=C(()=>{let t=0;return k.value.status==="pass"&&(t+=30),x.value.status==="pass"?t+=30:x.value.status==="warn"&&(t+=15),v.value.status==="pass"?t+=30:v.value.status==="warn"&&(t+=15),p.value.status==="pass"?t+=10:p.value.status==="warn"&&(t+=5),t});function c(t){switch(t){case"pass":return R;case"warn":return K;case"fail":return H}}function r(t){switch(t){case"pass":return"text-emerald-400";case"warn":return"text-amber-400";case"fail":return"text-rose-400"}}function a(t){return t>=80?"text-emerald-400":t>=50?"text-amber-400":"text-rose-400"}return(t,m)=>_.findings.length===0&&y.value.every(b=>b.status==="pass")?(n(),l("div",ds,[$(o(U),{class:"mx-auto h-10 w-10 text-emerald-400"}),m[0]||(m[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"DNS security configured",-1)),m[1]||(m[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"All DNS security records are properly configured.",-1))])):(n(),l("div",cs,[e("h3",us,[$(o(be),{class:"h-4 w-4 text-cyan-400"}),m[2]||(m[2]=P(" DNS Security ",-1))]),e("div",ms,[e("div",null,[e("h4",xs,[$(o(ke),{class:"h-3.5 w-3.5"}),m[3]||(m[3]=P(" Email Authentication ",-1))]),e("div",ps,[(n(!0),l(F,null,N([k.value,x.value,v.value],b=>(n(),l("div",{key:b.key,class:"flex items-center gap-3 rounded-lg border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2.5"},[(n(),T(j(c(b.status)),{class:M(["h-4 w-4 shrink-0",r(b.status)])},null,8,["class"])),e("div",fs,[e("span",gs,i(b.name),1),e("p",vs,i(b.detail),1)])]))),128))]),e("div",bs,[m[4]||(m[4]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"DMARC Policy",-1)),e("div",{class:M(["flex items-center gap-2 rounded-lg border p-3",u(f.value).bg,u(f.value).border])},[(n(),T(j(u(f.value).icon),{class:M(["h-5 w-5",u(f.value).color])},null,8,["class"])),e("div",null,[e("span",{class:M(["text-sm font-semibold",u(f.value).color])}," p="+i(f.value),3),e("p",hs,i(f.value==="reject"?"Unauthorized emails are rejected":f.value==="quarantine"?"Unauthorized emails are quarantined":"No enforcement - emails pass through"),1)])],2)])]),e("div",null,[e("h4",_s,[$(o(X),{class:"h-3.5 w-3.5"}),m[5]||(m[5]=P(" Certificate Authority ",-1))]),e("div",ys,[(n(),T(j(c(p.value.status)),{class:M(["h-4 w-4 shrink-0",r(p.value.status)])},null,8,["class"])),e("div",ws,[m[6]||(m[6]=e("span",{class:"text-sm font-medium text-white"},"CAA Record",-1)),e("p",ks,i(p.value.detail),1)])]),e("div",$s,[m[8]||(m[8]=e("h4",{class:"mb-3 text-xs font-medium uppercase text-slate-500"},"Email Security Score",-1)),e("div",Ss,[e("span",{class:M(["text-3xl font-bold tabular-nums",a(s.value)])},i(s.value),3),m[7]||(m[7]=e("span",{class:"text-sm text-slate-500"}," / 100",-1)),e("div",Cs,[e("div",{class:M(["h-full rounded-full transition-all duration-700",s.value>=80?"bg-emerald-400":s.value>=50?"bg-amber-400":"bg-rose-400"]),style:oe({width:`${s.value}%`})},null,6)])])]),_.findings.length>0?(n(),l("div",Ps,[m[9]||(m[9]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Issues Found",-1)),e("div",Ms,[(n(!0),l(F,null,N(_.findings,b=>(n(),l("div",{key:b.id,class:"rounded border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs"},[e("span",As,i(b.title),1),e("p",Ts,i(b.remediation),1)]))),128))])])):w("",!0)])])]))}}),Is={class:"glass-card rounded-xl p-5"},Fs={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},Ls={class:"relative ml-3"},Ns={class:"min-w-0 flex-1 -mt-0.5"},Es={class:"flex items-center gap-2"},Rs={key:0,class:"rounded bg-white/5 px-1.5 py-0.5 font-mono text-xs text-slate-500"},js={key:0,class:"mt-0.5 block font-mono text-xs text-slate-600"},Hs=E({__name:"ShieldTimeline",props:{scan:{}},setup(_){const d=_,h={tls:"TLS / SSL Check",ports:"Port Scan",headers:"HTTP Headers",dns:"DNS Security",cve:"CVE Matching",creds:"Credential Testing",owasp:"OWASP Probes"};function k(s){return s?new Date(s).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--"}function x(s,c,r){return!r||r<=0?null:`${(r/c).toFixed(1)}s`}const v=C(()=>{const s=[],c=d.scan;s.push({key:"created",label:"Scan created",timestamp:c.created_at,status:"completed",duration:null,type:"start"});const r=c.modules_enabled,a=c.status==="completed",t=c.status==="failed",m=c.status==="running";return r.forEach((b,A)=>{let D="pending";a?D="completed":t?A===r.length-1?D="failed":D="completed":m&&(D=A===0?"running":"pending"),s.push({key:`module-${b}`,label:h[b]??b.toUpperCase(),timestamp:a||D==="completed"?c.started_at:null,status:D,duration:a?x(A,r.length,c.duration_seconds):null,type:"module"})}),a?s.push({key:"completed",label:"Scan completed",timestamp:c.completed_at,status:"completed",duration:c.duration_seconds?`${c.duration_seconds}s total`:null,type:"end"}):t?s.push({key:"failed",label:"Scan failed",timestamp:c.completed_at,status:"failed",duration:null,type:"end"}):s.push({key:"pending",label:"Awaiting completion",timestamp:null,status:"pending",duration:null,type:"end"}),s});function p(s){if(s.type==="start")return $e;if(s.type==="end")return we;switch(s.status){case"completed":return R;case"running":return Q;case"failed":return H;default:return le}}function y(s){switch(s.status){case"completed":return"text-cyan-400";case"running":return"text-cyan-400 animate-spin";case"failed":return"text-rose-400";default:return"text-slate-600"}}function f(s){switch(s.status){case"completed":return"bg-cyan-500/40";case"running":return"bg-cyan-500/20";case"failed":return"bg-rose-500/40";default:return"bg-slate-700"}}function u(s){return s.status==="completed"?"shadow-[0_0_6px_rgba(34,211,238,0.4)]":s.status==="running"?"shadow-[0_0_8px_rgba(34,211,238,0.6)]":""}return(s,c)=>(n(),l("div",Is,[e("h3",Fs,[$(o(le),{class:"h-4 w-4 text-cyan-400"}),c[0]||(c[0]=P(" Scan Timeline ",-1))]),e("div",Ls,[(n(!0),l(F,null,N(v.value,(r,a)=>(n(),l("div",{key:r.key,class:"relative flex gap-4 pb-6 last:pb-0"},[a<v.value.length-1?(n(),l("div",{key:0,class:M(["absolute left-[7px] top-5 w-0.5",f(v.value[a+1]??r)]),style:{height:"calc(100% - 8px)"}},null,2)):w("",!0),e("div",{class:M(["relative z-10 flex h-4 w-4 shrink-0 items-center justify-center rounded-full",u(r)])},[(n(),T(j(p(r)),{class:M(["h-4 w-4",y(r)])},null,8,["class"]))],2),e("div",Ns,[e("div",Es,[e("span",{class:M(["text-sm font-medium",r.status==="completed"?"text-white":r.status==="running"?"text-cyan-400":r.status==="failed"?"text-rose-400":"text-slate-500"])},i(r.label),3),r.duration?(n(),l("span",Rs,i(r.duration),1)):w("",!0)]),r.timestamp?(n(),l("span",js,i(k(r.timestamp)),1)):w("",!0)])]))),128))])]))}}),Os={class:"space-y-6"},Bs={class:"flex items-center justify-between"},qs=["disabled"],Vs={key:0,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},Us={class:"mt-2 text-sm text-slate-400"},zs={key:1,class:"flex flex-col items-center justify-center py-20"},Ks={key:2,class:"glass-card rounded-xl p-8 text-center"},Xs={class:"mt-3 text-sm text-slate-300"},Gs={class:"mx-auto mt-4 flex max-w-xs items-center gap-3"},Qs={class:"text-xs text-slate-500"},Ws={key:0,class:"mt-3"},Js={class:"text-xs text-slate-500"},Ys={key:3,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},Zs={class:"mt-2 text-sm text-slate-400"},en={class:"flex flex-col gap-6 lg:flex-row"},tn={class:"glass-card flex items-center justify-center rounded-xl p-6 lg:w-72"},sn={class:"min-w-0 flex-1"},nn={class:"mb-3 flex items-center justify-between"},an={class:"flex items-center gap-3 text-xs text-slate-500"},ln={class:"flex items-center gap-1"},on={class:"flex items-center gap-1"},rn={key:1,class:"glass-card rounded-xl p-6 text-center"},dn={key:0,class:"lg:w-64"},cn={class:"glass-card flex flex-wrap items-center gap-4 rounded-lg px-4 py-2.5 text-xs text-slate-500"},un={class:"font-mono text-slate-300"},mn={class:"text-slate-300"},xn={class:"font-mono text-slate-300"},pn={class:"font-mono text-slate-300"},fn={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400"},gn={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400"},vn={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400"},Dn=E({__name:"ShieldView",setup(_){const{currentScan:d,findings:h,loading:k,scanning:x,error:v,startScan:p,fetchScan:y}=Pe();async function f(S,g){await p(S,g)}function u(){var S;(S=d.value)!=null&&S.id&&y(d.value.id)}const s=C(()=>{if(!d.value)return"";switch(d.value.status){case"queued":return"Scan queued, waiting to start...";case"running":return`Scanning ${d.value.target}...`;case"completed":return`Scan completed in ${d.value.duration_seconds??"?"}s`;case"failed":return"Scan failed";default:return""}}),c=C(()=>{var S;return((S=d.value)==null?void 0:S.status)==="completed"}),r=C(()=>{var S;return((S=d.value)==null?void 0:S.status)==="failed"}),a=C(()=>{var S;return((S=d.value)==null?void 0:S.module_scores)&&Object.keys(d.value.module_scores).length>0}),t=C(()=>{var S;return((S=d.value)==null?void 0:S.findings.filter(g=>g.module==="ports"))??[]}),m=C(()=>{var S;return((S=d.value)==null?void 0:S.findings.filter(g=>g.module==="headers"))??[]}),b=C(()=>{var S;return((S=d.value)==null?void 0:S.findings.filter(g=>g.module==="dns"))??[]}),A=C(()=>{var S;return((S=d.value)==null?void 0:S.modules_enabled.includes("ports"))??!1}),D=C(()=>{var S;return((S=d.value)==null?void 0:S.modules_enabled.includes("headers"))??!1}),O=C(()=>{var S;return((S=d.value)==null?void 0:S.modules_enabled.includes("dns"))??!1});return(S,g)=>{var W,J,Y,Z,ee,te,se,ne,ae;return n(),l("div",Os,[e("div",Bs,[g[1]||(g[1]=e("div",null,[e("h1",{class:"text-2xl font-bold text-white"},"Shield - Security Validation"),e("p",{class:"mt-1 text-sm text-slate-400"}," Comprehensive security scanning and vulnerability assessment ")],-1)),e("button",{class:"flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 text-xs text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",disabled:o(k)||o(x),onClick:u},[$(o(ye),{class:M(["h-3.5 w-3.5",{"animate-spin":o(k)}])},null,8,["class"]),g[0]||(g[0]=P(" Refresh ",-1))],8,qs)]),$(Ne,{scanning:o(x),onScan:f},null,8,["scanning"]),o(v)&&!o(d)?(n(),l("div",Vs,[$(o(G),{class:"mx-auto h-10 w-10 text-amber-400"}),g[2]||(g[2]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Unable to Start Scan",-1)),e("p",Us,i(o(v)),1)])):w("",!0),!o(d)&&!o(v)?(n(),l("div",zs,[$(o(X),{class:"h-16 w-16 text-slate-600"}),g[3]||(g[3]=e("h2",{class:"mt-4 text-lg font-medium text-slate-400"},"Enter a target to begin",-1)),g[4]||(g[4]=e("p",{class:"mt-1 text-sm text-slate-500"}," Provide an IP address, domain, or CIDR range to start a security scan ",-1))])):w("",!0),o(d)&&o(x)?(n(),l("div",Ks,[$(o(Q),{class:"mx-auto h-10 w-10 animate-spin text-cyan-400"}),e("p",Xs,i(s.value),1),e("div",Gs,[g[5]||(g[5]=e("div",{class:"h-1.5 flex-1 overflow-hidden rounded-full bg-white/5"},[e("div",{class:"h-full w-1/3 animate-pulse rounded-full bg-cyan-500/50"})],-1)),e("span",Qs,i(o(d).status),1)]),o(d).modules_enabled.length>0?(n(),l("div",Ws,[e("span",Js," Modules: "+i(o(d).modules_enabled.join(", ")),1)])):w("",!0)])):w("",!0),r.value&&!o(x)?(n(),l("div",Ys,[$(o(H),{class:"mx-auto h-10 w-10 text-rose-400"}),g[6]||(g[6]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Scan Failed",-1)),e("p",Zs," The scan for "+i((W=o(d))==null?void 0:W.target)+" could not be completed. ",1)])):w("",!0),c.value&&!o(x)?(n(),l(F,{key:4},[e("div",en,[e("div",tn,[$(qe,{score:((J=o(d))==null?void 0:J.shield_score)??null,grade:((Y=o(d))==null?void 0:Y.grade)??null,loading:o(k)},null,8,["score","grade","loading"])]),e("div",sn,[e("div",nn,[g[7]||(g[7]=e("h2",{class:"text-sm font-medium text-white"},"Module Scores",-1)),e("div",an,[e("span",ln,[$(o(R),{class:"h-3 w-3 text-emerald-400"}),P(" "+i(((Z=o(d))==null?void 0:Z.passed_checks)??0)+" passed ",1)]),e("span",on,[$(o(H),{class:"h-3 w-3 text-rose-400"}),P(" "+i(((ee=o(d))==null?void 0:ee.failed_checks)??0)+" failed ",1)])])]),a.value?(n(),T(We,{key:0,scores:o(d).module_scores},null,8,["scores"])):(n(),l("div",rn,[...g[8]||(g[8]=[e("p",{class:"text-sm text-slate-500"},"No module breakdown available",-1)])]))]),o(d)?(n(),l("div",dn,[$(Hs,{scan:o(d)},null,8,["scan"])])):w("",!0)]),e("div",cn,[e("span",null,[g[9]||(g[9]=P(" Target: ",-1)),e("span",un,i((te=o(d))==null?void 0:te.target),1)]),e("span",null,[g[10]||(g[10]=P(" Depth: ",-1)),e("span",mn,i((se=o(d))==null?void 0:se.scan_depth),1)]),e("span",null,[g[11]||(g[11]=P(" Duration: ",-1)),e("span",xn,i(((ne=o(d))==null?void 0:ne.duration_seconds)??"?")+"s",1)]),e("span",null,[g[12]||(g[12]=P(" Checks: ",-1)),e("span",pn,i((ae=o(d))==null?void 0:ae.total_checks),1)])]),$(o(he),{"default-value":"findings"},{default:L(()=>[$(o(_e),{class:"bg-white/5"},{default:L(()=>[$(o(q),{value:"findings",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[...g[13]||(g[13]=[P(" All Findings ",-1)])]),_:1}),A.value?(n(),T(o(q),{key:0,value:"ports",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[g[14]||(g[14]=P(" Ports ",-1)),t.value.length>0?(n(),l("span",fn,i(t.value.length),1)):w("",!0)]),_:1})):w("",!0),D.value?(n(),T(o(q),{key:1,value:"headers",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[g[15]||(g[15]=P(" Headers ",-1)),m.value.length>0?(n(),l("span",gn,i(m.value.length),1)):w("",!0)]),_:1})):w("",!0),O.value?(n(),T(o(q),{key:2,value:"dns",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[g[16]||(g[16]=P(" DNS ",-1)),b.value.length>0?(n(),l("span",vn,i(b.value.length),1)):w("",!0)]),_:1})):w("",!0)]),_:1}),$(o(V),{value:"findings"},{default:L(()=>[$(St,{findings:o(h)},null,8,["findings"])]),_:1}),A.value?(n(),T(o(V),{key:0,value:"ports"},{default:L(()=>[$(Wt,{findings:t.value},null,8,["findings"])]),_:1})):w("",!0),D.value?(n(),T(o(V),{key:1,value:"headers"},{default:L(()=>[$(is,{findings:m.value},null,8,["findings"])]),_:1})):w("",!0),O.value?(n(),T(o(V),{key:2,value:"dns"},{default:L(()=>[$(Ds,{findings:b.value},null,8,["findings"])]),_:1})):w("",!0)]),_:1})],64)):w("",!0)])}}});export{Dn as default};
//# sourceMappingURL=ShieldView-CcLEvj-A.js.map
