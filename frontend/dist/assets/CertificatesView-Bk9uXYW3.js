import{b as K,L as N,T as A}from"./index-DjDsWVXt.js";import{r as b,d as V,e as _,g as l,y as f,j as s,k as e,z as T,c as p,l as i,H as u,F,p as E,q as U,f as L,o as B,m as R}from"./vendor-B81oEKTZ.js";import{_ as I,a as P,b as S,c as z}from"./TabsContent.vue_vue_type_script_setup_true_lang-4t9VYY79.js";import{_ as q}from"./SearchInput.vue_vue_type_script_setup_true_lang-Cx0a0Zhg.js";import{C as H}from"./clock-MfaW50kv.js";import{C as M}from"./circle-x-VB-EI0Zt.js";import{F as W}from"./fingerprint-sLCJgoI5.js";import{K as X}from"./key-round-Dc-wzDed.js";import{_ as Y,c as G,a as D,b as y,e as J,d as g}from"./TableCell.vue_vue_type_script_setup_true_lang-BqriAm9j.js";import{A as $}from"./arrow-up-down-CZlkt-7m.js";import{R as O}from"./refresh-cw-JHp31cAX.js";import{L as Q}from"./loader-circle-CCDZfC_-.js";import"./index-B4X1KNOo.js";import"./utils-CytzSlOG.js";function Z(){const v=b(null),d=b(!1),c=b(null);async function m(){d.value=!0,c.value=null;try{const n=await K.getCertificates();v.value=n.data}catch(n){const x=n instanceof Error?n.message:"Failed to load certificate data";c.value=x}finally{d.value=!1}}return{data:v,loading:d,error:c,fetchCertificates:m}}const ee={class:"grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-5"},te={class:"glass-card rounded-xl p-5"},se={class:"flex items-start justify-between"},le={class:"flex-1 min-w-0"},ae={class:"mt-2 text-2xl font-bold text-white tabular-nums"},ie={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-cyan-500/10"},ne={class:"glass-card rounded-xl p-5"},re={class:"flex items-start justify-between"},oe={class:"flex-1 min-w-0"},de={class:"mt-2 text-2xl font-bold text-amber-400 tabular-nums"},ue={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-amber-500/10"},ce={class:"glass-card rounded-xl p-5"},fe={class:"flex items-start justify-between"},xe={class:"flex-1 min-w-0"},me={class:"mt-2 text-2xl font-bold text-rose-400 tabular-nums"},pe={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-rose-500/10"},_e={class:"glass-card rounded-xl p-5"},ye={class:"flex items-start justify-between"},ge={class:"flex-1 min-w-0"},ve={class:"mt-2 text-2xl font-bold text-slate-400 tabular-nums"},we={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-slate-500/10"},be={class:"glass-card rounded-xl p-5"},ke={class:"flex items-start justify-between"},Ce={class:"flex-1 min-w-0"},he={class:"mt-2 text-2xl font-bold text-purple-400 tabular-nums"},$e={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-purple-500/10"},Se=V({__name:"CertSummaryCards",props:{certificates:{}},setup(v){const d=v,c=T(()=>{const m=d.certificates.length;let n=0,x=0,w=0,k=0;for(const t of d.certificates)t.days_until_expiry!==null&&(t.days_until_expiry<0?x++:t.days_until_expiry<=30&&n++),t.is_self_signed&&w++,t.key_size!==null&&t.key_size<2048&&k++;return{total:m,expiringSoon:n,expired:x,selfSigned:w,weakKeys:k}});return(m,n)=>(p(),_("div",ee,[l("div",te,[l("div",se,[l("div",le,[n[0]||(n[0]=l("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Total Certs",-1)),l("p",ae,f(c.value.total),1)]),l("div",ie,[s(e(N),{class:"h-5 w-5 text-cyan-400"})])])]),l("div",ne,[l("div",re,[l("div",oe,[n[1]||(n[1]=l("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Expiring Soon",-1)),l("p",de,f(c.value.expiringSoon),1)]),l("div",ue,[s(e(H),{class:"h-5 w-5 text-amber-400"})])])]),l("div",ce,[l("div",fe,[l("div",xe,[n[2]||(n[2]=l("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Expired",-1)),l("p",me,f(c.value.expired),1)]),l("div",pe,[s(e(M),{class:"h-5 w-5 text-rose-400"})])])]),l("div",_e,[l("div",ye,[l("div",ge,[n[3]||(n[3]=l("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Self-Signed",-1)),l("p",ve,f(c.value.selfSigned),1)]),l("div",we,[s(e(W),{class:"h-5 w-5 text-slate-400"})])])]),l("div",be,[l("div",ke,[l("div",Ce,[n[4]||(n[4]=l("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Weak Keys",-1)),l("p",he,f(c.value.weakKeys),1)]),l("div",$e,[s(e(X),{class:"h-5 w-5 text-purple-400"})])])])]))}}),ze={class:"glass-panel rounded-xl"},je={class:"flex items-center gap-1"},Le={class:"flex items-center gap-1"},Ve={class:"flex items-center gap-1"},De={class:"flex items-center gap-1"},Te={class:"flex items-center gap-1"},Fe={key:0,class:"inline-flex items-center rounded-full bg-slate-500/20 px-2 py-0.5 text-xs font-medium text-slate-400"},Ke={key:1,class:"text-xs text-slate-600"},j=V({__name:"CertTable",props:{certificates:{},search:{default:""},filter:{default:"all"}},setup(v){const d=v,c=b("days_until_expiry"),m=b("asc");function n(t){c.value===t?m.value=m.value==="asc"?"desc":"asc":(c.value=t,m.value=t==="days_until_expiry"?"asc":"desc")}const x=T(()=>{let t=d.certificates;switch(d.filter){case"expiring":t=t.filter(o=>o.days_until_expiry!==null&&o.days_until_expiry>=0&&o.days_until_expiry<=30);break;case"expired":t=t.filter(o=>o.days_until_expiry!==null&&o.days_until_expiry<0);break;case"self-signed":t=t.filter(o=>o.is_self_signed);break}const a=d.search.toLowerCase().trim();a&&(t=t.filter(o=>o.ip.includes(a)||(o.cn??"").toLowerCase().includes(a)||(o.issuer??"").toLowerCase().includes(a)||String(o.port).includes(a)));const r=m.value==="asc"?1:-1;return[...t].sort((o,C)=>{let h=0;switch(c.value){case"endpoint":h=o.ip.localeCompare(C.ip)||o.port-C.port;break;case"cn":h=(o.cn??"").localeCompare(C.cn??"");break;case"issuer":h=(o.issuer??"").localeCompare(C.issuer??"");break;case"days_until_expiry":h=(o.days_until_expiry??9999)-(C.days_until_expiry??9999);break;case"key_size":h=(o.key_size??0)-(C.key_size??0);break}return h*r})});function w(t){return t===null?"text-slate-500":t<0?"text-rose-400":t<=30?"text-amber-400":"text-emerald-400"}function k(t){return t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}return(t,a)=>(p(),_("div",ze,[s(e(Y),null,{default:i(()=>[s(e(G),null,{default:i(()=>[s(e(D),null,{default:i(()=>[s(e(y),{class:"cursor-pointer select-none",onClick:a[0]||(a[0]=r=>n("endpoint"))},{default:i(()=>[l("span",je,[a[5]||(a[5]=u(" IP:Port ",-1)),s(e($),{size:12,class:"text-slate-500"})])]),_:1}),s(e(y),{class:"cursor-pointer select-none",onClick:a[1]||(a[1]=r=>n("cn"))},{default:i(()=>[l("span",Le,[a[6]||(a[6]=u(" CN ",-1)),s(e($),{size:12,class:"text-slate-500"})])]),_:1}),s(e(y),{class:"cursor-pointer select-none",onClick:a[2]||(a[2]=r=>n("issuer"))},{default:i(()=>[l("span",Ve,[a[7]||(a[7]=u(" Issuer ",-1)),s(e($),{size:12,class:"text-slate-500"})])]),_:1}),s(e(y),null,{default:i(()=>[...a[8]||(a[8]=[u("Valid From",-1)])]),_:1}),s(e(y),null,{default:i(()=>[...a[9]||(a[9]=[u("Valid To",-1)])]),_:1}),s(e(y),{class:"cursor-pointer select-none",onClick:a[3]||(a[3]=r=>n("days_until_expiry"))},{default:i(()=>[l("span",De,[a[10]||(a[10]=u(" Days Left ",-1)),s(e($),{size:12,class:"text-slate-500"})])]),_:1}),s(e(y),null,{default:i(()=>[...a[11]||(a[11]=[u("Self-Signed",-1)])]),_:1}),s(e(y),{class:"cursor-pointer select-none",onClick:a[4]||(a[4]=r=>n("key_size"))},{default:i(()=>[l("span",Te,[a[12]||(a[12]=u(" Key Size ",-1)),s(e($),{size:12,class:"text-slate-500"})])]),_:1})]),_:1})]),_:1}),s(e(J),null,{default:i(()=>[(p(!0),_(F,null,E(x.value,r=>(p(),U(e(D),{key:`${r.ip}:${r.port}`},{default:i(()=>[s(e(g),{class:"font-mono text-sm text-slate-300"},{default:i(()=>[u(f(r.ip)+":"+f(r.port),1)]),_:2},1024),s(e(g),{class:"max-w-[200px] truncate text-sm text-slate-300",title:r.cn??""},{default:i(()=>[u(f(r.cn??"-"),1)]),_:2},1032,["title"]),s(e(g),{class:"max-w-[200px] truncate text-sm text-slate-400",title:r.issuer??""},{default:i(()=>[u(f(r.issuer??"-"),1)]),_:2},1032,["title"]),s(e(g),{class:"text-xs text-slate-500"},{default:i(()=>[u(f(k(r.valid_from)),1)]),_:2},1024),s(e(g),{class:"text-xs text-slate-500"},{default:i(()=>[u(f(k(r.valid_to)),1)]),_:2},1024),s(e(g),null,{default:i(()=>[l("span",{class:L(["font-mono text-sm font-semibold tabular-nums",w(r.days_until_expiry)])},f(r.days_until_expiry!==null?r.days_until_expiry:"-"),3)]),_:2},1024),s(e(g),null,{default:i(()=>[r.is_self_signed?(p(),_("span",Fe," Yes ")):(p(),_("span",Ke,"No"))]),_:2},1024),s(e(g),null,{default:i(()=>[l("span",{class:L(["font-mono text-sm tabular-nums",r.key_size!==null&&r.key_size<2048?"text-rose-400":"text-slate-300"])},f(r.key_size??"-"),3)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))}}),Ne={class:"space-y-6"},Ae={class:"flex items-center justify-between"},Ee=["disabled"],Ue={key:0,class:"flex flex-col items-center justify-center py-20"},Be={key:1,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},Re={class:"mt-2 text-sm text-slate-400"},tt=V({__name:"CertificatesView",setup(v){const{data:d,loading:c,error:m,fetchCertificates:n}=Z(),x=b(""),w=b("all");return B(()=>{n()}),(k,t)=>(p(),_("div",Ne,[l("div",Ae,[t[5]||(t[5]=l("div",null,[l("h1",{class:"text-2xl font-bold text-white"},"TLS Certificates"),l("p",{class:"mt-1 text-sm text-slate-400"}," Certificate inventory and expiration tracking ")],-1)),l("button",{class:"flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 text-xs text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",disabled:e(c),onClick:t[0]||(t[0]=(...a)=>e(n)&&e(n)(...a))},[s(e(O),{class:L(["h-3.5 w-3.5",{"animate-spin":e(c)}])},null,8,["class"]),t[4]||(t[4]=u(" Refresh ",-1))],8,Ee)]),e(c)&&!e(d)?(p(),_("div",Ue,[s(e(Q),{class:"h-8 w-8 animate-spin text-cyan-400"}),t[6]||(t[6]=l("p",{class:"mt-3 text-sm text-slate-400"},"Loading certificate data...",-1))])):e(m)&&!e(d)?(p(),_("div",Be,[s(e(A),{class:"mx-auto h-10 w-10 text-amber-400"}),t[7]||(t[7]=l("h2",{class:"mt-3 text-lg font-semibold text-white"},"Unable to Load Data",-1)),l("p",Re,f(e(m)),1),l("button",{class:"mt-4 rounded-lg bg-cyan-500/20 px-4 py-2 text-sm font-medium text-cyan-400 transition-colors hover:bg-cyan-500/30",onClick:t[1]||(t[1]=(...a)=>e(n)&&e(n)(...a))}," Try Again ")])):e(d)?(p(),_(F,{key:2},[s(Se,{certificates:e(d).certificates},null,8,["certificates"]),s(q,{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=a=>x.value=a),placeholder:"Search by IP, CN, or issuer...",class:"max-w-md"},null,8,["modelValue"]),s(e(I),{modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=a=>w.value=a),"default-value":"all"},{default:i(()=>[s(e(P),null,{default:i(()=>[s(e(S),{value:"all"},{default:i(()=>[...t[8]||(t[8]=[u("All",-1)])]),_:1}),s(e(S),{value:"expiring"},{default:i(()=>[...t[9]||(t[9]=[u("Expiring Soon",-1)])]),_:1}),s(e(S),{value:"expired"},{default:i(()=>[...t[10]||(t[10]=[u("Expired",-1)])]),_:1}),s(e(S),{value:"self-signed"},{default:i(()=>[...t[11]||(t[11]=[u("Self-Signed",-1)])]),_:1})]),_:1}),s(e(z),{value:"all"},{default:i(()=>[s(j,{certificates:e(d).certificates,search:x.value,filter:"all"},null,8,["certificates","search"])]),_:1}),s(e(z),{value:"expiring"},{default:i(()=>[s(j,{certificates:e(d).certificates,search:x.value,filter:"expiring"},null,8,["certificates","search"])]),_:1}),s(e(z),{value:"expired"},{default:i(()=>[s(j,{certificates:e(d).certificates,search:x.value,filter:"expired"},null,8,["certificates","search"])]),_:1}),s(e(z),{value:"self-signed"},{default:i(()=>[s(j,{certificates:e(d).certificates,search:x.value,filter:"self-signed"},null,8,["certificates","search"])]),_:1})]),_:1},8,["modelValue"])],64)):R("",!0)]))}});export{tt as default};
//# sourceMappingURL=CertificatesView-Bk9uXYW3.js.map
