import{b as I}from"./index-CIeehwBn.js";import{r as k,d as $,q as b,k as e,l as s,c as r,j as o,H as g,y as v,g as p,z as C,e as h,p as T,F as D,o as O,m as x}from"./vendor-DoZ-jnr8.js";import{_ as Z,b as U,a as G}from"./LoadingState.vue_vue_type_script_setup_true_lang-8EoBoOhd.js";import{C as W,b as q,L as E,P as F,c as N,d as P,p as V,a as H,i as J,e as K,B as Q,f as X,g as Y,h as ee}from"./charts-bXXrv3Qx.js";import{_ as w,b as R,a as z,c as L}from"./CardContent.vue_vue_type_script_setup_true_lang-DMXrHjfJ.js";import{_ as te}from"./IpLink.vue_vue_type_script_setup_true_lang-CJU4XeZe.js";import{_ as ae,c as se,a as M,b as A,e as oe,d as S}from"./TableCell.vue_vue_type_script_setup_true_lang-CTNi0yoY.js";import"./index-Bn2cS4ww.js";import"./utils-CytzSlOG.js";import"./loader-circle-C8oF-5P-.js";function ne(){const f=k(null),a=k(!1),i=k(null);async function d(l=30){a.value=!0,i.value=null;try{const t=await I.getAnalytics(l);f.value=t.data}catch(t){const n=t instanceof Error?t.message:"Failed to load analytics data";i.value=n}finally{a.value=!1}}return{data:f,loading:a,error:i,fetchAnalytics:d}}const re={class:"h-64"},B=$({__name:"TrendLineChart",props:{series:{},title:{},multiline:{type:Boolean,default:!1}},setup(f){W.register(q,E,F,N,P,V,H,J);const a=f,i=[{border:"#22d3ee",bg:"rgba(34, 211, 238, 0.15)"},{border:"#3b82f6",bg:"rgba(59, 130, 246, 0.15)"},{border:"#8b5cf6",bg:"rgba(139, 92, 246, 0.15)"},{border:"#10b981",bg:"rgba(16, 185, 129, 0.15)"},{border:"#f59e0b",bg:"rgba(245, 158, 11, 0.15)"},{border:"#6b7280",bg:"rgba(107, 114, 128, 0.15)"}],d=C(()=>Array.isArray(a.series)?a.series:[a.series]),l=C(()=>{const n=d.value[0];if(!n)return{labels:[],datasets:[]};const m=n.points.map(c=>new Date(c.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),_=d.value.map((c,u)=>{const y=i[u%i.length];return{label:c.name,data:c.points.map(j=>j.value),borderColor:y.border,backgroundColor:(a.multiline,y.bg),fill:a.multiline,tension:.3,pointRadius:2,pointHoverRadius:5,borderWidth:2}});return{labels:m,datasets:_}}),t=C(()=>({responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:d.value.length>1,position:"bottom",labels:{color:"#94a3b8",padding:12,font:{size:11},usePointStyle:!0,pointStyleWidth:8}},tooltip:{backgroundColor:"rgba(15, 23, 42, 0.9)",titleColor:"#e2e8f0",bodyColor:"#94a3b8",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:10,cornerRadius:8}},scales:{x:{grid:{color:"rgba(255, 255, 255, 0.05)"},ticks:{color:"#64748b",font:{size:10}}},y:{grid:{color:"rgba(255, 255, 255, 0.05)"},ticks:{color:"#64748b",font:{size:10}},beginAtZero:!0}}}));return(n,m)=>(r(),b(e(w),null,{default:s(()=>[o(e(z),null,{default:s(()=>[o(e(R),{class:"text-base"},{default:s(()=>[g(v(f.title),1)]),_:1})]),_:1}),o(e(L),null,{default:s(()=>[p("div",re,[o(e(K),{data:l.value,options:t.value},null,8,["data","options"])])]),_:1})]),_:1}))}}),le={class:"h-64"},ie=$({__name:"ScanFrequencyChart",props:{data:{}},setup(f){W.register(q,E,Q,F,N,P,V,H,X,Y);const a=f,i=C(()=>({labels:a.data.map(t=>new Date(t.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{type:"bar",label:"Scans",data:a.data.map(t=>t.scan_count),backgroundColor:"rgba(34, 211, 238, 0.3)",borderColor:"#22d3ee",borderWidth:1,borderRadius:4,yAxisID:"y"},{type:"line",label:"Total Assets",data:a.data.map(t=>t.total_assets),borderColor:"#a78bfa",backgroundColor:"rgba(167, 139, 250, 0.1)",borderWidth:2,tension:.3,pointRadius:2,pointHoverRadius:5,yAxisID:"y1"}]})),d={responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{color:"#94a3b8",padding:12,font:{size:11},usePointStyle:!0,pointStyleWidth:8}},tooltip:{backgroundColor:"rgba(15, 23, 42, 0.9)",titleColor:"#e2e8f0",bodyColor:"#94a3b8",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:10,cornerRadius:8}},scales:{x:{grid:{color:"rgba(255, 255, 255, 0.05)"},ticks:{color:"#64748b",font:{size:10}}},y:{position:"left",grid:{color:"rgba(255, 255, 255, 0.05)"},ticks:{color:"#22d3ee",font:{size:10}},title:{display:!0,text:"Scans",color:"#22d3ee",font:{size:11}},beginAtZero:!0},y1:{position:"right",grid:{drawOnChartArea:!1},ticks:{color:"#a78bfa",font:{size:10}},title:{display:!0,text:"Assets",color:"#a78bfa",font:{size:11}},beginAtZero:!0}}};return(l,t)=>(r(),b(e(w),null,{default:s(()=>[o(e(z),null,{default:s(()=>[o(e(R),{class:"text-base"},{default:s(()=>[...t[0]||(t[0]=[g("Scan Frequency",-1)])]),_:1})]),_:1}),o(e(L),null,{default:s(()=>[p("div",le,[o(e(ee),{data:i.value,options:d},null,8,["data"])])]),_:1})]),_:1}))}}),de={class:"font-semibold tabular-nums text-amber-400"},ce=$({__name:"MostChangedTable",props:{assets:{}},setup(f){const a=f,i=C(()=>[...a.assets].sort((l,t)=>t.change_count-l.change_count));function d(l){const t=new Date,n=new Date(l),m=t.getTime()-n.getTime(),_=Math.floor(m/6e4);if(_<1)return"just now";if(_<60)return`${_}m ago`;const c=Math.floor(_/60);if(c<24)return`${c}h ago`;const u=Math.floor(c/24);return u<30?`${u}d ago`:`${Math.floor(u/30)}mo ago`}return(l,t)=>(r(),b(e(w),null,{default:s(()=>[o(e(z),null,{default:s(()=>[o(e(R),{class:"text-base"},{default:s(()=>[...t[0]||(t[0]=[g("Most Changed Assets",-1)])]),_:1})]),_:1}),o(e(L),null,{default:s(()=>[o(e(ae),null,{default:s(()=>[o(e(se),null,{default:s(()=>[o(e(M),null,{default:s(()=>[o(e(A),null,{default:s(()=>[...t[1]||(t[1]=[g("IP Address",-1)])]),_:1}),o(e(A),null,{default:s(()=>[...t[2]||(t[2]=[g("Changes",-1)])]),_:1}),o(e(A),null,{default:s(()=>[...t[3]||(t[3]=[g("Last Change",-1)])]),_:1})]),_:1})]),_:1}),o(e(oe),null,{default:s(()=>[(r(!0),h(D,null,T(i.value,n=>(r(),b(e(M),{key:n.ip},{default:s(()=>[o(e(S),null,{default:s(()=>[o(te,{ip:n.ip},null,8,["ip"])]),_:2},1024),o(e(S),null,{default:s(()=>[p("span",de,v(n.change_count),1)]),_:2},1024),o(e(S),{class:"text-muted-foreground text-sm"},{default:s(()=>[g(v(d(n.last_change)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}}),ue={class:"space-y-6"},fe={class:"flex items-center justify-between"},_e={class:"flex gap-1 rounded-lg border border-border bg-white/5 p-1"},be={key:1,class:"rounded-lg border border-rose-500/30 bg-rose-500/10 p-4"},ge={class:"text-sm text-rose-400"},pe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},De=$({__name:"AnalyticsView",setup(f){const{data:a,loading:i,error:d,fetchAnalytics:l}=ne(),t=k(30),n=[{label:"7d",days:7},{label:"30d",days:30},{label:"90d",days:90}];function m(_){t.value=_,l(_)}return O(()=>{l(t.value)}),(_,c)=>(r(),h("div",ue,[p("div",fe,[c[0]||(c[0]=p("h1",{class:"text-2xl font-bold text-white"},"Analytics & Trends",-1)),p("div",_e,[(r(),h(D,null,T(n,u=>o(e(Z),{key:u.days,variant:t.value===u.days?"default":"ghost",size:"sm",class:"text-xs",onClick:y=>m(u.days)},{default:s(()=>[g(v(u.label),1)]),_:2},1032,["variant","onClick"])),64))])]),e(i)?(r(),b(U,{key:0,message:"Loading analytics data..."})):e(d)?(r(),h("div",be,[p("p",ge,v(e(d)),1)])):e(a)?(r(),h(D,{key:3},[e(a).asset_count_trend?(r(),b(B,{key:0,series:e(a).asset_count_trend,title:"Asset Count Trend"},null,8,["series"])):x("",!0),e(a).category_trends.length>0?(r(),b(B,{key:1,series:e(a).category_trends,title:"Category Trends",multiline:!0},null,8,["series"])):x("",!0),p("div",pe,[e(a).scan_frequency.length>0?(r(),b(ie,{key:0,data:e(a).scan_frequency},null,8,["data"])):x("",!0),e(a).most_changed_assets.length>0?(r(),b(ce,{key:1,assets:e(a).most_changed_assets},null,8,["assets"])):x("",!0)])],64)):(r(),b(G,{key:2,title:"No Analytics Data",description:"Run scans over time to generate trend analytics."}))]))}});export{De as default};
//# sourceMappingURL=AnalyticsView-BXDWvwNo.js.map
