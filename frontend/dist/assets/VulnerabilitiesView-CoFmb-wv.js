import{r as j,d as A,e as i,g as e,y as u,j as s,k as t,z as S,c as a,f as L,m as k,l as x,H as w,F as z,p as B,q as T,x as M,Q as P,E as H,o as R,T as U}from"./vendor-B81oEKTZ.js";import{b as K,B as q,T as I,d as Q,S as X}from"./index-CpS9bQ3X.js";import{_ as G}from"./SearchInput.vue_vue_type_script_setup_true_lang-Bj7cZYD5.js";import{C as J}from"./circle-alert-Cxvtaaaq.js";import{I as O}from"./info-SP8KZv86.js";import{_ as W,c as Y,a as E,b as V,e as Z,d as $}from"./TableCell.vue_vue_type_script_setup_true_lang-BqriAm9j.js";import{_ as ee}from"./IpLink.vue_vue_type_script_setup_true_lang-QduQDQx1.js";import{c as te}from"./utils-CytzSlOG.js";import{A as F}from"./arrow-up-down-rmbu9ogs.js";import{C as se}from"./chevron-down-_q7CsRwS.js";import{C as le,S as ne,E as ae}from"./shield-alert-BzWDHMCA.js";import{X as ie}from"./x-DFSAYirK.js";import{C as oe}from"./circle-check-big-DwLz-eYA.js";import{R as re}from"./refresh-cw-D5_ME20R.js";import{L as ce}from"./loader-circle-GrpjL4Zy.js";function de(){const c=j(null),f=j(!1),o=j(null);async function h(){f.value=!0,o.value=null;try{const l=await K.getVulnerabilities();c.value=l.data}catch(l){const b=l instanceof Error?l.message:"Failed to load vulnerability data";o.value=b}finally{f.value=!1}}return{data:c,loading:f,error:o,fetchVulnerabilities:h}}const ue={class:"grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-6"},xe={class:"glass-card rounded-xl p-5"},me={class:"flex items-start justify-between"},fe={class:"flex-1 min-w-0"},ve={class:"mt-2 text-2xl font-bold text-white tabular-nums"},pe={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-cyan-500/10"},_e={class:"glass-card rounded-xl p-5"},be={class:"flex items-start justify-between"},ge={class:"flex-1 min-w-0"},he={class:"mt-2 text-2xl font-bold text-rose-400 tabular-nums"},ye={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-rose-500/10"},we={class:"glass-card rounded-xl p-5"},$e={class:"flex items-start justify-between"},ke={class:"flex-1 min-w-0"},Ce={class:"mt-2 text-2xl font-bold text-amber-400 tabular-nums"},Ve={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-amber-500/10"},je={class:"glass-card rounded-xl p-5"},Se={class:"flex items-start justify-between"},Le={class:"flex-1 min-w-0"},Ae={class:"mt-2 text-2xl font-bold text-cyan-400 tabular-nums"},De={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-cyan-500/10"},ze={class:"glass-card rounded-xl p-5"},Ee={class:"flex items-start justify-between"},Fe={class:"flex-1 min-w-0"},Be={class:"mt-2 text-2xl font-bold text-slate-400 tabular-nums"},Te={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-slate-500/10"},Ie={class:"glass-card rounded-xl p-5"},Ne={class:"flex items-start justify-between"},Me={class:"flex-1 min-w-0"},Pe={class:"mt-2 text-2xl font-bold text-purple-400 tabular-nums"},He={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-purple-500/10"},Re=A({__name:"VulnSummaryCards",props:{summaries:{}},setup(c){const f=c,o=S(()=>{let h=0,l=0,b=0,g=0,p=0;const r=f.summaries.filter(y=>y.total_vulns>0).length;for(const y of f.summaries)h+=y.total_vulns,l+=y.critical_count,b+=y.high_count,g+=y.medium_count,p+=y.low_count;return{totalVulns:h,critical:l,high:b,medium:g,low:p,affectedAssets:r}});return(h,l)=>(a(),i("div",ue,[e("div",xe,[e("div",me,[e("div",fe,[l[0]||(l[0]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Total Vulns",-1)),e("p",ve,u(o.value.totalVulns),1)]),e("div",pe,[s(t(q),{class:"h-5 w-5 text-cyan-400"})])])]),e("div",_e,[e("div",be,[e("div",ge,[l[1]||(l[1]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Critical",-1)),e("p",he,u(o.value.critical),1)]),e("div",ye,[s(t(I),{class:"h-5 w-5 text-rose-400"})])])]),e("div",we,[e("div",$e,[e("div",ke,[l[2]||(l[2]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"High",-1)),e("p",Ce,u(o.value.high),1)]),e("div",Ve,[s(t(J),{class:"h-5 w-5 text-amber-400"})])])]),e("div",je,[e("div",Se,[e("div",Le,[l[3]||(l[3]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Medium",-1)),e("p",Ae,u(o.value.medium),1)]),e("div",De,[s(t(O),{class:"h-5 w-5 text-cyan-400"})])])]),e("div",ze,[e("div",Ee,[e("div",Fe,[l[4]||(l[4]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Low",-1)),e("p",Be,u(o.value.low),1)]),e("div",Te,[s(t(Q),{class:"h-5 w-5 text-slate-400"})])])]),e("div",Ie,[e("div",Ne,[e("div",Me,[l[5]||(l[5]=e("p",{class:"text-xs font-medium uppercase tracking-wider text-slate-400"},"Affected",-1)),e("p",Pe,u(o.value.affectedAssets),1)]),e("div",He,[s(t(X),{class:"h-5 w-5 text-purple-400"})])])])]))}}),Ue={key:0,class:"opacity-75"},N=A({__name:"SeverityBadge",props:{severity:{},score:{},class:{}},setup(c){const f=c,o=S(()=>{switch(f.severity.toLowerCase()){case"critical":return{bg:"bg-red-500/20",text:"text-red-400",label:"Critical"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"High"};case"medium":return{bg:"bg-yellow-500/20",text:"text-yellow-400",label:"Medium"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"Low"};default:return{bg:"bg-gray-500/20",text:"text-gray-400",label:"None"}}});return(h,l)=>(a(),i("span",{class:L(t(te)("inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-xs font-semibold",o.value.bg,o.value.text,f.class))},[e("span",null,u(o.value.label),1),c.score!==void 0?(a(),i("span",Ue,u(c.score.toFixed(1)),1)):k("",!0)],2))}}),Ke={class:"glass-panel rounded-xl"},qe={class:"flex items-center gap-1"},Qe={class:"flex items-center gap-1"},Xe={class:"flex items-center gap-1"},Ge={key:0,class:"inline-flex items-center rounded-full bg-red-500/20 px-2 py-0.5 text-xs font-semibold text-red-400"},Je={key:1,class:"text-xs text-slate-600"},Oe={key:0,class:"inline-flex items-center rounded-full bg-orange-500/20 px-2 py-0.5 text-xs font-semibold text-orange-400"},We={key:1,class:"text-xs text-slate-600"},Ye={key:0,class:"inline-flex items-center rounded-full bg-yellow-500/20 px-2 py-0.5 text-xs font-semibold text-yellow-400"},Ze={key:1,class:"text-xs text-slate-600"},et={key:0,class:"inline-flex items-center rounded-full bg-blue-500/20 px-2 py-0.5 text-xs font-semibold text-blue-400"},tt={key:1,class:"text-xs text-slate-600"},st={class:"space-y-2"},lt=["onClick"],nt={class:"flex-1 truncate text-xs text-slate-400"},at={key:0,class:"rounded-full bg-rose-500/20 px-2 py-0.5 text-[10px] font-semibold text-rose-400"},it={key:1,class:"rounded-full bg-emerald-500/20 px-2 py-0.5 text-[10px] font-semibold text-emerald-400"},ot=A({__name:"VulnAssetTable",props:{summaries:{},search:{default:""}},emits:["cve-click"],setup(c,{emit:f}){const o=c,h=f,l=j("max_cvss"),b=j("desc"),g=j(new Set);function p(d){l.value===d?b.value=b.value==="asc"?"desc":"asc":(l.value=d,b.value="desc")}function r(d){const n=new Set(g.value);n.has(d)?n.delete(d):n.add(d),g.value=n}const y=S(()=>{let d=o.summaries;const n=o.search.toLowerCase().trim();n&&(d=d.filter(_=>_.ip.includes(n)||_.matches.some(C=>C.cve.cve_id.toLowerCase().includes(n)||C.cve.description.toLowerCase().includes(n)||(C.asset_vendor??"").toLowerCase().includes(n))));const m=b.value==="asc"?1:-1;return[...d].sort((_,C)=>{let D=0;switch(l.value){case"ip":D=_.ip.localeCompare(C.ip);break;case"total_vulns":D=_.total_vulns-C.total_vulns;break;case"max_cvss":D=_.max_cvss-C.max_cvss;break}return D*m})});function v(d){return d>=9?"text-rose-400":d>=7?"text-amber-400":d>=4?"text-cyan-400":"text-emerald-400"}return(d,n)=>(a(),i("div",Ke,[s(t(W),null,{default:x(()=>[s(t(Y),null,{default:x(()=>[s(t(E),null,{default:x(()=>[s(t(V),{class:"w-8"}),s(t(V),{class:"cursor-pointer select-none",onClick:n[0]||(n[0]=m=>p("ip"))},{default:x(()=>[e("span",qe,[n[3]||(n[3]=w(" IP ",-1)),s(t(F),{size:12,class:"text-slate-500"})])]),_:1}),s(t(V),{class:"cursor-pointer select-none",onClick:n[1]||(n[1]=m=>p("total_vulns"))},{default:x(()=>[e("span",Qe,[n[4]||(n[4]=w(" Total ",-1)),s(t(F),{size:12,class:"text-slate-500"})])]),_:1}),s(t(V),null,{default:x(()=>[...n[5]||(n[5]=[w("Critical",-1)])]),_:1}),s(t(V),null,{default:x(()=>[...n[6]||(n[6]=[w("High",-1)])]),_:1}),s(t(V),null,{default:x(()=>[...n[7]||(n[7]=[w("Medium",-1)])]),_:1}),s(t(V),null,{default:x(()=>[...n[8]||(n[8]=[w("Low",-1)])]),_:1}),s(t(V),{class:"cursor-pointer select-none",onClick:n[2]||(n[2]=m=>p("max_cvss"))},{default:x(()=>[e("span",Xe,[n[9]||(n[9]=w(" Max CVSS ",-1)),s(t(F),{size:12,class:"text-slate-500"})])]),_:1})]),_:1})]),_:1}),s(t(Z),null,{default:x(()=>[(a(!0),i(z,null,B(y.value,m=>(a(),i(z,{key:m.ip},[s(t(E),{class:"cursor-pointer",onClick:_=>r(m.ip)},{default:x(()=>[s(t($),{class:"w-8 pr-0"},{default:x(()=>[(a(),T(M(g.value.has(m.ip)?t(se):t(le)),{size:14,class:"text-slate-500"}))]),_:2},1024),s(t($),null,{default:x(()=>[s(ee,{ip:m.ip},null,8,["ip"])]),_:2},1024),s(t($),{class:"font-mono text-sm text-slate-300 tabular-nums"},{default:x(()=>[w(u(m.total_vulns),1)]),_:2},1024),s(t($),null,{default:x(()=>[m.critical_count>0?(a(),i("span",Ge,u(m.critical_count),1)):(a(),i("span",Je,"0"))]),_:2},1024),s(t($),null,{default:x(()=>[m.high_count>0?(a(),i("span",Oe,u(m.high_count),1)):(a(),i("span",We,"0"))]),_:2},1024),s(t($),null,{default:x(()=>[m.medium_count>0?(a(),i("span",Ye,u(m.medium_count),1)):(a(),i("span",Ze,"0"))]),_:2},1024),s(t($),null,{default:x(()=>[m.low_count>0?(a(),i("span",et,u(m.low_count),1)):(a(),i("span",tt,"0"))]),_:2},1024),s(t($),null,{default:x(()=>[e("span",{class:L(["font-mono text-sm font-semibold tabular-nums",v(m.max_cvss)])},u(m.max_cvss.toFixed(1)),3)]),_:2},1024)]),_:2},1032,["onClick"]),g.value.has(m.ip)?(a(),T(t(E),{key:0,class:"bg-white/[0.02]"},{default:x(()=>[s(t($),{colspan:"8",class:"px-8 py-3"},{default:x(()=>[e("div",st,[(a(!0),i(z,null,B(m.matches,_=>(a(),i("div",{key:_.cve.cve_id,class:"flex items-center gap-3 rounded-lg bg-white/5 px-3 py-2 text-sm"},[e("button",{class:"font-mono text-xs text-cyan-400 hover:text-cyan-300 hover:underline underline-offset-2 transition-colors",onClick:P(C=>h("cve-click",_.cve.cve_id),["stop"])},u(_.cve.cve_id),9,lt),s(N,{severity:_.cve.severity,score:_.cve.cvss_score},null,8,["severity","score"]),e("span",nt,u(_.cve.description),1),_.cve.cisa_kev?(a(),i("span",at," KEV ")):k("",!0),_.cve.fix_available?(a(),i("span",it," Fix ")):k("",!0)]))),128))])]),_:2},1024)]),_:2},1024)):k("",!0)],64))),128))]),_:1})]),_:1})]))}}),rt={class:"glass-panel rounded-xl p-5"},ct={class:"mb-4 flex items-start justify-between"},dt={class:"font-mono text-sm font-semibold text-white"},ut={class:"mt-1 flex items-center gap-2"},xt={class:"mb-4"},mt={class:"flex items-baseline gap-2"},ft={class:"mt-2 h-2 w-full rounded-full bg-white/5"},vt={class:"mb-4"},pt={class:"text-sm leading-relaxed text-slate-300"},_t={class:"mb-4 space-y-2.5 text-sm"},bt={class:"flex items-start justify-between"},gt={class:"text-right text-slate-300"},ht={class:"flex items-start justify-between"},yt={class:"text-right text-slate-300"},wt={key:0,class:"flex items-start justify-between"},$t={class:"text-right font-mono text-xs text-slate-400 max-w-[200px] break-all"},kt={key:1,class:"flex items-start justify-between"},Ct={class:"text-right text-slate-300"},Vt={class:"flex flex-wrap gap-2"},jt={key:0,class:"flex items-center gap-1.5 rounded-full bg-emerald-500/10 px-3 py-1.5 text-xs font-medium text-emerald-400"},St={key:1,class:"flex items-center gap-1.5 rounded-full bg-slate-500/10 px-3 py-1.5 text-xs font-medium text-slate-400"},Lt={key:2,class:"flex items-center gap-1.5 rounded-full bg-rose-500/10 px-3 py-1.5 text-xs font-medium text-rose-400"},At=["href"],Dt=A({__name:"CveDetailPanel",props:{cve:{}},emits:["close"],setup(c,{emit:f}){const o=c,h=f,l=S(()=>{const p=o.cve.cvss_score;return p>=9?"text-rose-400":p>=7?"text-amber-400":p>=4?"text-cyan-400":"text-emerald-400"}),b=S(()=>{const p=o.cve.cvss_score;return p>=9?"bg-rose-400":p>=7?"bg-amber-400":p>=4?"bg-cyan-400":"bg-emerald-400"}),g=S(()=>o.cve.published?new Date(o.cve.published).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):null);return(p,r)=>(a(),i("div",rt,[e("div",ct,[e("div",null,[e("h3",dt,u(c.cve.cve_id),1),e("div",ut,[s(N,{severity:c.cve.severity},null,8,["severity"])])]),e("button",{class:"rounded-md p-1 text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",onClick:r[0]||(r[0]=y=>h("close"))},[s(t(ie),{size:16})])]),e("div",xt,[e("div",mt,[e("span",{class:L(["text-3xl font-bold tabular-nums",l.value])},u(c.cve.cvss_score.toFixed(1)),3),r[1]||(r[1]=e("span",{class:"text-xs text-slate-500"},"/ 10.0",-1))]),e("div",ft,[e("div",{class:L(["h-full rounded-full transition-all duration-500",b.value]),style:H({width:`${c.cve.cvss_score/10*100}%`})},null,6)])]),e("div",vt,[r[2]||(r[2]=e("h4",{class:"mb-1 text-xs font-medium uppercase tracking-wider text-slate-500"},"Description",-1)),e("p",pt,u(c.cve.description),1)]),e("div",_t,[e("div",bt,[r[3]||(r[3]=e("span",{class:"text-slate-500"},"Vendor",-1)),e("span",gt,u(c.cve.affected_vendor),1)]),e("div",ht,[r[4]||(r[4]=e("span",{class:"text-slate-500"},"Product",-1)),e("span",yt,u(c.cve.affected_product),1)]),c.cve.cpe?(a(),i("div",wt,[r[5]||(r[5]=e("span",{class:"text-slate-500"},"CPE",-1)),e("span",$t,u(c.cve.cpe),1)])):k("",!0),g.value?(a(),i("div",kt,[r[6]||(r[6]=e("span",{class:"text-slate-500"},"Published",-1)),e("span",Ct,u(g.value),1)])):k("",!0)]),e("div",Vt,[c.cve.fix_available?(a(),i("div",jt,[s(t(oe),{size:12}),r[7]||(r[7]=w(" Fix Available ",-1))])):(a(),i("div",St," No Fix Available ")),c.cve.cisa_kev?(a(),i("div",Lt,[s(t(ne),{size:12}),r[8]||(r[8]=w(" CISA KEV ",-1))])):k("",!0)]),e("a",{href:`https://nvd.nist.gov/vuln/detail/${c.cve.cve_id}`,target:"_blank",rel:"noopener noreferrer",class:"mt-4 flex items-center gap-1.5 text-xs text-cyan-400 transition-colors hover:text-cyan-300"},[r[9]||(r[9]=w(" View on NVD ",-1)),s(t(ae),{size:10})],8,At)]))}}),zt={class:"space-y-6"},Et={class:"flex items-center justify-between"},Ft=["disabled"],Bt={key:0,class:"flex flex-col items-center justify-center py-20"},Tt={key:1,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},It={class:"mt-2 text-sm text-slate-400"},Nt={class:"flex gap-6"},Mt={class:"flex-1 min-w-0"},Pt={key:0,class:"w-80 shrink-0"},Ht={class:"sticky top-4"},ls=A({__name:"VulnerabilitiesView",setup(c){const{data:f,loading:o,error:h,fetchVulnerabilities:l}=de(),b=j(""),g=j(null);function p(y){if(f.value){for(const v of f.value.summaries)for(const d of v.matches)if(d.cve.cve_id===y){g.value=d.cve;return}}}function r(){g.value=null}return R(()=>{l()}),(y,v)=>(a(),i("div",zt,[e("div",Et,[v[4]||(v[4]=e("div",null,[e("h1",{class:"text-2xl font-bold text-white"},"Vulnerabilities"),e("p",{class:"mt-1 text-sm text-slate-400"}," CVE matching and vulnerability analysis ")],-1)),e("button",{class:"flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 text-xs text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",disabled:t(o),onClick:v[0]||(v[0]=(...d)=>t(l)&&t(l)(...d))},[s(t(re),{class:L(["h-3.5 w-3.5",{"animate-spin":t(o)}])},null,8,["class"]),v[3]||(v[3]=w(" Refresh ",-1))],8,Ft)]),t(o)&&!t(f)?(a(),i("div",Bt,[s(t(ce),{class:"h-8 w-8 animate-spin text-cyan-400"}),v[5]||(v[5]=e("p",{class:"mt-3 text-sm text-slate-400"},"Loading vulnerability data...",-1))])):t(h)&&!t(f)?(a(),i("div",Tt,[s(t(I),{class:"mx-auto h-10 w-10 text-amber-400"}),v[6]||(v[6]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Unable to Load Data",-1)),e("p",It,u(t(h)),1),e("button",{class:"mt-4 rounded-lg bg-cyan-500/20 px-4 py-2 text-sm font-medium text-cyan-400 transition-colors hover:bg-cyan-500/30",onClick:v[1]||(v[1]=(...d)=>t(l)&&t(l)(...d))}," Try Again ")])):t(f)?(a(),i(z,{key:2},[s(Re,{summaries:t(f).summaries},null,8,["summaries"]),s(G,{modelValue:b.value,"onUpdate:modelValue":v[2]||(v[2]=d=>b.value=d),placeholder:"Search by IP, CVE ID, or description...",class:"max-w-md"},null,8,["modelValue"]),e("div",Nt,[e("div",Mt,[s(ot,{summaries:t(f).summaries,search:b.value,onCveClick:p},null,8,["summaries","search"])]),s(U,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"translate-x-4 opacity-0","enter-to-class":"translate-x-0 opacity-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"translate-x-0 opacity-100","leave-to-class":"translate-x-4 opacity-0"},{default:x(()=>[g.value?(a(),i("div",Pt,[e("div",Ht,[s(Dt,{cve:g.value,onClose:r},null,8,["cve"])])])):k("",!0)]),_:1})])],64)):k("",!0)]))}});export{ls as default};
//# sourceMappingURL=VulnerabilitiesView-CoFmb-wv.js.map
