import{c as X,b as J,d as ee,N as Z,T as te,a as U,B as be,S as _e}from"./index-BJnaPNgl.js";import{I as ye,r as j,z as S,a as we,d as O,e as s,g as e,N as ke,W as $e,F as E,p as T,f as D,q as F,k as d,H as A,y as l,Q as se,c as t,o as Se,w as Ce,m as f,E as Y,j as b,x as H,S as Pe,l as L}from"./vendor-B81oEKTZ.js";import{L as le}from"./loader-circle-BP_2q-Q8.js";import{C as V}from"./circle-check-big-Htw8933f.js";import{C as ne}from"./chevron-down-BDpEgEBA.js";import{C as ae,E as he,S as z}from"./shield-alert-Dyz4u2Tj.js";import{C as K}from"./circle-x-CwKuLWAg.js";import{G as Ie}from"./globe-DZ2nJPrv.js";import{C as ve}from"./clock-DmpEndb1.js";import{A as Me}from"./arrow-up-down-BAXS-oAN.js";import{K as Ae}from"./key-round-EcBubBvX.js";import{_ as De,a as Ne,b as q,c as W}from"./TabsContent.vue_vue_type_script_setup_true_lang-4t9VYY79.js";import{R as Ee}from"./refresh-cw-CVKuNPtJ.js";import"./index-B4X1KNOo.js";import"./utils-CytzSlOG.js";/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=X("FilterIcon",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=X("FlagIcon",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=X("MailIcon",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=X("PlayIcon",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=X("ShieldXIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=X("WrenchIcon",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Oe=ye("shield",()=>{const _=j([]),x=j(null),y=S(()=>_.value.find(p=>p.id===x.value)??null);function C(p){_.value=[p,..._.value.filter(i=>i.id!==p.id)].slice(0,50),x.value=p.id}function v(p){const i=_.value.findIndex(u=>u.id===p.id);i!==-1?_.value[i]=p:C(p)}function w(){_.value=[],x.value=null}return{recentScans:_,currentScanId:x,currentScan:y,addScan:C,updateScan:v,$reset:w}});function Ve(){const _=j(null),x=j([]),y=j(!1),C=j(!1),v=j(null);let w=null;const p=Oe();function i(){w!==null&&(clearInterval(w),w=null)}async function u(a,n,r){y.value=!0,C.value=!0,v.value=null;try{const I=(await J.startShieldScan(a,n,r)).data.scan;return _.value=I,p.addScan(I),o(I.id),I}catch(h){const I=h instanceof Error?h.message:"Failed to start scan";return v.value=I,C.value=!1,null}finally{y.value=!1}}async function m(a){y.value=!0,v.value=null;try{const r=(await J.getShieldScan(a)).data.scan;return _.value=r,p.updateScan(r),r}catch(n){const r=n instanceof Error?n.message:"Failed to fetch scan";return v.value=r,null}finally{y.value=!1}}async function c(a){y.value=!0,v.value=null;try{const r=(await J.getShieldFindings(a)).data;return x.value=r.findings,r.findings}catch(n){const r=n instanceof Error?n.message:"Failed to fetch findings";return v.value=r,[]}finally{y.value=!1}}function o(a){i(),w=setInterval(async()=>{try{const r=(await J.getShieldScan(a)).data.scan;_.value=r,p.updateScan(r),(r.status==="completed"||r.status==="failed")&&(i(),C.value=!1,r.status==="completed"&&(x.value=r.findings??[],x.value.length===0&&await c(a)))}catch{}},2e3)}return we(()=>{i()}),{currentScan:_,findings:x,loading:y,scanning:C,error:v,startScan:u,fetchScan:m,fetchFindings:c,pollScan:o,stopPolling:i}}const He={class:"glass-card rounded-xl p-5"},Be=["disabled"],qe={class:"flex gap-2"},We=["disabled","onClick"],ze={class:"font-medium"},Ke={class:"mt-0.5 text-xs opacity-60"},Qe=["disabled"],Ue=O({__name:"ScanForm",props:{scanning:{type:Boolean}},emits:["scan"],setup(_,{emit:x}){const y=_,C=x,v=j(""),w=j("standard"),p=[{value:"quick",label:"Quick",desc:"~30s"},{value:"standard",label:"Standard",desc:"~2min"},{value:"deep",label:"Deep",desc:"~5min"}];function i(){const u=v.value.trim();u&&C("scan",u,w.value)}return(u,m)=>(t(),s("div",He,[e("form",{onSubmit:se(i,["prevent"]),class:"space-y-4"},[e("div",null,[m[1]||(m[1]=e("label",{class:"mb-1.5 block text-sm font-medium text-slate-300"}," Target ",-1)),ke(e("input",{"onUpdate:modelValue":m[0]||(m[0]=c=>v.value=c),type:"text",placeholder:"example.com or 192.168.1.0/24",disabled:y.scanning,class:"w-full rounded-lg border border-[var(--border-glass)] bg-white/5 px-4 py-2.5 text-sm text-white placeholder-slate-500 outline-none transition-colors focus:border-cyan-500/50 focus:bg-white/10 disabled:opacity-50"},null,8,Be),[[$e,v.value]])]),e("div",null,[m[2]||(m[2]=e("label",{class:"mb-1.5 block text-sm font-medium text-slate-300"}," Scan Depth ",-1)),e("div",qe,[(t(),s(E,null,T(p,c=>e("button",{key:c.value,type:"button",disabled:y.scanning,onClick:o=>w.value=c.value,class:D(["flex-1 rounded-lg border px-3 py-2 text-center text-sm transition-all",w.value===c.value?"border-cyan-500/50 bg-cyan-500/10 text-cyan-400":"border-[var(--border-glass)] bg-white/5 text-slate-400 hover:bg-white/10 hover:text-slate-300",y.scanning?"opacity-50 cursor-not-allowed":"cursor-pointer"])},[e("div",ze,l(c.label),1),e("div",Ke,l(c.desc),1)],10,We)),64))])]),e("button",{type:"submit",disabled:!v.value.trim()||y.scanning,class:D(["flex w-full items-center justify-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium transition-all",!v.value.trim()||y.scanning?"cursor-not-allowed bg-white/5 text-slate-500":"bg-cyan-500/20 text-cyan-400 hover:bg-cyan-500/30"])},[y.scanning?(t(),F(d(le),{key:0,class:"h-4 w-4 animate-spin"})):(t(),F(d(ee),{key:1,class:"h-4 w-4"})),A(" "+l(y.scanning?"Scanning...":"Start Scan"),1)],10,Qe)],32)]))}}),Xe={class:"flex flex-col items-center justify-center"},Ge={key:1,class:"relative h-48 w-48"},Je={class:"relative h-48 w-48"},Ye={viewBox:"0 0 160 160",class:"h-full w-full -rotate-90"},Ze=["stroke","stroke-dashoffset"],et={class:"absolute inset-0 flex flex-col items-center justify-center"},tt=O({__name:"ShieldScore",props:{score:{},grade:{},loading:{type:Boolean}},setup(_){const x=_,y=j(!1),C=j(0);let v=null;Se(()=>{requestAnimationFrame(()=>{y.value=!0,w(x.score??0)})}),Ce(()=>x.score,c=>{c!==null&&w(c)});function w(c){v&&cancelAnimationFrame(v);const o=C.value,a=c-o,n=1e3,r=performance.now();function h(I){const M=I-r,g=Math.min(M/n,1),k=1-Math.pow(1-g,3);C.value=Math.round(o+a*k),g<1&&(v=requestAnimationFrame(h))}v=requestAnimationFrame(h)}const p=2*Math.PI*70,i=S(()=>{const c=y.value?(x.score??0)/100:0;return p*(1-c)}),u=S(()=>{const c=x.score??0;return c>=90?{stroke:"#34d399",text:"text-emerald-400"}:c>=70?{stroke:"#22d3ee",text:"text-cyan-400"}:c>=50?{stroke:"#fbbf24",text:"text-amber-400"}:{stroke:"#fb7185",text:"text-rose-400"}}),m=S(()=>{const c=x.grade;if(!c)return null;switch(c){case"A+":return{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30"};case"A":case"B+":return{bg:"bg-cyan-500/20",text:"text-cyan-400",border:"border-cyan-500/30"};case"B":case"C+":return{bg:"bg-amber-500/20",text:"text-amber-400",border:"border-amber-500/30"};case"C":case"D":case"F":return{bg:"bg-rose-500/20",text:"text-rose-400",border:"border-rose-500/30"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",border:"border-slate-500/30"}}});return(c,o)=>(t(),s("div",Xe,[_.loading?(t(),s(E,{key:0},[o[0]||(o[0]=e("div",{class:"relative h-48 w-48"},[e("div",{class:"absolute inset-0 animate-pulse rounded-full bg-white/5"})],-1)),o[1]||(o[1]=e("div",{class:"mt-3 h-6 w-16 animate-pulse rounded bg-white/5"},null,-1))],64)):_.score===null?(t(),s("div",Ge,[...o[2]||(o[2]=[e("svg",{viewBox:"0 0 160 160",class:"h-full w-full -rotate-90"},[e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"rgba(255, 255, 255, 0.05)","stroke-width":"10"})],-1),e("div",{class:"absolute inset-0 flex flex-col items-center justify-center"},[e("span",{class:"text-sm text-slate-500"},"No scan yet")],-1)])])):(t(),s(E,{key:2},[e("div",Je,[(t(),s("svg",Ye,[o[3]||(o[3]=e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"rgba(255, 255, 255, 0.05)","stroke-width":"10"},null,-1)),e("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:u.value.stroke,"stroke-width":"10","stroke-linecap":"round","stroke-dasharray":p,"stroke-dashoffset":i.value,class:"transition-[stroke-dashoffset] duration-1000 ease-out"},null,8,Ze)])),e("div",et,[e("span",{class:D(["text-4xl font-bold tabular-nums",u.value.text])},l(C.value),3),o[4]||(o[4]=e("span",{class:"text-xs text-slate-500"},"/ 100",-1))])]),m.value?(t(),s("div",{key:0,class:D(["mt-3 rounded-lg border px-4 py-1 text-lg font-bold",m.value.bg,m.value.text,m.value.border])},l(_.grade),3)):f("",!0),o[5]||(o[5]=e("p",{class:"mt-2 text-sm text-slate-500"},"Shield Score",-1))],64))]))}}),st={key:0,class:"glass-card rounded-xl p-6 text-center"},lt={key:1,class:"grid grid-cols-2 gap-3 sm:grid-cols-3 lg:grid-cols-4"},nt={class:"mb-2 flex items-center justify-between"},at={class:"text-sm font-medium text-slate-300"},ot={class:"mb-2 h-1.5 w-full overflow-hidden rounded-full bg-white/5"},rt={class:"flex items-center justify-between text-xs text-slate-500"},it={key:0,class:"text-rose-400"},dt=O({__name:"ModuleScoreCards",props:{scores:{}},setup(_){const x=_,y={tls:"TLS",ports:"Ports",cve:"CVE",headers:"Headers",dns:"DNS",creds:"Creds",owasp:"OWASP"},C=S(()=>Object.entries(x.scores).map(([w,p])=>({key:w,label:y[w]??w.toUpperCase(),...p})));function v(w){return w>=80?{bar:"bg-emerald-400",text:"text-emerald-400"}:w>=60?{bar:"bg-amber-400",text:"text-amber-400"}:{bar:"bg-rose-400",text:"text-rose-400"}}return(w,p)=>C.value.length===0?(t(),s("div",st,[...p[0]||(p[0]=[e("p",{class:"text-sm text-slate-500"},"No module scores available",-1)])])):(t(),s("div",lt,[(t(!0),s(E,null,T(C.value,i=>(t(),s("div",{key:i.key,class:"glass-card rounded-lg p-4"},[e("div",nt,[e("span",at,l(i.label),1),e("span",{class:D(["text-sm font-bold tabular-nums",v(i.score).text])},l(i.score),3)]),e("div",ot,[e("div",{class:D(["h-full rounded-full transition-all duration-700",v(i.score).bar]),style:Y({width:`${i.score}%`})},null,6)]),e("div",rt,[e("span",null,l(i.passed_checks)+"/"+l(i.total_checks)+" checks",1),i.findings_count>0?(t(),s("span",it,l(i.findings_count)+" finding"+l(i.findings_count!==1?"s":""),1)):f("",!0)])]))),128))]))}}),ct={key:0,class:"glass-card rounded-xl p-8 text-center"},ut={key:1,class:"glass-card overflow-hidden rounded-xl"},xt={class:"border-b border-[var(--border-glass)] px-4 py-3"},pt={class:"text-sm font-medium text-white"},mt={class:"ml-1 text-slate-500"},ft=["onClick"],vt={class:"flex items-center gap-1.5 truncate text-slate-300"},gt={class:"text-xs text-slate-500"},bt={class:"truncate font-mono text-xs text-slate-400"},ht={key:0,class:"font-mono text-xs text-cyan-400"},_t={key:1,class:"text-xs text-slate-600"},yt={key:0,class:"border-t border-[var(--border-glass)] bg-white/[0.02] px-6 py-4"},wt={class:"space-y-3 text-sm"},kt={class:"text-slate-300"},$t={class:"text-slate-300"},St={class:"flex flex-wrap gap-4 text-xs"},Ct={key:0},Pt={class:"ml-1 font-mono font-semibold text-white"},It={key:1},Mt={class:"ml-1 font-mono text-slate-300"},At={key:2},Dt={key:3},Nt={class:"ml-1 text-slate-300"},Et={key:4},Ft={class:"ml-1 text-slate-300"},Tt=["href"],Lt={key:0},Rt={class:"overflow-x-auto rounded-lg bg-black/30 p-3 font-mono text-xs text-slate-400"},jt=O({__name:"FindingsList",props:{findings:{}},setup(_){const x=_,y=j(null),C={critical:0,high:1,medium:2,low:3,info:4},v=S(()=>[...x.findings].sort((u,m)=>(C[u.severity]??5)-(C[m.severity]??5)));function w(u){y.value=y.value===u?null:u}function p(u){switch(u){case"critical":return{bg:"bg-rose-500/20",text:"text-rose-400",label:"CRITICAL"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"HIGH"};case"medium":return{bg:"bg-amber-500/20",text:"text-amber-400",label:"MEDIUM"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"LOW"};case"info":return{bg:"bg-slate-500/20",text:"text-slate-400",label:"INFO"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",label:u}}}function i(u){return u.target_port?`${u.target_ip}:${u.target_port}`:u.target_ip}return(u,m)=>_.findings.length===0?(t(),s("div",ct,[b(d(V),{class:"mx-auto h-10 w-10 text-emerald-400"}),m[0]||(m[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No findings",-1)),m[1]||(m[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"Your target looks secure!",-1))])):(t(),s("div",ut,[e("div",xt,[e("h3",pt,[m[2]||(m[2]=A(" Findings ",-1)),e("span",mt,"("+l(_.findings.length)+")",1)])]),m[12]||(m[12]=e("div",{class:"grid grid-cols-[100px_1fr_80px_140px_100px] gap-2 border-b border-[var(--border-glass)] px-4 py-2 text-xs font-medium text-slate-500"},[e("span",null,"Severity"),e("span",null,"Title"),e("span",null,"Module"),e("span",null,"Target"),e("span",null,"CVE")],-1)),(t(!0),s(E,null,T(v.value,c=>(t(),s("div",{key:c.id,class:"border-b border-[var(--border-glass)] last:border-0"},[e("button",{class:"grid w-full grid-cols-[100px_1fr_80px_140px_100px] items-center gap-2 px-4 py-3 text-left text-sm transition-colors hover:bg-white/5",onClick:o=>w(c.id)},[e("span",{class:D(["inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-semibold",p(c.severity).bg,p(c.severity).text])},l(p(c.severity).label),3),e("span",vt,[(t(),F(H(y.value===c.id?d(ne):d(ae)),{class:"h-3.5 w-3.5 shrink-0 text-slate-500"})),A(" "+l(c.title),1)]),e("span",gt,l(c.module),1),e("span",bt,l(i(c)),1),c.cve_id?(t(),s("span",ht,l(c.cve_id),1)):(t(),s("span",_t,"--"))],8,ft),y.value===c.id?(t(),s("div",yt,[e("div",wt,[e("div",null,[m[3]||(m[3]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Description",-1)),e("p",kt,l(c.description),1)]),e("div",null,[m[4]||(m[4]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Remediation",-1)),e("p",$t,l(c.remediation),1)]),e("div",St,[c.cvss_score!==null?(t(),s("div",Ct,[m[5]||(m[5]=e("span",{class:"text-slate-500"},"CVSS:",-1)),e("span",Pt,l(c.cvss_score),1)])):f("",!0),c.epss_score!==null?(t(),s("div",It,[m[6]||(m[6]=e("span",{class:"text-slate-500"},"EPSS:",-1)),e("span",Mt,l((c.epss_score*100).toFixed(1))+"% ",1)])):f("",!0),c.cisa_kev?(t(),s("div",At,[...m[7]||(m[7]=[e("span",{class:"rounded bg-rose-500/20 px-1.5 py-0.5 font-semibold text-rose-400"}," CISA KEV ",-1)])])):f("",!0),c.attack_technique?(t(),s("div",Dt,[m[8]||(m[8]=e("span",{class:"text-slate-500"},"Technique:",-1)),e("span",Nt,l(c.attack_technique),1)])):f("",!0),c.attack_tactic?(t(),s("div",Et,[m[9]||(m[9]=e("span",{class:"text-slate-500"},"Tactic:",-1)),e("span",Ft,l(c.attack_tactic),1)])):f("",!0),c.cve_id?(t(),s("a",{key:5,href:`https://nvd.nist.gov/vuln/detail/${c.cve_id}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center gap-1 text-cyan-400 hover:text-cyan-300"},[m[10]||(m[10]=A(" NVD ",-1)),b(d(he),{class:"h-3 w-3"})],8,Tt)):f("",!0)]),c.evidence&&Object.keys(c.evidence).length>0?(t(),s("div",Lt,[m[11]||(m[11]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Evidence",-1)),e("pre",Rt,l(JSON.stringify(c.evidence,null,2)),1)])):f("",!0)])])):f("",!0)]))),128))]))}}),Ot={key:0,class:"glass-card rounded-xl p-8 text-center"},Vt={key:1,class:"glass-card rounded-xl p-5"},Ht={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},Bt={class:"mb-4 flex items-center gap-4 text-sm"},qt={class:"text-slate-400"},Wt={class:"font-mono font-semibold text-white"},zt={key:0,class:"flex items-center gap-1 text-rose-400"},Kt={class:"font-mono font-semibold"},Qt={key:1,class:"flex items-center gap-1 text-emerald-400"},Ut={class:"grid gap-5 lg:grid-cols-2"},Xt={class:"flex flex-wrap gap-2"},Gt={class:"font-mono font-bold"},Jt={class:"opacity-75"},Yt={key:0},Zt={class:"space-y-2"},es={class:"flex items-start gap-2"},ts={class:"min-w-0"},ss={class:"flex items-center gap-2"},ls={class:"font-mono text-sm font-bold text-rose-400"},ns={class:"text-xs text-slate-400"},as={key:0,class:"mt-1 text-xs text-slate-400"},os={key:1,class:"mt-1 text-xs text-slate-500"},rs={key:1,class:"flex items-center justify-center rounded-lg border border-emerald-500/10 bg-emerald-500/5 p-6"},is={class:"text-center"},ds=O({__name:"PortScanResults",props:{findings:{}},setup(_){const x=_,y=new Set([80,443]),C=new Set([21,23,135,139,445,1433,1521,3306,3389,5432,5900,6379,8443,27017]),v=new Set([22,25,53,110,143,587,993,995,8080,8443]),w={21:"FTP",22:"SSH",23:"Telnet",25:"SMTP",53:"DNS",80:"HTTP",110:"POP3",135:"MSRPC",139:"NetBIOS",143:"IMAP",443:"HTTPS",445:"SMB",587:"Submission",993:"IMAPS",995:"POP3S",1433:"MSSQL",1521:"Oracle",3306:"MySQL",3389:"RDP",5432:"PostgreSQL",5900:"VNC",6379:"Redis",8080:"HTTP-Alt",8443:"HTTPS-Alt",27017:"MongoDB"};function p(a){return C.has(a)?"dangerous":y.has(a)?"safe":(v.has(a),"common")}const i=S(()=>{var r;const a=[],n=new Set;for(const h of x.findings){const I=h.target_port;if(I!==null&&!n.has(I)){n.add(I);const M=(r=h.evidence)==null?void 0:r.service;a.push({port:I,service:M||w[I]||"Unknown",risk:p(I),finding:h})}}return a.sort((h,I)=>h.port-I.port)}),u=S(()=>i.value.filter(a=>a.risk==="dangerous")),m=S(()=>i.value.length),c=S(()=>u.value.length);function o(a){switch(a){case"safe":return"border-emerald-500/30 bg-emerald-500/10 text-emerald-400";case"common":return"border-amber-500/30 bg-amber-500/10 text-amber-400";case"dangerous":return"border-rose-500/30 bg-rose-500/10 text-rose-400"}}return(a,n)=>_.findings.length===0?(t(),s("div",Ot,[b(d(V),{class:"mx-auto h-10 w-10 text-emerald-400"}),n[0]||(n[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No port findings",-1)),n[1]||(n[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"No open ports detected or port scan was not run.",-1))])):(t(),s("div",Vt,[e("h3",Ht,[b(d(Z),{class:"h-4 w-4 text-cyan-400"}),n[2]||(n[2]=A(" Port Scan Results ",-1))]),e("div",Bt,[e("span",qt,[e("span",Wt,l(m.value),1),A(" port"+l(m.value!==1?"s":"")+" open ",1)]),c.value>0?(t(),s("span",zt,[b(d(te),{class:"h-3.5 w-3.5"}),e("span",Kt,l(c.value),1),n[3]||(n[3]=A(" dangerous ",-1))])):(t(),s("span",Qt,[b(d(V),{class:"h-3.5 w-3.5"}),n[4]||(n[4]=A(" No dangerous ports ",-1))]))]),e("div",Ut,[e("div",null,[n[5]||(n[5]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Open Ports",-1)),e("div",Xt,[(t(!0),s(E,null,T(i.value,r=>(t(),s("div",{key:r.port,class:D(["inline-flex items-center gap-1.5 rounded-md border px-2.5 py-1 text-xs font-medium",o(r.risk)])},[e("span",Gt,l(r.port),1),e("span",Jt,l(r.service),1)],2))),128))])]),u.value.length>0?(t(),s("div",Yt,[n[6]||(n[6]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Dangerous Ports",-1)),e("div",Zt,[(t(!0),s(E,null,T(u.value,r=>{var h;return t(),s("div",{key:r.port,class:"rounded-lg border border-rose-500/20 bg-rose-500/5 p-3"},[e("div",es,[b(d(z),{class:"mt-0.5 h-4 w-4 shrink-0 text-rose-400"}),e("div",ts,[e("div",ss,[e("span",ls," Port "+l(r.port),1),e("span",ns,l(r.service),1)]),r.finding?(t(),s("p",as,l(r.finding.description),1)):f("",!0),(h=r.finding)!=null&&h.remediation?(t(),s("p",os,l(r.finding.remediation),1)):f("",!0)])])])}),128))])])):(t(),s("div",rs,[e("div",is,[b(d(V),{class:"mx-auto h-8 w-8 text-emerald-400"}),n[7]||(n[7]=e("p",{class:"mt-2 text-sm text-emerald-400"},"No dangerous ports detected",-1))])]))])]))}}),cs={key:0,class:"glass-card rounded-xl p-8 text-center"},us={key:1,class:"glass-card rounded-xl p-5"},xs={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},ps={class:"mb-4 text-sm text-slate-400"},ms={class:"font-mono font-semibold text-white"},fs={class:"divide-y divide-[var(--border-glass)]"},vs=["onClick"],gs={key:0,class:"border-t border-[var(--border-glass)] bg-white/[0.02] px-4 py-3"},bs={class:"space-y-2 text-sm"},hs={class:"text-slate-300"},_s={class:"text-slate-300"},ys=O({__name:"HeadersChecklist",props:{findings:{}},setup(_){const x=_,y=[{name:"Strict-Transport-Security (HSTS)",key:"strict-transport-security"},{name:"Content-Security-Policy (CSP)",key:"content-security-policy"},{name:"X-Frame-Options",key:"x-frame-options"},{name:"X-Content-Type-Options",key:"x-content-type-options"},{name:"Referrer-Policy",key:"referrer-policy"},{name:"Permissions-Policy",key:"permissions-policy"},{name:"Server",key:"server"},{name:"X-Powered-By",key:"x-powered-by"}],C=new Set(["server","x-powered-by"]),v=j(null);function w(o){v.value=v.value===o?null:o}const p=S(()=>y.map(o=>{const a=x.findings.find(I=>{const M=I.title.toLowerCase(),g=o.key.toLowerCase();return M.includes(g)||M.includes(o.name.toLowerCase().split(" (")[0]??"")});if(!a)return{name:o.name,key:o.key,status:"present",severity:null,finding:null};const n=C.has(o.key),r=a.title.toLowerCase(),h=n&&(r.includes("leak")||r.includes("exposed")||r.includes("server header"));return{name:o.name,key:o.key,status:h?"info_leak":"missing",severity:a.severity,finding:a}})),i=S(()=>p.value.filter(o=>o.status==="present").length),u=S(()=>p.value.length);function m(o){switch(o){case"present":return{icon:V,text:"text-emerald-400",label:"Present"};case"missing":return{icon:K,text:"text-rose-400",label:"Missing"};case"info_leak":return{icon:te,text:"text-amber-400",label:"Info Leak"}}}function c(o){switch(o){case"critical":return{bg:"bg-rose-500/20",text:"text-rose-400",label:"CRITICAL"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"HIGH"};case"medium":return{bg:"bg-amber-500/20",text:"text-amber-400",label:"MEDIUM"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"LOW"};case"info":return{bg:"bg-slate-500/20",text:"text-slate-400",label:"INFO"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",label:o}}}return(o,a)=>_.findings.length===0&&p.value.every(n=>n.status==="present")?(t(),s("div",cs,[b(d(U),{class:"mx-auto h-10 w-10 text-emerald-400"}),a[0]||(a[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"All headers present",-1)),a[1]||(a[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"All recommended security headers are configured correctly.",-1))])):(t(),s("div",us,[e("h3",xs,[b(d(U),{class:"h-4 w-4 text-cyan-400"}),a[2]||(a[2]=A(" Security Headers Checklist ",-1))]),e("div",ps,[e("span",ms,l(i.value),1),A(" / "+l(u.value)+" headers configured ",1)]),e("div",fs,[(t(!0),s(E,null,T(p.value,n=>(t(),s("div",{key:n.key},[e("button",{class:D(["flex w-full items-center gap-3 px-2 py-3 text-left text-sm transition-colors hover:bg-white/5",{"cursor-default":!n.finding}]),onClick:r=>n.finding?w(n.key):void 0},[(t(),F(H(m(n.status).icon),{class:D(["h-4 w-4 shrink-0",m(n.status).text])},null,8,["class"])),e("span",{class:D(["flex-1 font-mono text-xs",n.status==="present"?"text-emerald-400":n.status==="info_leak"?"text-amber-400":"text-rose-400"])},l(n.name),3),e("span",{class:D(["text-xs",m(n.status).text])},l(m(n.status).label),3),n.severity?(t(),s("span",{key:0,class:D(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold",c(n.severity).bg,c(n.severity).text])},l(c(n.severity).label),3)):f("",!0),n.finding?(t(),F(H(v.value===n.key?d(ne):d(ae)),{key:1,class:"h-3.5 w-3.5 shrink-0 text-slate-500"})):f("",!0)],10,vs),n.finding&&v.value===n.key?(t(),s("div",gs,[e("div",bs,[e("div",null,[a[3]||(a[3]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Description",-1)),e("p",hs,l(n.finding.description),1)]),e("div",null,[a[4]||(a[4]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Remediation",-1)),e("p",_s,l(n.finding.remediation),1)])])])):f("",!0)]))),128))])]))}}),ws={key:0,class:"glass-card rounded-xl p-8 text-center"},ks={key:1,class:"glass-card rounded-xl p-5"},$s={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},Ss={class:"grid gap-5 lg:grid-cols-2"},Cs={class:"mb-3 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},Ps={class:"space-y-2"},Is={class:"min-w-0 flex-1"},Ms={class:"text-sm font-medium text-white"},As={class:"truncate text-xs text-slate-500"},Ds={class:"mt-3"},Ns={class:"text-xs text-slate-500"},Es={class:"mb-3 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},Fs={class:"flex items-center gap-3 rounded-lg border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2.5"},Ts={class:"min-w-0 flex-1"},Ls={class:"truncate text-xs text-slate-500"},Rs={class:"mt-4"},js={class:"rounded-lg border border-[var(--border-glass)] bg-white/[0.02] p-4 text-center"},Os={class:"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-white/5"},Vs={key:0,class:"mt-4"},Hs={class:"space-y-1.5"},Bs={class:"text-slate-300"},qs={class:"mt-0.5 text-slate-500"},Ws=O({__name:"DnsSecurityCard",props:{findings:{}},setup(_){const x=_;function y(r){return x.findings.find(h=>h.title.toLowerCase().includes(r.toLowerCase()))??null}const C=S(()=>{const r=y("SPF");return r?{name:"SPF",key:"spf",status:r.severity==="info"?"pass":"fail",detail:r.title,finding:r}:{name:"SPF",key:"spf",status:"pass",detail:"SPF record configured",finding:null}}),v=S(()=>{const r=y("DKIM");return r?{name:"DKIM",key:"dkim",status:r.severity==="info"?"pass":r.severity==="low"?"warn":"fail",detail:r.title,finding:r}:{name:"DKIM",key:"dkim",status:"pass",detail:"DKIM record configured",finding:null}}),w=S(()=>{var M;const r=y("DMARC");if(!r)return{name:"DMARC",key:"dmarc",status:"pass",detail:"DMARC policy active",finding:null};const h=((M=r.evidence)==null?void 0:M.policy)??"";return{name:"DMARC",key:"dmarc",status:h==="none"?"fail":h==="quarantine"?"warn":"fail",detail:r.title,finding:r}}),p=S(()=>{const r=y("CAA");return r?{name:"CAA",key:"caa",status:r.severity==="low"?"warn":"fail",detail:r.title,finding:r}:{name:"CAA",key:"caa",status:"pass",detail:"CAA record present",finding:null}}),i=S(()=>[C.value,v.value,w.value,p.value]),u=S(()=>{var h;const r=w.value.finding;return r?((h=r.evidence)==null?void 0:h.policy)??"none":"reject"});function m(r){switch(r){case"reject":return{icon:U,color:"text-emerald-400",bg:"bg-emerald-500/10",border:"border-emerald-500/20",label:"Reject"};case"quarantine":return{icon:z,color:"text-amber-400",bg:"bg-amber-500/10",border:"border-amber-500/20",label:"Quarantine"};default:return{icon:je,color:"text-rose-400",bg:"bg-rose-500/10",border:"border-rose-500/20",label:"None"}}}const c=S(()=>{let r=0;return C.value.status==="pass"&&(r+=30),v.value.status==="pass"?r+=30:v.value.status==="warn"&&(r+=15),w.value.status==="pass"?r+=30:w.value.status==="warn"&&(r+=15),p.value.status==="pass"?r+=10:p.value.status==="warn"&&(r+=5),r});function o(r){switch(r){case"pass":return V;case"warn":return z;case"fail":return K}}function a(r){switch(r){case"pass":return"text-emerald-400";case"warn":return"text-amber-400";case"fail":return"text-rose-400"}}function n(r){return r>=80?"text-emerald-400":r>=50?"text-amber-400":"text-rose-400"}return(r,h)=>_.findings.length===0&&i.value.every(I=>I.status==="pass")?(t(),s("div",ws,[b(d(U),{class:"mx-auto h-10 w-10 text-emerald-400"}),h[0]||(h[0]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"DNS security configured",-1)),h[1]||(h[1]=e("p",{class:"mt-1 text-sm text-slate-400"},"All DNS security records are properly configured.",-1))])):(t(),s("div",ks,[e("h3",$s,[b(d(Ie),{class:"h-4 w-4 text-cyan-400"}),h[2]||(h[2]=A(" DNS Security ",-1))]),e("div",Ss,[e("div",null,[e("h4",Cs,[b(d(Le),{class:"h-3.5 w-3.5"}),h[3]||(h[3]=A(" Email Authentication ",-1))]),e("div",Ps,[(t(!0),s(E,null,T([C.value,v.value,w.value],I=>(t(),s("div",{key:I.key,class:"flex items-center gap-3 rounded-lg border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2.5"},[(t(),F(H(o(I.status)),{class:D(["h-4 w-4 shrink-0",a(I.status)])},null,8,["class"])),e("div",Is,[e("span",Ms,l(I.name),1),e("p",As,l(I.detail),1)])]))),128))]),e("div",Ds,[h[4]||(h[4]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"DMARC Policy",-1)),e("div",{class:D(["flex items-center gap-2 rounded-lg border p-3",m(u.value).bg,m(u.value).border])},[(t(),F(H(m(u.value).icon),{class:D(["h-5 w-5",m(u.value).color])},null,8,["class"])),e("div",null,[e("span",{class:D(["text-sm font-semibold",m(u.value).color])}," p="+l(u.value),3),e("p",Ns,l(u.value==="reject"?"Unauthorized emails are rejected":u.value==="quarantine"?"Unauthorized emails are quarantined":"No enforcement - emails pass through"),1)])],2)])]),e("div",null,[e("h4",Es,[b(d(ee),{class:"h-3.5 w-3.5"}),h[5]||(h[5]=A(" Certificate Authority ",-1))]),e("div",Fs,[(t(),F(H(o(p.value.status)),{class:D(["h-4 w-4 shrink-0",a(p.value.status)])},null,8,["class"])),e("div",Ts,[h[6]||(h[6]=e("span",{class:"text-sm font-medium text-white"},"CAA Record",-1)),e("p",Ls,l(p.value.detail),1)])]),e("div",Rs,[h[8]||(h[8]=e("h4",{class:"mb-3 text-xs font-medium uppercase text-slate-500"},"Email Security Score",-1)),e("div",js,[e("span",{class:D(["text-3xl font-bold tabular-nums",n(c.value)])},l(c.value),3),h[7]||(h[7]=e("span",{class:"text-sm text-slate-500"}," / 100",-1)),e("div",Os,[e("div",{class:D(["h-full rounded-full transition-all duration-700",c.value>=80?"bg-emerald-400":c.value>=50?"bg-amber-400":"bg-rose-400"]),style:Y({width:`${c.value}%`})},null,6)])])]),_.findings.length>0?(t(),s("div",Vs,[h[9]||(h[9]=e("h4",{class:"mb-2 text-xs font-medium uppercase text-slate-500"},"Issues Found",-1)),e("div",Hs,[(t(!0),s(E,null,T(_.findings,I=>(t(),s("div",{key:I.id,class:"rounded border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs"},[e("span",Bs,l(I.title),1),e("p",qs,l(I.remediation),1)]))),128))])])):f("",!0)])])]))}}),zs={class:"glass-card rounded-xl p-5"},Ks={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},Qs={class:"relative ml-3"},Us={class:"min-w-0 flex-1 -mt-0.5"},Xs={class:"flex items-center gap-2"},Gs={key:0,class:"rounded bg-white/5 px-1.5 py-0.5 font-mono text-xs text-slate-500"},Js={key:0,class:"mt-0.5 block font-mono text-xs text-slate-600"},Ys=O({__name:"ShieldTimeline",props:{scan:{}},setup(_){const x=_,y={tls:"TLS / SSL Check",ports:"Port Scan",headers:"HTTP Headers",dns:"DNS Security",cve:"CVE Matching",creds:"Credential Testing",owasp:"OWASP Probes"};function C(c){return c?new Date(c).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--"}function v(c,o,a){return!a||a<=0?null:`${(a/o).toFixed(1)}s`}const w=S(()=>{const c=[],o=x.scan;c.push({key:"created",label:"Scan created",timestamp:o.created_at,status:"completed",duration:null,type:"start"});const a=o.modules_enabled,n=o.status==="completed",r=o.status==="failed",h=o.status==="running";return a.forEach((I,M)=>{let g="pending";n?g="completed":r?M===a.length-1?g="failed":g="completed":h&&(g=M===0?"running":"pending"),c.push({key:`module-${I}`,label:y[I]??I.toUpperCase(),timestamp:n||g==="completed"?o.started_at:null,status:g,duration:n?v(M,a.length,o.duration_seconds):null,type:"module"})}),n?c.push({key:"completed",label:"Scan completed",timestamp:o.completed_at,status:"completed",duration:o.duration_seconds?`${o.duration_seconds}s total`:null,type:"end"}):r?c.push({key:"failed",label:"Scan failed",timestamp:o.completed_at,status:"failed",duration:null,type:"end"}):c.push({key:"pending",label:"Awaiting completion",timestamp:null,status:"pending",duration:null,type:"end"}),c});function p(c){if(c.type==="start")return Re;if(c.type==="end")return Te;switch(c.status){case"completed":return V;case"running":return le;case"failed":return K;default:return ve}}function i(c){switch(c.status){case"completed":return"text-cyan-400";case"running":return"text-cyan-400 animate-spin";case"failed":return"text-rose-400";default:return"text-slate-600"}}function u(c){switch(c.status){case"completed":return"bg-cyan-500/40";case"running":return"bg-cyan-500/20";case"failed":return"bg-rose-500/40";default:return"bg-slate-700"}}function m(c){return c.status==="completed"?"shadow-[0_0_6px_rgba(34,211,238,0.4)]":c.status==="running"?"shadow-[0_0_8px_rgba(34,211,238,0.6)]":""}return(c,o)=>(t(),s("div",zs,[e("h3",Ks,[b(d(ve),{class:"h-4 w-4 text-cyan-400"}),o[0]||(o[0]=A(" Scan Timeline ",-1))]),e("div",Qs,[(t(!0),s(E,null,T(w.value,(a,n)=>(t(),s("div",{key:a.key,class:"relative flex gap-4 pb-6 last:pb-0"},[n<w.value.length-1?(t(),s("div",{key:0,class:D(["absolute left-[7px] top-5 w-0.5",u(w.value[n+1]??a)]),style:{height:"calc(100% - 8px)"}},null,2)):f("",!0),e("div",{class:D(["relative z-10 flex h-4 w-4 shrink-0 items-center justify-center rounded-full",m(a)])},[(t(),F(H(p(a)),{class:D(["h-4 w-4",i(a)])},null,8,["class"]))],2),e("div",Us,[e("div",Xs,[e("span",{class:D(["text-sm font-medium",a.status==="completed"?"text-white":a.status==="running"?"text-cyan-400":a.status==="failed"?"text-rose-400":"text-slate-500"])},l(a.label),3),a.duration?(t(),s("span",Gs,l(a.duration),1)):f("",!0)]),a.timestamp?(t(),s("span",Js,l(C(a.timestamp)),1)):f("",!0)])]))),128))])]))}}),Zs={key:0,class:"glass-card rounded-xl p-8 text-center"},el={key:1,class:"glass-card overflow-hidden rounded-xl"},tl={class:"border-b border-[var(--border-glass)] px-4 py-3"},sl={class:"flex flex-wrap items-center gap-4 text-sm"},ll={class:"font-semibold text-white flex items-center gap-2"},nl={class:"text-slate-400"},al={class:"font-mono font-semibold text-white"},ol={key:0,class:"text-rose-400"},rl={class:"font-mono font-semibold"},il={key:1,class:"flex items-center gap-1 text-red-400"},dl={class:"font-mono font-semibold"},cl={class:"flex flex-wrap items-center gap-3 border-b border-[var(--border-glass)] px-4 py-2.5"},ul={class:"flex items-center gap-1.5 text-xs text-slate-500"},xl={class:"flex gap-1"},pl=["onClick"],ml={class:"flex items-center gap-1.5 text-xs text-slate-500"},fl={class:"flex gap-1"},vl=["onClick"],gl=["onClick"],bl=["href"],hl={key:1,class:"text-xs text-slate-600"},_l={class:"flex items-center gap-1.5"},yl={class:"h-1.5 w-16 overflow-hidden rounded-full bg-white/5"},wl={class:"font-mono text-xs text-slate-400"},kl={key:2,class:"flex items-center gap-1 text-red-400"},$l={key:3},Sl={class:"flex items-center gap-1.5 truncate text-slate-300"},Cl={key:0,class:"border-t border-[var(--border-glass)] bg-white/[0.02] px-6 py-4"},Pl={class:"space-y-3 text-sm"},Il={class:"text-slate-300"},Ml={class:"text-slate-300"},Al={class:"flex flex-wrap gap-4 text-xs"},Dl={key:0},Nl={class:"ml-1 font-mono text-slate-300"},El={key:1},Fl={class:"ml-1 text-slate-300"},Tl={key:2},Ll={class:"ml-1 text-slate-300"},Rl={key:3},jl={key:0},Ol={class:"overflow-x-auto rounded-lg bg-black/30 p-3 font-mono text-xs text-slate-400"},Vl={key:0,class:"px-4 py-6 text-center text-sm text-slate-500"},Hl=O({__name:"CveFindings",props:{findings:{}},setup(_){const x=_,y=j("severity"),C=j(null),v=j(new Set(["critical","high","medium","low","info"])),w={critical:0,high:1,medium:2,low:3,info:4},p=S(()=>[...x.findings.filter(g=>v.value.has(g.severity))].sort((g,k)=>{switch(y.value){case"cvss":return(k.cvss_score??0)-(g.cvss_score??0);case"epss":return(k.epss_score??0)-(g.epss_score??0);default:return(w[g.severity]??5)-(w[k.severity]??5)}})),i=S(()=>x.findings.filter(M=>M.severity==="critical").length),u=S(()=>x.findings.filter(M=>M.cisa_kev).length);function m(M){C.value=C.value===M?null:M}function c(M){const g=new Set(v.value);g.has(M)?g.delete(M):g.add(M),v.value=g}function o(M){return M===null?{bg:"bg-slate-500/20",text:"text-slate-400",label:"N/A"}:M>=9?{bg:"bg-red-500/20",text:"text-red-400",label:"Critical"}:M>=7?{bg:"bg-rose-500/20",text:"text-rose-400",label:"High"}:M>=4?{bg:"bg-amber-500/20",text:"text-amber-400",label:"Medium"}:{bg:"bg-slate-500/20",text:"text-slate-400",label:"Low"}}function a(M){switch(M){case"critical":return{bg:"bg-rose-500/20",text:"text-rose-400",label:"CRITICAL"};case"high":return{bg:"bg-orange-500/20",text:"text-orange-400",label:"HIGH"};case"medium":return{bg:"bg-amber-500/20",text:"text-amber-400",label:"MEDIUM"};case"low":return{bg:"bg-blue-500/20",text:"text-blue-400",label:"LOW"};case"info":return{bg:"bg-slate-500/20",text:"text-slate-400",label:"INFO"};default:return{bg:"bg-slate-500/20",text:"text-slate-400",label:M}}}function n(M){return M===null?0:Math.round(M*100)}function r(M){return M===null?"bg-slate-500":M>=.7?"bg-red-400":M>=.4?"bg-amber-400":"bg-cyan-400"}const h=[{value:"severity",label:"Severity"},{value:"cvss",label:"CVSS Score"},{value:"epss",label:"EPSS Score"}],I=["critical","high","medium","low","info"];return(M,g)=>_.findings.length===0?(t(),s("div",Zs,[b(d(V),{class:"mx-auto h-10 w-10 text-emerald-400"}),g[1]||(g[1]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No CVEs Detected",-1)),g[2]||(g[2]=e("p",{class:"mt-1 text-sm text-slate-400"},"No known vulnerabilities were found for the target services.",-1))])):(t(),s("div",el,[e("div",tl,[e("div",sl,[e("h3",ll,[b(d(z),{class:"h-4 w-4 text-rose-400"}),g[3]||(g[3]=A(" CVE Intelligence ",-1))]),e("span",nl,[e("span",al,l(_.findings.length),1),A(" CVE"+l(_.findings.length!==1?"s":"")+" found ",1)]),i.value>0?(t(),s("span",ol,[e("span",rl,l(i.value),1),g[4]||(g[4]=A(" critical ",-1))])):f("",!0),u.value>0?(t(),s("span",il,[b(d(z),{class:"h-3.5 w-3.5"}),e("span",dl,l(u.value),1),g[5]||(g[5]=A(" actively exploited (KEV) ",-1))])):f("",!0)])]),e("div",cl,[e("div",ul,[b(d(Me),{class:"h-3.5 w-3.5"}),g[6]||(g[6]=e("span",null,"Sort:",-1)),e("div",xl,[(t(),s(E,null,T(h,k=>e("button",{key:k.value,class:D(["rounded px-2 py-0.5 transition-colors",y.value===k.value?"bg-cyan-500/20 text-cyan-400":"text-slate-400 hover:bg-white/5 hover:text-slate-300"]),onClick:B=>y.value=k.value},l(k.label),11,pl)),64))])]),g[8]||(g[8]=e("span",{class:"text-slate-700"},"|",-1)),e("div",ml,[b(d(Fe),{class:"h-3.5 w-3.5"}),g[7]||(g[7]=e("span",null,"Filter:",-1)),e("div",fl,[(t(),s(E,null,T(I,k=>e("button",{key:k,class:D(["rounded px-2 py-0.5 transition-colors",v.value.has(k)?`${a(k).bg} ${a(k).text}`:"text-slate-600 hover:text-slate-400"]),onClick:B=>c(k)},l(k),11,vl)),64))])])]),g[17]||(g[17]=e("div",{class:"hidden md:grid grid-cols-[110px_70px_120px_70px_90px_1fr] gap-2 border-b border-[var(--border-glass)] px-4 py-2 text-xs font-medium text-slate-500"},[e("span",null,"CVE ID"),e("span",null,"CVSS"),e("span",null,"EPSS"),e("span",null,"KEV"),e("span",null,"Severity"),e("span",null,"Title")],-1)),(t(!0),s(E,null,T(p.value,k=>(t(),s("div",{key:k.id,class:"border-b border-[var(--border-glass)] last:border-0"},[e("button",{class:"w-full px-4 py-3 text-left text-sm transition-colors hover:bg-white/5 md:grid md:grid-cols-[110px_70px_120px_70px_90px_1fr] md:items-center md:gap-2",onClick:B=>m(k.id)},[k.cve_id?(t(),s("a",{key:0,href:`https://nvd.nist.gov/vuln/detail/${k.cve_id}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center gap-1 font-mono text-xs font-semibold text-cyan-400 hover:text-cyan-300",onClick:g[0]||(g[0]=se(()=>{},["stop"]))},[A(l(k.cve_id)+" ",1),b(d(he),{class:"h-2.5 w-2.5"})],8,bl)):(t(),s("span",hl,"--")),e("span",{class:D(["inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-bold tabular-nums",o(k.cvss_score).bg,o(k.cvss_score).text])},l(k.cvss_score!==null?k.cvss_score.toFixed(1):"N/A"),3),e("div",_l,[e("div",yl,[e("div",{class:D(["h-full rounded-full transition-all",r(k.epss_score)]),style:Y({width:`${n(k.epss_score)}%`})},null,6)]),e("span",wl,l(k.epss_score!==null?`${n(k.epss_score)}%`:"--"),1)]),k.cisa_kev?(t(),s("span",kl,[b(d(z),{class:"h-3.5 w-3.5"}),g[9]||(g[9]=e("span",{class:"text-[10px] font-semibold uppercase"},"KEV",-1))])):(t(),s("span",$l,[b(d(U),{class:"h-3.5 w-3.5 text-slate-600"})])),e("span",{class:D(["inline-flex w-fit items-center rounded-full px-2 py-0.5 text-xs font-semibold",a(k.severity).bg,a(k.severity).text])},l(a(k.severity).label),3),e("span",Sl,[(t(),F(H(C.value===k.id?d(ne):d(ae)),{class:"h-3.5 w-3.5 shrink-0 text-slate-500"})),A(" "+l(k.title),1)])],8,gl),C.value===k.id?(t(),s("div",Cl,[e("div",Pl,[e("div",null,[g[10]||(g[10]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Description",-1)),e("p",Il,l(k.description),1)]),e("div",null,[g[11]||(g[11]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Remediation",-1)),e("p",Ml,l(k.remediation),1)]),e("div",Al,[k.target_port?(t(),s("div",Dl,[g[12]||(g[12]=e("span",{class:"text-slate-500"},"Port:",-1)),e("span",Nl,l(k.target_ip)+":"+l(k.target_port),1)])):f("",!0),k.attack_technique?(t(),s("div",El,[g[13]||(g[13]=e("span",{class:"text-slate-500"},"Technique:",-1)),e("span",Fl,l(k.attack_technique),1)])):f("",!0),k.attack_tactic?(t(),s("div",Tl,[g[14]||(g[14]=e("span",{class:"text-slate-500"},"Tactic:",-1)),e("span",Ll,l(k.attack_tactic),1)])):f("",!0),k.cisa_kev?(t(),s("div",Rl,[...g[15]||(g[15]=[e("span",{class:"rounded bg-red-500/20 px-1.5 py-0.5 font-semibold text-red-400"}," Actively Exploited ",-1)])])):f("",!0)]),k.evidence&&Object.keys(k.evidence).length>0?(t(),s("div",jl,[g[16]||(g[16]=e("h4",{class:"mb-1 text-xs font-medium uppercase text-slate-500"},"Evidence",-1)),e("pre",Ol,l(JSON.stringify(k.evidence,null,2)),1)])):f("",!0)])])):f("",!0)]))),128)),p.value.length===0&&_.findings.length>0?(t(),s("div",Vl," No CVEs match the current filter. Adjust filters to see results. ")):f("",!0)]))}}),Bl={class:"space-y-4"},ql={class:"glass-card rounded-lg px-4 py-3 flex items-center justify-between"},Wl={class:"flex items-center gap-2"},zl={class:"text-sm text-slate-300"},Kl={class:"flex items-center gap-3 text-xs"},Ql={key:0,class:"text-rose-400"},Ul={key:1,class:"text-amber-400"},Xl={key:0,class:"glass-card rounded-xl p-8 text-center"},Gl={key:1,class:"grid gap-3 sm:grid-cols-2"},Jl={class:"flex items-start justify-between"},Yl={class:"text-sm font-medium text-white"},Zl={class:"mt-1 text-xs text-slate-400"},en={key:0,class:"mt-3 rounded bg-black/30 p-2 font-mono text-xs text-slate-400"},tn={key:0},sn={key:1},ln={key:2},nn={key:1,class:"mt-2 text-xs text-cyan-400/80"},an=O({__name:"CredentialFindings",props:{findings:{}},setup(_){const x=_,y=S(()=>x.findings.filter(p=>p.severity==="critical").length),C=S(()=>x.findings.filter(p=>p.severity==="high").length);function v(p){const i={critical:"bg-rose-500/20 text-rose-400",high:"bg-amber-500/20 text-amber-400",medium:"bg-yellow-500/20 text-yellow-400",low:"bg-blue-500/20 text-blue-400",info:"bg-slate-500/20 text-slate-400"};return i[p]||i.info}function w(p){const i={critical:"border-rose-500/50",high:"border-amber-500/50",medium:"border-yellow-500/50",low:"border-blue-500/50",info:"border-slate-500/50"};return i[p]||i.info}return(p,i)=>(t(),s("div",Bl,[e("div",ql,[e("div",Wl,[b(d(Ae),{class:"h-4 w-4 text-amber-400"}),e("span",zl,l(_.findings.length)+" credential "+l(_.findings.length===1?"issue":"issues")+" found ",1)]),e("div",Kl,[y.value>0?(t(),s("span",Ql,l(y.value)+" critical",1)):f("",!0),C.value>0?(t(),s("span",Ul,l(C.value)+" high",1)):f("",!0)])]),_.findings.length===0?(t(),s("div",Xl,[b(d(U),{class:"mx-auto h-10 w-10 text-emerald-400"}),i[0]||(i[0]=e("h3",{class:"mt-3 text-sm font-medium text-white"},"No Default Credentials Found",-1)),i[1]||(i[1]=e("p",{class:"mt-1 text-xs text-slate-500"},"All tested services require proper authentication",-1))])):(t(),s("div",Gl,[(t(!0),s(E,null,T(_.findings,u=>(t(),s("div",{key:u.id,class:D(["glass-card rounded-lg p-4 border-l-2",w(u.severity)])},[e("div",Jl,[e("div",null,[e("h4",Yl,l(u.title),1),e("p",Zl,l(u.description),1)]),e("span",{class:D(["ml-2 inline-flex shrink-0 items-center rounded-full px-2 py-0.5 text-[10px] font-semibold uppercase",v(u.severity)])},l(u.severity),3)]),u.evidence&&Object.keys(u.evidence).length>0?(t(),s("div",en,[u.evidence.service?(t(),s("div",tn," Service: "+l(u.evidence.service),1)):f("",!0),u.evidence.port?(t(),s("div",sn," Port: "+l(u.evidence.port),1)):f("",!0),u.evidence.path?(t(),s("div",ln," Path: "+l(u.evidence.path),1)):f("",!0)])):f("",!0),u.remediation?(t(),s("p",nn,l(u.remediation),1)):f("",!0)],2))),128))]))]))}}),on={class:"space-y-4"},rn={class:"glass-card rounded-lg px-4 py-3 flex items-center justify-between"},dn={class:"flex items-center gap-2"},cn={class:"flex items-center gap-3 text-xs"},un={class:"flex items-center gap-1 text-emerald-400"},xn={key:0,class:"flex items-center gap-1 text-rose-400"},pn={class:"glass-card divide-y divide-white/5 rounded-xl"},mn={class:"min-w-0 flex-1"},fn={key:0,class:"mt-0.5 text-xs text-slate-500"},vn={key:0,class:"space-y-3"},gn={class:"flex items-start justify-between"},bn={class:"text-sm font-medium text-white"},hn={class:"mt-1 text-xs text-slate-400"},_n={key:0,class:"mt-2 rounded bg-black/30 p-2 font-mono text-xs text-slate-400"},yn={key:1,class:"mt-2 text-xs text-cyan-400/80"},wn=O({__name:"OwaspResults",props:{findings:{}},setup(_){const x=_,y=["SQL Injection","Cross-Site Scripting (XSS)","Directory Traversal","Information Disclosure","Open Redirect"],C={"SQL Injection":["sql injection","sqli"],"Cross-Site Scripting (XSS)":["cross-site scripting","xss"],"Directory Traversal":["directory traversal","path traversal","lfi"],"Information Disclosure":["information disclosure","info_disclosure","exposed","git repository"],"Open Redirect":["open redirect","redirect"]};function v(o,a){const n=o.title.toLowerCase(),r=o.evidence,h=r==null?void 0:r.probe;return a.some(I=>n.includes(I)||h&&h.toLowerCase().includes(I))}const w=S(()=>y.map(o=>{const a=C[o]??[o.toLowerCase()],n=x.findings.find(r=>v(r,a))??null;return{name:o,passed:n===null,finding:n}})),p=S(()=>w.value.filter(o=>o.passed).length),i=S(()=>w.value.filter(o=>!o.passed).length),u=S(()=>x.findings.filter(o=>o.severity!=="info"));function m(o){const a={critical:"text-rose-400",high:"text-amber-400",medium:"text-yellow-400",low:"text-blue-400",info:"text-slate-400"};return a[o]||a.info}function c(o){const a={critical:"bg-rose-500/20 text-rose-400",high:"bg-amber-500/20 text-amber-400",medium:"bg-yellow-500/20 text-yellow-400",low:"bg-blue-500/20 text-blue-400",info:"bg-slate-500/20 text-slate-400"};return a[o]||a.info}return(o,a)=>(t(),s("div",on,[e("div",rn,[e("div",dn,[b(d(be),{class:"h-4 w-4 text-purple-400"}),a[0]||(a[0]=e("span",{class:"text-sm text-slate-300"},"OWASP Probe Results",-1))]),e("div",cn,[e("span",un,[b(d(V),{class:"h-3 w-3"}),A(" "+l(p.value)+" passed ",1)]),i.value>0?(t(),s("span",xn,[b(d(K),{class:"h-3 w-3"}),A(" "+l(i.value)+" failed ",1)])):f("",!0)])]),e("div",pn,[(t(!0),s(E,null,T(w.value,n=>(t(),s("div",{key:n.name,class:"flex items-center gap-3 px-4 py-3"},[(t(),F(H(n.passed?d(V):d(K)),{class:D(["h-4 w-4 shrink-0",n.passed?"text-emerald-400":"text-rose-400"])},null,8,["class"])),e("div",mn,[e("span",{class:D(["text-sm",n.passed?"text-slate-400":"text-white"])},l(n.name),3),!n.passed&&n.finding?(t(),s("p",fn,l(n.finding.title),1)):f("",!0)]),!n.passed&&n.finding?(t(),s("span",{key:0,class:D(["text-[10px] font-semibold uppercase",m(n.finding.severity)])},l(n.finding.severity),3)):f("",!0)]))),128))]),u.value.length>0?(t(),s("div",vn,[a[1]||(a[1]=e("h3",{class:"text-xs font-medium uppercase tracking-wider text-slate-500"},"Details",-1)),(t(!0),s(E,null,T(u.value,n=>(t(),s("div",{key:n.id,class:"glass-card rounded-lg p-4"},[e("div",gn,[e("h4",bn,l(n.title),1),e("span",{class:D(["ml-2 inline-flex shrink-0 items-center rounded-full px-2 py-0.5 text-[10px] font-semibold uppercase",c(n.severity)])},l(n.severity),3)]),e("p",hn,l(n.description),1),n.evidence&&Object.keys(n.evidence).length>0?(t(),s("div",_n,[(t(!0),s(E,null,T(n.evidence,(r,h)=>(t(),s("div",{key:h},l(h)+": "+l(r),1))),128))])):f("",!0),n.remediation?(t(),s("p",yn,l(n.remediation),1)):f("",!0)]))),128))])):f("",!0)]))}}),kn={class:"space-y-4"},$n={class:"glass-card rounded-lg px-4 py-3 flex items-center gap-2"},Sn={class:"text-xs text-slate-500"},Cn={key:0,class:"glass-card rounded-xl p-8 text-center"},Pn={class:"grid grid-cols-2 gap-3 sm:grid-cols-4"},In={class:"text-xs text-slate-500"},Mn={class:"space-y-2"},An={class:"mt-0.5 flex h-5 w-5 shrink-0 items-center justify-center rounded-full bg-white/10 text-xs font-bold text-slate-400"},Dn={class:"min-w-0 flex-1"},Nn={class:"flex items-center gap-2"},En={class:"text-sm text-white"},Fn={class:"mt-1 text-xs text-slate-400"},Tn={class:"mt-2 flex items-center gap-3 text-[10px] text-slate-500"},Ln=O({__name:"RemediationPlan",props:{findings:{}},setup(_){const x=_;function y(i){const u=["critical","high"].includes(i.severity)?"high":"low",m=["headers","dns","tls"],c=["cve","owasp"];let o;return m.includes(i.module)?o="low":c.includes(i.module)?o="high":o="medium",u==="high"&&o==="low"?{effort:o,impact:u,label:"Quick Win"}:u==="high"&&o!=="low"?{effort:o,impact:u,label:"Important"}:u==="low"&&o!=="high"?{effort:o,impact:u,label:"Nice to Have"}:{effort:o,impact:u,label:"Deprioritize"}}const C={"Quick Win":0,Important:1,"Nice to Have":2,Deprioritize:3},v=S(()=>x.findings.filter(i=>i.remediation).map(i=>({finding:i,...y(i)})).sort((i,u)=>(C[i.label]??4)-(C[u.label]??4))),w=S(()=>{const i={"Quick Win":0,Important:0,"Nice to Have":0,Deprioritize:0};for(const u of v.value)i[u.label]=(i[u.label]??0)+1;return[{label:"Quick Win",count:i["Quick Win"]??0,color:"text-emerald-400"},{label:"Important",count:i.Important??0,color:"text-amber-400"},{label:"Nice to Have",count:i["Nice to Have"]??0,color:"text-cyan-400"},{label:"Deprioritize",count:i.Deprioritize??0,color:"text-slate-400"}]});function p(i){switch(i){case"Quick Win":return"bg-emerald-500/20 text-emerald-400";case"Important":return"bg-amber-500/20 text-amber-400";case"Nice to Have":return"bg-cyan-500/20 text-cyan-400";case"Deprioritize":return"bg-slate-500/20 text-slate-400";default:return"bg-slate-500/20 text-slate-400"}}return(i,u)=>(t(),s("div",kn,[e("div",$n,[b(d(ge),{class:"h-4 w-4 text-cyan-400"}),u[0]||(u[0]=e("span",{class:"text-sm font-medium text-white"},"Remediation Plan",-1)),e("span",Sn,"("+l(v.value.length)+" actions)",1)]),v.value.length===0?(t(),s("div",Cn,[b(d(ge),{class:"mx-auto h-10 w-10 text-slate-500"}),u[1]||(u[1]=e("h3",{class:"mt-3 text-sm font-medium text-white"},"No Remediation Actions",-1)),u[2]||(u[2]=e("p",{class:"mt-1 text-xs text-slate-500"},"No findings with remediation steps available.",-1))])):(t(),s(E,{key:1},[e("div",Pn,[(t(!0),s(E,null,T(w.value,m=>(t(),s("div",{key:m.label,class:"glass-card rounded-lg p-3 text-center"},[e("div",{class:D(["text-lg font-bold",m.color])},l(m.count),3),e("div",In,l(m.label),1)]))),128))]),e("div",Mn,[(t(!0),s(E,null,T(v.value,(m,c)=>(t(),s("div",{key:m.finding.id,class:"glass-card flex items-start gap-3 rounded-lg px-4 py-3"},[e("span",An,l(c+1),1),e("div",Dn,[e("div",Nn,[e("span",{class:D(["rounded px-1.5 py-0.5 text-[10px] font-bold uppercase",p(m.label)])},l(m.label),3),e("span",En,l(m.finding.title),1)]),e("p",Fn,l(m.finding.remediation),1),e("div",Tn,[e("span",null,"Effort: "+l(m.effort),1),e("span",null,"Impact: "+l(m.impact),1),e("span",null,"Module: "+l(m.finding.module),1)])])]))),128))])],64))]))}}),Rn={key:0,class:"glass-card rounded-xl p-8 text-center"},jn={key:1,class:"glass-card rounded-xl p-5"},On={class:"text-sm font-semibold text-white mb-4 flex items-center gap-2"},Vn={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},Hn={class:"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},Bn={class:"space-y-1.5"},qn={class:"font-mono text-sm font-bold text-cyan-400"},Wn={class:"text-xs text-slate-500"},zn={key:0,class:"rounded-md border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs text-slate-500"},Kn={class:"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},Qn={class:"space-y-1.5"},Un={key:0,class:"absolute -right-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block"},Xn={class:"flex items-center gap-2"},Gn={class:"text-sm font-medium text-white"},Jn={key:0,class:"truncate text-xs text-slate-500"},Yn={class:"mt-1 flex flex-wrap gap-1"},Zn={key:1,class:"mt-1.5 flex items-center gap-1 text-[10px] text-rose-400"},ea={key:0,class:"rounded-md border border-[var(--border-glass)] bg-white/[0.02] px-3 py-2 text-xs text-slate-500"},ta={class:"mb-2 flex items-center gap-1.5 text-xs font-medium uppercase text-slate-500"},sa={class:"space-y-1.5"},la={class:"flex items-center gap-2"},na=["href"],aa={class:"mt-1 text-[10px] opacity-75"},oa={key:0,class:"rounded-md border border-emerald-500/20 bg-emerald-500/5 px-3 py-4 text-center"},ra=O({__name:"AttackSurfaceMap",props:{findings:{}},setup(_){const x=_,y=S(()=>x.findings.filter(o=>o.module==="ports")),C=S(()=>x.findings.filter(o=>o.module==="cve")),v=S(()=>{var I,M,g,k,B;const o=new Map,a=new Map,n=[];for(const N of y.value)if(N.target_port!==null){o.has(N.target_port)||o.set(N.target_port,{port:N.target_port,ip:N.target_ip});const R=((M=(I=N.evidence)==null?void 0:I.service)==null?void 0:M.toLowerCase())??"unknown",G=(g=N.evidence)==null?void 0:g.banner;a.has(R)||a.set(R,{name:R,version:G??null,ports:[]});const Q=a.get(R);Q&&!Q.ports.includes(N.target_port)&&Q.ports.push(N.target_port)}for(const N of C.value)if(N.cve_id){const R=((B=(k=N.evidence)==null?void 0:k.service)==null?void 0:B.toLowerCase())??"unknown";n.push({cveId:N.cve_id,severity:N.severity,service:R,port:N.target_port}),a.has(R)||a.set(R,{name:R,version:null,ports:N.target_port!==null?[N.target_port]:[]}),N.target_port!==null&&!o.has(N.target_port)&&o.set(N.target_port,{port:N.target_port,ip:N.target_ip})}const r=Array.from(o.values()).sort((N,R)=>N.port-R.port),h=Array.from(a.values()).sort((N,R)=>N.name.localeCompare(R.name));return{ports:r,services:h,cves:n}}),w=S(()=>v.value.cves.length>0),p=S(()=>v.value.ports.length>0||v.value.cves.length>0);function i(o){switch(o){case"critical":return"border-red-500/40 bg-red-500/10 text-red-400";case"high":return"border-rose-500/40 bg-rose-500/10 text-rose-400";case"medium":return"border-amber-500/40 bg-amber-500/10 text-amber-400";case"low":return"border-blue-500/40 bg-blue-500/10 text-blue-400";default:return"border-slate-500/40 bg-slate-500/10 text-slate-400"}}function u(o){switch(o){case"critical":return"bg-red-400";case"high":return"bg-rose-400";case"medium":return"bg-amber-400";case"low":return"bg-blue-400";default:return"bg-slate-400"}}function m(o){return v.value.cves.filter(a=>a.service===o)}function c(o){const a=v.value.services.find(n=>n.name===o);return(a==null?void 0:a.ports)??[]}return(o,a)=>p.value?(t(),s("div",jn,[e("h3",On,[b(d(Z),{class:"h-4 w-4 text-cyan-400"}),a[3]||(a[3]=A(" Attack Surface Map ",-1))]),a[10]||(a[10]=e("p",{class:"mb-4 text-xs text-slate-500"}," Showing port-to-service-to-CVE chain. Connections indicate potential attack paths. ",-1)),e("div",Vn,[e("div",null,[e("h4",Hn,[b(d(Z),{class:"h-3.5 w-3.5"}),a[4]||(a[4]=A(" Open Ports ",-1))]),e("div",Bn,[(t(!0),s(E,null,T(v.value.ports,n=>(t(),s("div",{key:n.port,class:"flex items-center gap-2 rounded-md border border-cyan-500/20 bg-cyan-500/5 px-3 py-2"},[e("span",qn,l(n.port),1),e("span",Wn,l(n.ip),1)]))),128)),v.value.ports.length===0?(t(),s("div",zn," No ports detected ")):f("",!0)])]),e("div",null,[e("h4",Kn,[b(d(_e),{class:"h-3.5 w-3.5"}),a[5]||(a[5]=A(" Services ",-1))]),e("div",Qn,[(t(!0),s(E,null,T(v.value.services,n=>(t(),s("div",{key:n.name,class:"relative rounded-md border border-slate-500/20 bg-white/[0.03] px-3 py-2"},[a[6]||(a[6]=e("div",{class:"absolute -left-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block"},null,-1)),m(n.name).length>0?(t(),s("div",Un)):f("",!0),e("div",Xn,[e("span",Gn,l(n.name),1),n.version?(t(),s("span",Jn,l(n.version),1)):f("",!0)]),e("div",Yn,[(t(!0),s(E,null,T(c(n.name),r=>(t(),s("span",{key:r,class:"rounded bg-white/5 px-1.5 py-0.5 font-mono text-[10px] text-slate-400"}," :"+l(r),1))),128))]),m(n.name).length>0?(t(),s("div",Zn,[b(d(be),{class:"h-3 w-3"}),A(" "+l(m(n.name).length)+" CVE"+l(m(n.name).length!==1?"s":""),1)])):f("",!0)]))),128)),v.value.services.length===0?(t(),s("div",ea," No services detected ")):f("",!0)])]),e("div",null,[e("h4",ta,[b(d(z),{class:"h-3.5 w-3.5"}),a[7]||(a[7]=A(" CVEs ",-1))]),e("div",sa,[(t(!0),s(E,null,T(v.value.cves,n=>(t(),s("div",{key:n.cveId,class:D(["relative rounded-md border px-3 py-2",i(n.severity)])},[a[8]||(a[8]=e("div",{class:"absolute -left-4 top-1/2 hidden h-px w-4 bg-slate-600 md:block"},null,-1)),e("div",la,[e("span",{class:D(["h-2 w-2 rounded-full",u(n.severity)])},null,2),e("a",{href:`https://nvd.nist.gov/vuln/detail/${n.cveId}`,target:"_blank",rel:"noopener noreferrer",class:"font-mono text-xs font-semibold hover:underline",onClick:a[0]||(a[0]=se(()=>{},["stop"]))},l(n.cveId),9,na)]),e("div",aa,l(n.service)+l(n.port!==null?` :${n.port}`:""),1)],2))),128)),w.value?f("",!0):(t(),s("div",oa,[b(d(V),{class:"mx-auto h-5 w-5 text-emerald-400"}),a[9]||(a[9]=e("p",{class:"mt-1 text-xs text-emerald-400"},"No CVE associations found",-1))]))])])]),a[11]||(a[11]=e("div",{class:"mt-3 hidden items-center justify-center gap-6 text-xs text-slate-600 md:flex"},[e("span",null,"Ports"),e("span",null,"-->"),e("span",null,"Services"),e("span",null,"-->"),e("span",null,"Vulnerabilities")],-1))])):(t(),s("div",Rn,[b(d(V),{class:"mx-auto h-10 w-10 text-emerald-400"}),a[1]||(a[1]=e("h3",{class:"mt-3 text-lg font-medium text-white"},"No Attack Surface Data",-1)),a[2]||(a[2]=e("p",{class:"mt-1 text-sm text-slate-400"}," No port or CVE findings available to map the attack surface. ",-1))]))}}),ia={class:"glass-card rounded-xl p-4"},da={key:0,class:"flex flex-col items-center justify-center py-12 text-slate-500"},ca={key:1},ua={class:"mb-4 grid grid-cols-4 gap-2 text-center text-xs"},xa={class:"rounded bg-red-500/10 px-2 py-1"},pa={class:"font-bold text-red-400"},ma={class:"rounded bg-amber-500/10 px-2 py-1"},fa={class:"font-bold text-amber-400"},va={class:"rounded bg-rose-500/10 px-2 py-1"},ga={class:"font-bold text-rose-400"},ba={class:"rounded bg-slate-500/10 px-2 py-1"},ha={class:"font-bold text-slate-400"},_a={class:"relative"},ya={class:"relative ml-4 aspect-square w-full overflow-hidden rounded-lg border border-white/5 bg-white/[0.02]"},wa={class:"invisible absolute bottom-full left-1/2 mb-2 -translate-x-1/2 whitespace-nowrap rounded bg-slate-800 px-2 py-1 text-[10px] text-white shadow-lg group-hover:visible z-10"},ka={class:"font-mono font-bold"},$a={key:0,class:"text-red-400"},Sa=O({__name:"PriorityMatrix",props:{findings:{}},setup(_){const x=_,y=S(()=>x.findings.filter(p=>p.cvss_score!=null&&p.epss_score!=null).map(p=>({id:p.id,cveId:p.cve_id??p.title,cvss:p.cvss_score,epss:p.epss_score*100,severity:p.severity,kev:p.cisa_kev})));function C(p){return{left:`${p.cvss/10*100}%`,bottom:`${p.epss}%`}}function v(p){switch(p){case"critical":return"bg-red-500";case"high":return"bg-rose-500";case"medium":return"bg-amber-500";case"low":return"bg-slate-400";default:return"bg-slate-500"}}const w=S(()=>{const p={urgent:0,monitor:0,plan:0,low:0};for(const i of y.value)i.cvss>=5&&i.epss>=50?p.urgent++:i.cvss<5&&i.epss>=50?p.monitor++:i.cvss>=5&&i.epss<50?p.plan++:p.low++;return p});return(p,i)=>(t(),s("div",ia,[i[9]||(i[9]=e("h3",{class:"mb-3 text-sm font-medium text-white"},"Priority Matrix",-1)),y.value.length===0?(t(),s("div",da,[...i[0]||(i[0]=[e("p",{class:"text-sm"},"No CVE data for priority matrix",-1)])])):(t(),s("div",ca,[e("div",ua,[e("div",xa,[e("span",pa,l(w.value.urgent),1),i[1]||(i[1]=e("span",{class:"text-slate-500"}," Urgent",-1))]),e("div",ma,[e("span",fa,l(w.value.monitor),1),i[2]||(i[2]=e("span",{class:"text-slate-500"}," Monitor",-1))]),e("div",va,[e("span",ga,l(w.value.plan),1),i[3]||(i[3]=e("span",{class:"text-slate-500"}," Plan",-1))]),e("div",ba,[e("span",ha,l(w.value.low),1),i[4]||(i[4]=e("span",{class:"text-slate-500"}," Low",-1))])]),e("div",_a,[i[6]||(i[6]=e("div",{class:"absolute -left-6 top-1/2 -translate-y-1/2 -rotate-90 text-[10px] text-slate-500 whitespace-nowrap"}," EPSS Score (%) ",-1)),e("div",ya,[i[5]||(i[5]=Pe('<div class="absolute right-0 top-0 h-1/2 w-1/2 bg-red-500/5"></div><div class="absolute left-0 top-0 h-1/2 w-1/2 bg-amber-500/5"></div><div class="absolute bottom-0 right-0 h-1/2 w-1/2 bg-rose-500/5"></div><div class="absolute bottom-0 left-0 h-1/2 w-1/2 bg-slate-500/5"></div><div class="absolute left-1/2 top-0 h-full w-px bg-white/10"></div><div class="absolute left-0 top-1/2 h-px w-full bg-white/10"></div><span class="absolute right-2 top-2 text-[9px] font-medium text-red-400/60">URGENT</span><span class="absolute left-2 top-2 text-[9px] font-medium text-amber-400/60">MONITOR</span><span class="absolute bottom-2 right-2 text-[9px] font-medium text-rose-400/60">PLAN</span><span class="absolute bottom-2 left-2 text-[9px] font-medium text-slate-400/60">LOW</span>',10)),(t(!0),s(E,null,T(y.value,u=>(t(),s("div",{key:u.id,class:D(["group absolute -ml-1.5 -mb-1.5 h-3 w-3 rounded-full transition-transform hover:scale-150",[v(u.severity),u.kev?"ring-2 ring-red-400 animate-pulse":""]]),style:Y(C(u))},[e("div",wa,[e("div",ka,l(u.cveId),1),e("div",null,"CVSS: "+l(u.cvss)+" | EPSS: "+l(u.epss.toFixed(0))+"%",1),u.kev?(t(),s("div",$a,"CISA KEV")):f("",!0)])],6))),128))]),i[7]||(i[7]=e("div",{class:"mt-1 text-center text-[10px] text-slate-500"},"CVSS Score (0-10)",-1)),i[8]||(i[8]=e("div",{class:"ml-4 flex justify-between text-[9px] text-slate-600"},[e("span",null,"0"),e("span",null,"5"),e("span",null,"10")],-1))])]))]))}}),Ca={class:"space-y-6"},Pa={class:"flex items-center justify-between"},Ia=["disabled"],Ma={key:0,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},Aa={class:"mt-2 text-sm text-slate-400"},Da={key:1,class:"flex flex-col items-center justify-center py-20"},Na={key:2,class:"glass-card rounded-xl p-8 text-center"},Ea={class:"mt-3 text-sm text-slate-300"},Fa={class:"mx-auto mt-4 flex max-w-xs items-center gap-3"},Ta={class:"text-xs text-slate-500"},La={key:0,class:"mt-3"},Ra={class:"text-xs text-slate-500"},ja={key:3,class:"glass-card mx-auto max-w-md rounded-xl p-8 text-center"},Oa={class:"mt-2 text-sm text-slate-400"},Va={class:"flex flex-col gap-6 lg:flex-row"},Ha={class:"glass-card flex items-center justify-center rounded-xl p-6 lg:w-72"},Ba={class:"min-w-0 flex-1"},qa={class:"mb-3 flex items-center justify-between"},Wa={class:"flex items-center gap-3 text-xs text-slate-500"},za={class:"flex items-center gap-1"},Ka={class:"flex items-center gap-1"},Qa={key:1,class:"glass-card rounded-xl p-6 text-center"},Ua={key:0,class:"lg:w-64"},Xa={class:"glass-card flex flex-wrap items-center gap-4 rounded-lg px-4 py-2.5 text-xs text-slate-500"},Ga={class:"font-mono text-slate-300"},Ja={class:"text-slate-300"},Ya={class:"font-mono text-slate-300"},Za={class:"font-mono text-slate-300"},eo={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400"},to={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400"},so={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400"},lo={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400"},no={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-rose-500/20 px-1 text-[10px] font-semibold text-rose-400"},ao={key:0,class:"ml-1.5 inline-flex h-4 min-w-4 items-center justify-center rounded-full bg-amber-500/20 px-1 text-[10px] font-semibold text-amber-400"},oo={class:"space-y-6"},ro={class:"grid gap-6 lg:grid-cols-2"},$o=O({__name:"ShieldView",setup(_){const{currentScan:x,findings:y,loading:C,scanning:v,error:w,startScan:p,fetchScan:i}=Ve();async function u(P,$){await p(P,$)}function m(){var P;(P=x.value)!=null&&P.id&&i(x.value.id)}const c=S(()=>{if(!x.value)return"";switch(x.value.status){case"queued":return"Scan queued, waiting to start...";case"running":return`Scanning ${x.value.target}...`;case"completed":return`Scan completed in ${x.value.duration_seconds??"?"}s`;case"failed":return"Scan failed";default:return""}}),o=S(()=>{var P;return((P=x.value)==null?void 0:P.status)==="completed"}),a=S(()=>{var P;return((P=x.value)==null?void 0:P.status)==="failed"}),n=S(()=>{var P;return((P=x.value)==null?void 0:P.module_scores)&&Object.keys(x.value.module_scores).length>0}),r=S(()=>{var P;return((P=x.value)==null?void 0:P.findings.filter($=>$.module==="ports"))??[]}),h=S(()=>{var P;return((P=x.value)==null?void 0:P.findings.filter($=>$.module==="headers"))??[]}),I=S(()=>{var P;return((P=x.value)==null?void 0:P.findings.filter($=>$.module==="dns"))??[]}),M=S(()=>{var P;return((P=x.value)==null?void 0:P.findings.filter($=>$.module==="cve"))??[]}),g=S(()=>{var P;return((P=x.value)==null?void 0:P.modules_enabled.includes("ports"))??!1}),k=S(()=>{var P;return((P=x.value)==null?void 0:P.modules_enabled.includes("headers"))??!1}),B=S(()=>{var P;return((P=x.value)==null?void 0:P.modules_enabled.includes("dns"))??!1}),N=S(()=>{var P;return((P=x.value)==null?void 0:P.modules_enabled.includes("cve"))??!1}),R=S(()=>{var P;return((P=x.value)==null?void 0:P.findings.filter($=>$.module==="creds"))??[]}),G=S(()=>{var P;return((P=x.value)==null?void 0:P.findings.filter($=>$.module==="owasp"))??[]}),Q=S(()=>{var P;return((P=x.value)==null?void 0:P.modules_enabled.includes("creds"))??!1}),oe=S(()=>{var P;return((P=x.value)==null?void 0:P.modules_enabled.includes("owasp"))??!1});return(P,$)=>{var re,ie,de,ce,ue,xe,pe,me,fe;return t(),s("div",Ca,[e("div",Pa,[$[1]||($[1]=e("div",null,[e("h1",{class:"text-2xl font-bold text-white"},"Shield - Security Validation"),e("p",{class:"mt-1 text-sm text-slate-400"}," Comprehensive security scanning and vulnerability assessment ")],-1)),e("button",{class:"flex items-center gap-2 rounded-lg bg-white/5 px-3 py-2 text-xs text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-200",disabled:d(C)||d(v),onClick:m},[b(d(Ee),{class:D(["h-3.5 w-3.5",{"animate-spin":d(C)}])},null,8,["class"]),$[0]||($[0]=A(" Refresh ",-1))],8,Ia)]),b(Ue,{scanning:d(v),onScan:u},null,8,["scanning"]),d(w)&&!d(x)?(t(),s("div",Ma,[b(d(te),{class:"mx-auto h-10 w-10 text-amber-400"}),$[2]||($[2]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Unable to Start Scan",-1)),e("p",Aa,l(d(w)),1)])):f("",!0),!d(x)&&!d(w)?(t(),s("div",Da,[b(d(ee),{class:"h-16 w-16 text-slate-600"}),$[3]||($[3]=e("h2",{class:"mt-4 text-lg font-medium text-slate-400"},"Enter a target to begin",-1)),$[4]||($[4]=e("p",{class:"mt-1 text-sm text-slate-500"}," Provide an IP address, domain, or CIDR range to start a security scan ",-1))])):f("",!0),d(x)&&d(v)?(t(),s("div",Na,[b(d(le),{class:"mx-auto h-10 w-10 animate-spin text-cyan-400"}),e("p",Ea,l(c.value),1),e("div",Fa,[$[5]||($[5]=e("div",{class:"h-1.5 flex-1 overflow-hidden rounded-full bg-white/5"},[e("div",{class:"h-full w-1/3 animate-pulse rounded-full bg-cyan-500/50"})],-1)),e("span",Ta,l(d(x).status),1)]),d(x).modules_enabled.length>0?(t(),s("div",La,[e("span",Ra," Modules: "+l(d(x).modules_enabled.join(", ")),1)])):f("",!0)])):f("",!0),a.value&&!d(v)?(t(),s("div",ja,[b(d(K),{class:"mx-auto h-10 w-10 text-rose-400"}),$[6]||($[6]=e("h2",{class:"mt-3 text-lg font-semibold text-white"},"Scan Failed",-1)),e("p",Oa," The scan for "+l((re=d(x))==null?void 0:re.target)+" could not be completed. ",1)])):f("",!0),o.value&&!d(v)?(t(),s(E,{key:4},[e("div",Va,[e("div",Ha,[b(tt,{score:((ie=d(x))==null?void 0:ie.shield_score)??null,grade:((de=d(x))==null?void 0:de.grade)??null,loading:d(C)},null,8,["score","grade","loading"])]),e("div",Ba,[e("div",qa,[$[7]||($[7]=e("h2",{class:"text-sm font-medium text-white"},"Module Scores",-1)),e("div",Wa,[e("span",za,[b(d(V),{class:"h-3 w-3 text-emerald-400"}),A(" "+l(((ce=d(x))==null?void 0:ce.passed_checks)??0)+" passed ",1)]),e("span",Ka,[b(d(K),{class:"h-3 w-3 text-rose-400"}),A(" "+l(((ue=d(x))==null?void 0:ue.failed_checks)??0)+" failed ",1)])])]),n.value?(t(),F(dt,{key:0,scores:d(x).module_scores},null,8,["scores"])):(t(),s("div",Qa,[...$[8]||($[8]=[e("p",{class:"text-sm text-slate-500"},"No module breakdown available",-1)])]))]),d(x)?(t(),s("div",Ua,[b(Ys,{scan:d(x)},null,8,["scan"])])):f("",!0)]),e("div",Xa,[e("span",null,[$[9]||($[9]=A(" Target: ",-1)),e("span",Ga,l((xe=d(x))==null?void 0:xe.target),1)]),e("span",null,[$[10]||($[10]=A(" Depth: ",-1)),e("span",Ja,l((pe=d(x))==null?void 0:pe.scan_depth),1)]),e("span",null,[$[11]||($[11]=A(" Duration: ",-1)),e("span",Ya,l(((me=d(x))==null?void 0:me.duration_seconds)??"?")+"s",1)]),e("span",null,[$[12]||($[12]=A(" Checks: ",-1)),e("span",Za,l((fe=d(x))==null?void 0:fe.total_checks),1)])]),b(d(De),{"default-value":"findings"},{default:L(()=>[b(d(Ne),{class:"bg-white/5"},{default:L(()=>[b(d(q),{value:"findings",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[...$[13]||($[13]=[A(" All Findings ",-1)])]),_:1}),g.value?(t(),F(d(q),{key:0,value:"ports",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[$[14]||($[14]=A(" Ports ",-1)),r.value.length>0?(t(),s("span",eo,l(r.value.length),1)):f("",!0)]),_:1})):f("",!0),k.value?(t(),F(d(q),{key:1,value:"headers",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[$[15]||($[15]=A(" Headers ",-1)),h.value.length>0?(t(),s("span",to,l(h.value.length),1)):f("",!0)]),_:1})):f("",!0),B.value?(t(),F(d(q),{key:2,value:"dns",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[$[16]||($[16]=A(" DNS ",-1)),I.value.length>0?(t(),s("span",so,l(I.value.length),1)):f("",!0)]),_:1})):f("",!0),N.value?(t(),F(d(q),{key:3,value:"cve",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[$[17]||($[17]=A(" CVE ",-1)),M.value.length>0?(t(),s("span",lo,l(M.value.length),1)):f("",!0)]),_:1})):f("",!0),Q.value?(t(),F(d(q),{key:4,value:"creds",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[$[18]||($[18]=A(" Credentials ",-1)),R.value.length>0?(t(),s("span",no,l(R.value.length),1)):f("",!0)]),_:1})):f("",!0),oe.value?(t(),F(d(q),{key:5,value:"owasp",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[$[19]||($[19]=A(" OWASP ",-1)),G.value.length>0?(t(),s("span",ao,l(G.value.length),1)):f("",!0)]),_:1})):f("",!0),b(d(q),{value:"remediation",class:"data-[state=active]:bg-white/10 data-[state=active]:text-cyan-400 text-slate-400"},{default:L(()=>[...$[20]||($[20]=[A(" Remediation ",-1)])]),_:1})]),_:1}),b(d(W),{value:"findings"},{default:L(()=>[b(jt,{findings:d(y)},null,8,["findings"])]),_:1}),g.value?(t(),F(d(W),{key:0,value:"ports"},{default:L(()=>[b(ds,{findings:r.value},null,8,["findings"])]),_:1})):f("",!0),k.value?(t(),F(d(W),{key:1,value:"headers"},{default:L(()=>[b(ys,{findings:h.value},null,8,["findings"])]),_:1})):f("",!0),B.value?(t(),F(d(W),{key:2,value:"dns"},{default:L(()=>[b(Ws,{findings:I.value},null,8,["findings"])]),_:1})):f("",!0),N.value?(t(),F(d(W),{key:3,value:"cve"},{default:L(()=>[e("div",oo,[b(Hl,{findings:M.value},null,8,["findings"]),e("div",ro,[b(ra,{findings:d(y)},null,8,["findings"]),b(Sa,{findings:M.value},null,8,["findings"])])])]),_:1})):f("",!0),Q.value?(t(),F(d(W),{key:4,value:"creds"},{default:L(()=>[b(an,{findings:R.value},null,8,["findings"])]),_:1})):f("",!0),oe.value?(t(),F(d(W),{key:5,value:"owasp"},{default:L(()=>[b(wn,{findings:G.value},null,8,["findings"])]),_:1})):f("",!0),b(d(W),{value:"remediation"},{default:L(()=>[b(Ln,{findings:d(y)},null,8,["findings"])]),_:1})]),_:1})],64)):f("",!0)])}}});export{$o as default};
//# sourceMappingURL=ShieldView-B7pLQ0Rh.js.map
